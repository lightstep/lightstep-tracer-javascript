{"version":3,"file":"lightstep-tracer.js","mappings":"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;QACA;UACI,IAAI6W,OAAO,KAAKvS,SAAhB,EAA2B;YACvBoY,OAAO,CAACyK,GAAR,CAAY3jB,OAAZ,EAAqBqT,OAArB,EADuB,CACQ;UAClC,CAFD,MAEO;YACH6F,OAAO,CAACyK,GAAR,CAAY3jB,OAAZ,EADG,CACmB;UACzB;;UACD;MAvBJ;IAyBH;;;;;;AAGLhB,MAAM,CAACC,OAAP,GAAiB,IAAIoyB,YAAJ,EAAjB;;;;;;;;;;;ACvFa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,UAAU;AACrB,WAAW,GAAG;AACd,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,iBAAiB;AAC5B,WAAW,UAAU;AACrB,WAAW,GAAG;AACd,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,0DAA0D,OAAO;AACjE;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,aAAa,SAAS;AACtB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0CAA0C,SAAS;AACnD;AACA;;AAEA;AACA,IAAI;AACJ;AACA;;AAEA,gBAAgB,YAAY;AAC5B;;AAEA;AACA,4DAA4D;AAC5D,gEAAgE;AAChE,oEAAoE;AACpE,wEAAwE;AACxE;AACA,2DAA2D,SAAS;AACpE;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,WAAW,UAAU;AACrB,WAAW,GAAG;AACd,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,WAAW,UAAU;AACrB,WAAW,GAAG;AACd,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,WAAW,UAAU;AACrB,WAAW,GAAG;AACd,WAAW,SAAS;AACpB,aAAa,cAAc;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,4DAA4D,YAAY;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,aAAa,cAAc;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI,IAA6B;AACjC;AACA;;;;;;;;;;;AC/UA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kCAAkC,QAAQ;AAC1C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oCAAoC,QAAQ;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;ACvGa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,kBAAe;AACf;;;;;;;;;;;ACfa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;;;;;;;;;;;AC9Da;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D;AACA,iBAAiB;AACjB;AACA,4BAA4B;AAC5B;AACA,4BAA4B;AAC5B;AACA,oCAAoC;AACpC;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,sBAAsB;AACtB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,eAAe;AACf;;;;;;;;;;;AC3Ga;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,gBAAgB,mBAAO,CAAC,gEAAa;AACrC,kBAAkB,mBAAO,CAAC,gEAAa;AACvC,aAAa,mBAAO,CAAC,sDAAQ;AAC7B;AACA;AACA;AACA,WAAW,aAAa;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA,WAAW,aAAa;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;;;;;;;;;;;ACnCa;AACb;AACA;AACA;AACA,eAAe,gBAAgB,sCAAsC,kBAAkB;AACvF,8BAA8B;AAC9B;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,8CAA6C,EAAE,aAAa,EAAC;AAC7D,eAAe,mBAAO,CAAC,0DAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;;;;;;;;;;;ACvEa;AACb;AACA;AACA;AACA,8CAA6C,EAAE,aAAa,EAAC;AAC7D,uBAAuB,mBAAO,CAAC,0EAAkB;AACjD,qBAAqB;AACrB,WAAW,mBAAO,CAAC,8DAAY;AAC/B,YAAY;AACZ,WAAW,mBAAO,CAAC,sDAAQ;AAC3B,kBAAkB,mBAAO,CAAC,gEAAa;AACvC,iBAAiB;AACjB,aAAa,mBAAO,CAAC,sDAAQ;AAC7B,YAAY;AACZ,qBAAqB,mBAAO,CAAC,sEAAgB;AAC7C,mBAAmB;AACnB,eAAe,mBAAO,CAAC,0DAAU;AACjC,cAAc;AACd,oBAAoB,mBAAO,CAAC,0EAAe;AAC3C,kBAAkB;AAClB,SAAS,mBAAO,CAAC,wEAAiB;AAClC,SAAS,mBAAO,CAAC,gEAAa;AAC9B,SAAS,mBAAO,CAAC,gEAAa;AAC9B;AACA;AACA;;;;;;;;;;;ACzBa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,qBAAqB,mBAAO,CAAC,kFAAgB;AAC7C,mBAAmB;AACnB,kBAAkB,mBAAO,CAAC,4EAAa;AACvC,gBAAgB;AAChB,oBAAoB,mBAAO,CAAC,gFAAe;AAC3C,kBAAkB;AAClB;;;;;;;;;;;ACRa;AACb;AACA;AACA;AACA,eAAe,gBAAgB,sCAAsC,kBAAkB;AACvF,8BAA8B;AAC9B;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,8CAA6C,EAAE,aAAa,EAAC;AAC7D,qBAAqB,mBAAO,CAAC,uEAAiB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,mBAAmB;AACnB,kBAAe;AACf;;;;;;;;;;;ACpCa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,kBAAkB;AAClB,kBAAe;AACf;;;;;;;;;;;AC5Ca;AACb;AACA;AACA;AACA;AACA,eAAe,gBAAgB,sCAAsC,kBAAkB;AACvF,8BAA8B;AAC9B;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,8CAA6C,EAAE,aAAa,EAAC;AAC7D,kBAAkB,mBAAO,CAAC,yDAAU;AACpC,qBAAqB,mBAAO,CAAC,kFAAgB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,oBAAoB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,gBAAgB;AAChB,kBAAe;AACf;;;;;;;;;;;ACtGa;AACb;AACA;AACA;AACA,eAAe,gBAAgB,sCAAsC,kBAAkB;AACvF,8BAA8B;AAC9B;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,CAAC;AACD,8CAA6C,EAAE,aAAa,EAAC;AAC7D;AACA,kBAAkB,mBAAO,CAAC,yDAAU;AACpC,oBAAoB,mBAAO,CAAC,gFAAe;AAC3C,kBAAkB,mBAAO,CAAC,4EAAa;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,gBAAgB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,kBAAkB;AAClB,kBAAe;AACf;;;;;;;;;;;AC9Ea;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,aAAa,mBAAO,CAAC,sDAAQ;AAC7B,qBAAqB,mBAAO,CAAC,sEAAgB;AAC7C,eAAe,mBAAO,CAAC,0DAAU;AACjC,cAAc;AACd,mBAAmB;AACnB,YAAY;AACZ;AACA;AACA;AACA,IAAI,cAAc;AAClB,IAAI,YAAY;AAChB,IAAI,mBAAmB;AACvB;AACA,kBAAkB;AAClB;;;;;;;;;;;AChBa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,aAAa,mBAAO,CAAC,sDAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA,eAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,kBAAe;AACf;;;;;;;;;;;AC1Ca;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,WAAW,mBAAO,CAAC,sDAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB,eAAe,KAAK;AACpB;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,YAAY;AACZ;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oCAAoC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,YAAY;AACZ,kBAAe;AACf;;;;;;;;;;;AC9Ma;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,mBAAmB;AACnB,kBAAe;AACf;;;;;;;;;;;ACpCa;AACb,8CAA6C,EAAE,aAAa,EAAC;AAC7D,gBAAgB,mBAAO,CAAC,gEAAa;AACrC,WAAW,mBAAO,CAAC,sDAAQ;AAC3B,aAAa,mBAAO,CAAC,sDAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA,eAAe,QAAQ;AACvB,eAAe,aAAa;AAC5B,gBAAgB,MAAM;AACtB;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,aAAa;AAC7B;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB,gBAAgB,KAAK;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,mBAAmB;AACzE;AACA,gBAAgB,QAAQ;AACxB,gBAAgB,KAAK;AACrB;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,cAAc;AACd,kBAAe;AACf;;;;;;;;;;;;;;;;;UClJA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,GAAG;WACH;WACA;WACA,CAAC;;;;;UEPD;UACA;UACA;UACA","sources":["webpack://lightstep/webpack/universalModuleDefinition","webpack://lightstep/./src/_each.js","webpack://lightstep/./src/constants.js","webpack://lightstep/./src/imp/auth_imp.js","webpack://lightstep/./src/imp/coerce.js","webpack://lightstep/./src/imp/globals.js","webpack://lightstep/./src/imp/log_builder.js","webpack://lightstep/./src/imp/log_record_imp.js","webpack://lightstep/./src/imp/platform/browser/crouton_thrift.js","webpack://lightstep/./src/imp/platform/browser/generated/thrift_all.js","webpack://lightstep/./src/imp/platform/browser/options_parser.js","webpack://lightstep/./src/imp/platform/browser/platform_browser.js","webpack://lightstep/./src/imp/platform/browser/thrift.js","webpack://lightstep/./src/imp/platform/browser/transport_httpthrift.js","webpack://lightstep/./src/imp/platform/browser/util.js","webpack://lightstep/./src/imp/propagator.js","webpack://lightstep/./src/imp/propagator_b3.js","webpack://lightstep/./src/imp/propagator_dd.js","webpack://lightstep/./src/imp/propagator_ls.js","webpack://lightstep/./src/imp/report_imp.js","webpack://lightstep/./src/imp/runtime_imp.js","webpack://lightstep/./src/imp/span_context_imp.js","webpack://lightstep/./src/imp/span_imp.js","webpack://lightstep/./src/imp/tracer_imp.js","webpack://lightstep/./src/imp/util/clock_state.js","webpack://lightstep/./src/imp/util/util.js","webpack://lightstep/./src/lib.js","webpack://lightstep/./src/platform_abstraction_layer.js","webpack://lightstep/./src/plugins/instrument_document_load.js","webpack://lightstep/./src/plugins/instrument_fetch.js","webpack://lightstep/./src/plugins/instrument_xhr.js","webpack://lightstep/./src/plugins/log_to_console.js","webpack://lightstep/./node_modules/eventemitter3/index.js","webpack://lightstep/./node_modules/hex2dec/index.js","webpack://lightstep/./node_modules/opentracing/lib/binary_carrier.js","webpack://lightstep/./node_modules/opentracing/lib/constants.js","webpack://lightstep/./node_modules/opentracing/lib/ext/tags.js","webpack://lightstep/./node_modules/opentracing/lib/functions.js","webpack://lightstep/./node_modules/opentracing/lib/global_tracer.js","webpack://lightstep/./node_modules/opentracing/lib/index.js","webpack://lightstep/./node_modules/opentracing/lib/mock_tracer/index.js","webpack://lightstep/./node_modules/opentracing/lib/mock_tracer/mock_context.js","webpack://lightstep/./node_modules/opentracing/lib/mock_tracer/mock_report.js","webpack://lightstep/./node_modules/opentracing/lib/mock_tracer/mock_span.js","webpack://lightstep/./node_modules/opentracing/lib/mock_tracer/mock_tracer.js","webpack://lightstep/./node_modules/opentracing/lib/noop.js","webpack://lightstep/./node_modules/opentracing/lib/reference.js","webpack://lightstep/./node_modules/opentracing/lib/span.js","webpack://lightstep/./node_modules/opentracing/lib/span_context.js","webpack://lightstep/./node_modules/opentracing/lib/tracer.js","webpack://lightstep/webpack/bootstrap","webpack://lightstep/webpack/runtime/global","webpack://lightstep/webpack/before-startup","webpack://lightstep/webpack/startup","webpack://lightstep/webpack/after-startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"lightstep\"] = factory();\n\telse\n\t\troot[\"lightstep\"] = factory();\n})(self, () => {\nreturn ","// Underscore.js-like wrapper to iterate object key-values. Note that even for completely\n// internal objects, packages may modify default Object prototypes and properties\n// (e.g. Ember.js) so it's almost never safe to assume a particular object can\n// iterated with for-in.\n// TODO: remove this function and replace with Object.keys, Object.values, ... (spread) or other.\nexport default function _each(obj, cb) {\n    if (!obj) {\n        return;\n    }\n    // eslint-disable-next-line no-restricted-syntax\n    for (let key in obj) {\n        if (hasOwnProperty.call(obj, key)) {\n            cb(obj[key], key);\n        }\n    }\n}\n","export const LOG_INFO = 0;\nexport const LOG_WARN = 1;\nexport const LOG_ERROR = 2;\nexport const LOG_FATAL = 3;\n\nexport const LOG_LEVEL_TO_STRING = {\n    LOG_INFO  : 'I',\n    LOG_WARN  : 'W',\n    LOG_ERROR : 'E',\n    LOG_FATAL : 'F',\n};\nexport const LOG_STRING_TO_LEVEL = {\n    I : LOG_INFO,\n    W : LOG_WARN,\n    E : LOG_ERROR,\n    F : LOG_FATAL,\n};\n\n// The report interval for empty reports used to sample the clock skew\nexport const CLOCK_STATE_REFRESH_INTERVAL_MS = 350;\n\nexport const LIGHTSTEP_APP_URL_PREFIX = 'https://app.lightstep.com';\n\nexport const JOIN_ID_PREFIX = 'join:';\n\nexport const LS_META_EVENT_KEY = 'lightstep.meta_event';\nexport const LS_META_PROPAGATION_KEY = 'lightstep.propagation_format';\nexport const LS_META_TRACE_KEY = 'lightstep.trace_id';\nexport const LS_META_SPAN_KEY = 'lightstep.span_id';\nexport const LS_META_TRACER_GUID_KEY = 'lightstep.tracer_guid';\nexport const LS_META_EXTRACT = 'lightstep.extract_span';\nexport const LS_META_INJECT = 'lightstep.inject_span';\nexport const LS_META_SP_START = 'lightstep.span_start';\nexport const LS_META_SP_FINISH = 'lightstep.span_finish';\nexport const LS_META_TRACER_CREATE = 'lightstep.tracer_create';\n\nexport const FORMAT_B3 = 'format.b3';\n","// eslint-disable-next-line camelcase\nimport { crouton_thrift } from '../platform_abstraction_layer';\n\nexport default class AuthImp {\n    constructor(accessToken) {\n        this._accessToken = accessToken;\n    }\n\n    getAccessToken() {\n        if (typeof this._accessToken === 'undefined' || this._accessToken === null || this._accessToken.length === 0) {\n            return 'empty';\n        }\n\n        return this._accessToken;\n    }\n\n    toThrift() {\n        // eslint-disable-next-line camelcase\n        return new crouton_thrift.Auth({\n            access_token : this._accessToken,\n        });\n    }\n}\n","export function toString(value) {\n    return '' + value; // eslint-disable-line prefer-template\n}\n\nexport function toNumber(value) {\n    return Number(value);\n}\n\nexport function toBoolean(value) {\n    return !!value;\n}\n","// eslint-disable-next-line import/no-import-module-exports\nimport _each from '../_each';\n\nclass PackageGlobals {\n    constructor() {\n        this.options = {};\n    }\n\n    setOptions(opts) {\n        _each(opts, (val, key) => {\n            this.options[key] = val;\n        });\n    }\n}\n\nmodule.exports = new PackageGlobals();\n","/* eslint-disable import/no-import-module-exports */\n// eslint-disable-next-line camelcase\nimport { crouton_thrift } from '../platform_abstraction_layer';\n\nconst constants = require('../constants');\nconst coerce    = require('./coerce');\n\n// Facade on the thrift log data structure to make constructing log records more\n// convenient.\nclass LogBuilder {\n    constructor(runtime) {\n        this._runtime = runtime;\n        // eslint-disable-next-line camelcase\n        this._record = new crouton_thrift.LogRecord({\n            timestamp_micros : runtime._platform.nowMicros(),\n            runtime_guid     : null,\n            span_guid        : null,\n            stable_name      : null,\n            message          : null,\n            level            : null,\n            thread_id        : null,\n            filename         : null,\n            line_number      : null,\n            stack_frames     : null,\n            payload_json     : null,\n            error_flag       : null,\n        });\n    }\n\n    record() {\n        return this._record;\n    }\n\n    end() {\n        this._runtime._addLogRecord(this._record);\n    }\n\n    timestamp(micros) {\n        this._record.timestamp_micros = coerce.toNumber(micros);\n        return this;\n    }\n\n    message(msg) {\n        this._record.message = coerce.toString(msg);\n        return this;\n    }\n\n    level(num) {\n        this._record.level = constants.LOG_LEVEL_TO_STRING[num] || null;\n        if (num >= constants.LOG_ERROR) {\n            this.error(true);\n        }\n        return this;\n    }\n\n    span(guid) {\n        if (guid !== undefined) {\n            this._record.span_guid = coerce.toString(guid);\n        }\n        return this;\n    }\n\n    name(stableName) {\n        this._record.stable_name = coerce.toString(stableName);\n        return this;\n    }\n\n    error(flag) {\n        this._record.error_flag = coerce.toBoolean(flag);\n        return this;\n    }\n\n    payload(data) {\n        if (data !== undefined) {\n            this._record.payload_json = this._encodePayload(data);\n        }\n        return this;\n    }\n\n    _encodePayload(data) {\n        let payloadJSON = null;\n        try {\n            payloadJSON = JSON.stringify(data);\n        } catch (_ignored) {\n            // TODO: this should log an internal warning that a payload could\n            // not be encoded as JSON.\n            return undefined;\n        }\n        return payloadJSON;\n    }\n}\n\nmodule.exports = LogBuilder;\n","import { crouton_thrift } from '../platform_abstraction_layer'; // eslint-disable-line camelcase\nimport _each from '../_each';\nimport * as coerce from './coerce';\n// eslint-disable-line camelcase\nexport default class LogRecordImp {\n    constructor(logFieldKeyHardLimit, logFieldValueHardLimit, timestampMicros, fields) {\n        if (fields instanceof Error) {\n            fields = {\n                stack   : fields.stack,\n                message : fields.message,\n            };\n        }\n\n        this._logFieldKeyHardLimit = logFieldKeyHardLimit;\n        this._logFieldValueHardLimit = logFieldValueHardLimit;\n        this._timestampMicros = timestampMicros;\n        this._fields = fields;\n        this._keysOverLimit = 0;\n        this._valuesOverLimit = 0;\n    }\n\n    _clearOverLimits() {\n        this._keysOverLimit = 0;\n        this._valuesOverLimit = 0;\n    }\n\n    getNumKeysOverLimit() {\n        return this._keysOverLimit;\n    }\n\n    getNumValuesOverLimit() {\n        return this._valuesOverLimit;\n    }\n\n    toThrift() {\n        this._clearOverLimits();\n        let thriftFields = [];\n        _each(this._fields, (value, key) => {\n            if (!key || !value) {\n                return;\n            }\n            let keyStr = this.getFieldKey(key);\n            let valStr = this.getFieldValue(value);\n            // eslint-disable-next-line camelcase\n            thriftFields.push(new crouton_thrift.KeyValue({\n                Key   : keyStr,\n                Value : valStr,\n            }));\n        });\n\n        // eslint-disable-next-line camelcase\n        return new crouton_thrift.LogRecord({\n            timestamp_micros : this._timestampMicros,\n            fields           : thriftFields,\n        });\n    }\n\n    getFieldKey(key) {\n        let keyStr = coerce.toString(key);\n        if (keyStr.length > this._logFieldKeyHardLimit) {\n            this._keysOverLimit += 1;\n            keyStr = `${keyStr.substr(0, this._logFieldKeyHardLimit)}...`;\n        }\n        return keyStr;\n    }\n\n    getFieldValue(value) {\n        let valStr = null;\n        if (value instanceof Error) {\n            try {\n                // https://stackoverflow.com/a/26199752/9778850\n                valStr = JSON.stringify(value, Object.getOwnPropertyNames(value));\n            } catch (e) {\n                valStr = `Could not encode value. Exception: ${e}`;\n            }\n        } else if (value instanceof Object) {\n            try {\n                valStr = JSON.stringify(value, null, '  ');\n            } catch (e) {\n                valStr = `Could not encode value. Exception: ${e}`;\n            }\n        } else {\n            valStr = coerce.toString(value);\n        }\n        if (valStr.length > this._logFieldValueHardLimit) {\n            this._valuesOverLimit += 1;\n            valStr = `${valStr.substr(0, this._logFieldValueHardLimit)}...`;\n        }\n        return valStr;\n    }\n}\n","// eslint-disable-next-line import/extensions\nmodule.exports = require('./generated/thrift_all.js').crouton_thrift;\n","//\n// GENERATED FILE - DO NOT EDIT DIRECTLY\n//\n// See scripts/build_browser_thrift_lib.js\n//\n//\n(function() {\nvar Thrift = {};\nvar crouton_thrift = {};\n//\n// Autogenerated by Thrift Compiler (0.9.2)\n//\n// DO NOT EDIT UNLESS YOU ARE SURE THAT YOU KNOW WHAT YOU ARE DOING\n//\n\n\nif (typeof crouton_thrift === 'undefined') {\n  crouton_thrift = {};\n}\ncrouton_thrift.KeyValue = function(args) {\n  this.Key = null;\n  this.Value = null;\n  if (args) {\n    if (args.Key !== undefined) {\n      this.Key = args.Key;\n    } else {\n      throw new Thrift.TProtocolException(Thrift.TProtocolExceptionType.UNKNOWN, 'Required field Key is unset!');\n    }\n    if (args.Value !== undefined) {\n      this.Value = args.Value;\n    } else {\n      throw new Thrift.TProtocolException(Thrift.TProtocolExceptionType.UNKNOWN, 'Required field Value is unset!');\n    }\n  }\n};\ncrouton_thrift.KeyValue.prototype = {};\ncrouton_thrift.KeyValue.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.STRING) {\n        this.Key = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 2:\n      if (ftype == Thrift.Type.STRING) {\n        this.Value = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.KeyValue.prototype.write = false && function(output) {\n  output.writeStructBegin('KeyValue');\n  if (this.Key !== null && this.Key !== undefined) {\n    output.writeFieldBegin('Key', Thrift.Type.STRING, 1);\n    output.writeString(this.Key);\n    output.writeFieldEnd();\n  }\n  if (this.Value !== null && this.Value !== undefined) {\n    output.writeFieldBegin('Value', Thrift.Type.STRING, 2);\n    output.writeString(this.Value);\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\ncrouton_thrift.NamedCounter = function(args) {\n  this.Name = null;\n  this.Value = null;\n  if (args) {\n    if (args.Name !== undefined) {\n      this.Name = args.Name;\n    } else {\n      throw new Thrift.TProtocolException(Thrift.TProtocolExceptionType.UNKNOWN, 'Required field Name is unset!');\n    }\n    if (args.Value !== undefined) {\n      this.Value = args.Value;\n    } else {\n      throw new Thrift.TProtocolException(Thrift.TProtocolExceptionType.UNKNOWN, 'Required field Value is unset!');\n    }\n  }\n};\ncrouton_thrift.NamedCounter.prototype = {};\ncrouton_thrift.NamedCounter.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.STRING) {\n        this.Name = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 2:\n      if (ftype == Thrift.Type.I64) {\n        this.Value = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.NamedCounter.prototype.write = false && function(output) {\n  output.writeStructBegin('NamedCounter');\n  if (this.Name !== null && this.Name !== undefined) {\n    output.writeFieldBegin('Name', Thrift.Type.STRING, 1);\n    output.writeString(this.Name);\n    output.writeFieldEnd();\n  }\n  if (this.Value !== null && this.Value !== undefined) {\n    output.writeFieldBegin('Value', Thrift.Type.I64, 2);\n    output.writeI64(this.Value);\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\ncrouton_thrift.Runtime = function(args) {\n  this.guid = null;\n  this.start_micros = null;\n  this.group_name = null;\n  this.attrs = null;\n  if (args) {\n    if (args.guid !== undefined) {\n      this.guid = args.guid;\n    }\n    if (args.start_micros !== undefined) {\n      this.start_micros = args.start_micros;\n    }\n    if (args.group_name !== undefined) {\n      this.group_name = args.group_name;\n    }\n    if (args.attrs !== undefined) {\n      this.attrs = args.attrs;\n    }\n  }\n};\ncrouton_thrift.Runtime.prototype = {};\ncrouton_thrift.Runtime.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.STRING) {\n        this.guid = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 2:\n      if (ftype == Thrift.Type.I64) {\n        this.start_micros = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 3:\n      if (ftype == Thrift.Type.STRING) {\n        this.group_name = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 4:\n      if (ftype == Thrift.Type.LIST) {\n        var _size0 = 0;\n        var _rtmp34;\n        this.attrs = [];\n        var _etype3 = 0;\n        _rtmp34 = input.readListBegin();\n        _etype3 = _rtmp34.etype;\n        _size0 = _rtmp34.size;\n        for (var _i5 = 0; _i5 < _size0; ++_i5)\n        {\n          var elem6 = null;\n          elem6 = new crouton_thrift.KeyValue();\n          elem6.read(input);\n          this.attrs.push(elem6);\n        }\n        input.readListEnd();\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.Runtime.prototype.write = false && function(output) {\n  output.writeStructBegin('Runtime');\n  if (this.guid !== null && this.guid !== undefined) {\n    output.writeFieldBegin('guid', Thrift.Type.STRING, 1);\n    output.writeString(this.guid);\n    output.writeFieldEnd();\n  }\n  if (this.start_micros !== null && this.start_micros !== undefined) {\n    output.writeFieldBegin('start_micros', Thrift.Type.I64, 2);\n    output.writeI64(this.start_micros);\n    output.writeFieldEnd();\n  }\n  if (this.group_name !== null && this.group_name !== undefined) {\n    output.writeFieldBegin('group_name', Thrift.Type.STRING, 3);\n    output.writeString(this.group_name);\n    output.writeFieldEnd();\n  }\n  if (this.attrs !== null && this.attrs !== undefined) {\n    output.writeFieldBegin('attrs', Thrift.Type.LIST, 4);\n    output.writeListBegin(Thrift.Type.STRUCT, this.attrs.length);\n    for (var iter7 in this.attrs)\n    {\n      if (this.attrs.hasOwnProperty(iter7))\n      {\n        iter7 = this.attrs[iter7];\n        iter7.write(output);\n      }\n    }\n    output.writeListEnd();\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\ncrouton_thrift.LogRecord = function(args) {\n  this.timestamp_micros = null;\n  this.fields = null;\n  this.runtime_guid = null;\n  this.span_guid = null;\n  this.stable_name = null;\n  this.message = null;\n  this.level = null;\n  this.thread_id = null;\n  this.filename = null;\n  this.line_number = null;\n  this.stack_frames = null;\n  this.payload_json = null;\n  this.error_flag = null;\n  if (args) {\n    if (args.timestamp_micros !== undefined) {\n      this.timestamp_micros = args.timestamp_micros;\n    }\n    if (args.fields !== undefined) {\n      this.fields = args.fields;\n    }\n    if (args.runtime_guid !== undefined) {\n      this.runtime_guid = args.runtime_guid;\n    }\n    if (args.span_guid !== undefined) {\n      this.span_guid = args.span_guid;\n    }\n    if (args.stable_name !== undefined) {\n      this.stable_name = args.stable_name;\n    }\n    if (args.message !== undefined) {\n      this.message = args.message;\n    }\n    if (args.level !== undefined) {\n      this.level = args.level;\n    }\n    if (args.thread_id !== undefined) {\n      this.thread_id = args.thread_id;\n    }\n    if (args.filename !== undefined) {\n      this.filename = args.filename;\n    }\n    if (args.line_number !== undefined) {\n      this.line_number = args.line_number;\n    }\n    if (args.stack_frames !== undefined) {\n      this.stack_frames = args.stack_frames;\n    }\n    if (args.payload_json !== undefined) {\n      this.payload_json = args.payload_json;\n    }\n    if (args.error_flag !== undefined) {\n      this.error_flag = args.error_flag;\n    }\n  }\n};\ncrouton_thrift.LogRecord.prototype = {};\ncrouton_thrift.LogRecord.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.I64) {\n        this.timestamp_micros = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 13:\n      if (ftype == Thrift.Type.LIST) {\n        var _size8 = 0;\n        var _rtmp312;\n        this.fields = [];\n        var _etype11 = 0;\n        _rtmp312 = input.readListBegin();\n        _etype11 = _rtmp312.etype;\n        _size8 = _rtmp312.size;\n        for (var _i13 = 0; _i13 < _size8; ++_i13)\n        {\n          var elem14 = null;\n          elem14 = new crouton_thrift.KeyValue();\n          elem14.read(input);\n          this.fields.push(elem14);\n        }\n        input.readListEnd();\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 2:\n      if (ftype == Thrift.Type.STRING) {\n        this.runtime_guid = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 3:\n      if (ftype == Thrift.Type.STRING) {\n        this.span_guid = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 4:\n      if (ftype == Thrift.Type.STRING) {\n        this.stable_name = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 5:\n      if (ftype == Thrift.Type.STRING) {\n        this.message = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 6:\n      if (ftype == Thrift.Type.STRING) {\n        this.level = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 7:\n      if (ftype == Thrift.Type.I64) {\n        this.thread_id = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 8:\n      if (ftype == Thrift.Type.STRING) {\n        this.filename = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 9:\n      if (ftype == Thrift.Type.I64) {\n        this.line_number = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 10:\n      if (ftype == Thrift.Type.LIST) {\n        var _size15 = 0;\n        var _rtmp319;\n        this.stack_frames = [];\n        var _etype18 = 0;\n        _rtmp319 = input.readListBegin();\n        _etype18 = _rtmp319.etype;\n        _size15 = _rtmp319.size;\n        for (var _i20 = 0; _i20 < _size15; ++_i20)\n        {\n          var elem21 = null;\n          elem21 = input.readString().value;\n          this.stack_frames.push(elem21);\n        }\n        input.readListEnd();\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 11:\n      if (ftype == Thrift.Type.STRING) {\n        this.payload_json = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 12:\n      if (ftype == Thrift.Type.BOOL) {\n        this.error_flag = input.readBool().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.LogRecord.prototype.write = false && function(output) {\n  output.writeStructBegin('LogRecord');\n  if (this.timestamp_micros !== null && this.timestamp_micros !== undefined) {\n    output.writeFieldBegin('timestamp_micros', Thrift.Type.I64, 1);\n    output.writeI64(this.timestamp_micros);\n    output.writeFieldEnd();\n  }\n  if (this.fields !== null && this.fields !== undefined) {\n    output.writeFieldBegin('fields', Thrift.Type.LIST, 13);\n    output.writeListBegin(Thrift.Type.STRUCT, this.fields.length);\n    for (var iter22 in this.fields)\n    {\n      if (this.fields.hasOwnProperty(iter22))\n      {\n        iter22 = this.fields[iter22];\n        iter22.write(output);\n      }\n    }\n    output.writeListEnd();\n    output.writeFieldEnd();\n  }\n  if (this.runtime_guid !== null && this.runtime_guid !== undefined) {\n    output.writeFieldBegin('runtime_guid', Thrift.Type.STRING, 2);\n    output.writeString(this.runtime_guid);\n    output.writeFieldEnd();\n  }\n  if (this.span_guid !== null && this.span_guid !== undefined) {\n    output.writeFieldBegin('span_guid', Thrift.Type.STRING, 3);\n    output.writeString(this.span_guid);\n    output.writeFieldEnd();\n  }\n  if (this.stable_name !== null && this.stable_name !== undefined) {\n    output.writeFieldBegin('stable_name', Thrift.Type.STRING, 4);\n    output.writeString(this.stable_name);\n    output.writeFieldEnd();\n  }\n  if (this.message !== null && this.message !== undefined) {\n    output.writeFieldBegin('message', Thrift.Type.STRING, 5);\n    output.writeString(this.message);\n    output.writeFieldEnd();\n  }\n  if (this.level !== null && this.level !== undefined) {\n    output.writeFieldBegin('level', Thrift.Type.STRING, 6);\n    output.writeString(this.level);\n    output.writeFieldEnd();\n  }\n  if (this.thread_id !== null && this.thread_id !== undefined) {\n    output.writeFieldBegin('thread_id', Thrift.Type.I64, 7);\n    output.writeI64(this.thread_id);\n    output.writeFieldEnd();\n  }\n  if (this.filename !== null && this.filename !== undefined) {\n    output.writeFieldBegin('filename', Thrift.Type.STRING, 8);\n    output.writeString(this.filename);\n    output.writeFieldEnd();\n  }\n  if (this.line_number !== null && this.line_number !== undefined) {\n    output.writeFieldBegin('line_number', Thrift.Type.I64, 9);\n    output.writeI64(this.line_number);\n    output.writeFieldEnd();\n  }\n  if (this.stack_frames !== null && this.stack_frames !== undefined) {\n    output.writeFieldBegin('stack_frames', Thrift.Type.LIST, 10);\n    output.writeListBegin(Thrift.Type.STRING, this.stack_frames.length);\n    for (var iter23 in this.stack_frames)\n    {\n      if (this.stack_frames.hasOwnProperty(iter23))\n      {\n        iter23 = this.stack_frames[iter23];\n        output.writeString(iter23);\n      }\n    }\n    output.writeListEnd();\n    output.writeFieldEnd();\n  }\n  if (this.payload_json !== null && this.payload_json !== undefined) {\n    output.writeFieldBegin('payload_json', Thrift.Type.STRING, 11);\n    output.writeString(this.payload_json);\n    output.writeFieldEnd();\n  }\n  if (this.error_flag !== null && this.error_flag !== undefined) {\n    output.writeFieldBegin('error_flag', Thrift.Type.BOOL, 12);\n    output.writeBool(this.error_flag);\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\ncrouton_thrift.TraceJoinId = function(args) {\n  this.TraceKey = null;\n  this.Value = null;\n  if (args) {\n    if (args.TraceKey !== undefined) {\n      this.TraceKey = args.TraceKey;\n    } else {\n      throw new Thrift.TProtocolException(Thrift.TProtocolExceptionType.UNKNOWN, 'Required field TraceKey is unset!');\n    }\n    if (args.Value !== undefined) {\n      this.Value = args.Value;\n    } else {\n      throw new Thrift.TProtocolException(Thrift.TProtocolExceptionType.UNKNOWN, 'Required field Value is unset!');\n    }\n  }\n};\ncrouton_thrift.TraceJoinId.prototype = {};\ncrouton_thrift.TraceJoinId.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.STRING) {\n        this.TraceKey = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 2:\n      if (ftype == Thrift.Type.STRING) {\n        this.Value = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.TraceJoinId.prototype.write = false && function(output) {\n  output.writeStructBegin('TraceJoinId');\n  if (this.TraceKey !== null && this.TraceKey !== undefined) {\n    output.writeFieldBegin('TraceKey', Thrift.Type.STRING, 1);\n    output.writeString(this.TraceKey);\n    output.writeFieldEnd();\n  }\n  if (this.Value !== null && this.Value !== undefined) {\n    output.writeFieldBegin('Value', Thrift.Type.STRING, 2);\n    output.writeString(this.Value);\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\ncrouton_thrift.SpanRecord = function(args) {\n  this.span_guid = null;\n  this.trace_guid = null;\n  this.runtime_guid = null;\n  this.span_name = null;\n  this.join_ids = null;\n  this.oldest_micros = null;\n  this.youngest_micros = null;\n  this.attributes = null;\n  this.error_flag = null;\n  this.log_records = null;\n  if (args) {\n    if (args.span_guid !== undefined) {\n      this.span_guid = args.span_guid;\n    }\n    if (args.trace_guid !== undefined) {\n      this.trace_guid = args.trace_guid;\n    }\n    if (args.runtime_guid !== undefined) {\n      this.runtime_guid = args.runtime_guid;\n    }\n    if (args.span_name !== undefined) {\n      this.span_name = args.span_name;\n    }\n    if (args.join_ids !== undefined) {\n      this.join_ids = args.join_ids;\n    }\n    if (args.oldest_micros !== undefined) {\n      this.oldest_micros = args.oldest_micros;\n    }\n    if (args.youngest_micros !== undefined) {\n      this.youngest_micros = args.youngest_micros;\n    }\n    if (args.attributes !== undefined) {\n      this.attributes = args.attributes;\n    }\n    if (args.error_flag !== undefined) {\n      this.error_flag = args.error_flag;\n    }\n    if (args.log_records !== undefined) {\n      this.log_records = args.log_records;\n    }\n  }\n};\ncrouton_thrift.SpanRecord.prototype = {};\ncrouton_thrift.SpanRecord.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.STRING) {\n        this.span_guid = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 11:\n      if (ftype == Thrift.Type.STRING) {\n        this.trace_guid = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 2:\n      if (ftype == Thrift.Type.STRING) {\n        this.runtime_guid = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 3:\n      if (ftype == Thrift.Type.STRING) {\n        this.span_name = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 4:\n      if (ftype == Thrift.Type.LIST) {\n        var _size24 = 0;\n        var _rtmp328;\n        this.join_ids = [];\n        var _etype27 = 0;\n        _rtmp328 = input.readListBegin();\n        _etype27 = _rtmp328.etype;\n        _size24 = _rtmp328.size;\n        for (var _i29 = 0; _i29 < _size24; ++_i29)\n        {\n          var elem30 = null;\n          elem30 = new crouton_thrift.TraceJoinId();\n          elem30.read(input);\n          this.join_ids.push(elem30);\n        }\n        input.readListEnd();\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 5:\n      if (ftype == Thrift.Type.I64) {\n        this.oldest_micros = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 6:\n      if (ftype == Thrift.Type.I64) {\n        this.youngest_micros = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 8:\n      if (ftype == Thrift.Type.LIST) {\n        var _size31 = 0;\n        var _rtmp335;\n        this.attributes = [];\n        var _etype34 = 0;\n        _rtmp335 = input.readListBegin();\n        _etype34 = _rtmp335.etype;\n        _size31 = _rtmp335.size;\n        for (var _i36 = 0; _i36 < _size31; ++_i36)\n        {\n          var elem37 = null;\n          elem37 = new crouton_thrift.KeyValue();\n          elem37.read(input);\n          this.attributes.push(elem37);\n        }\n        input.readListEnd();\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 9:\n      if (ftype == Thrift.Type.BOOL) {\n        this.error_flag = input.readBool().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 10:\n      if (ftype == Thrift.Type.LIST) {\n        var _size38 = 0;\n        var _rtmp342;\n        this.log_records = [];\n        var _etype41 = 0;\n        _rtmp342 = input.readListBegin();\n        _etype41 = _rtmp342.etype;\n        _size38 = _rtmp342.size;\n        for (var _i43 = 0; _i43 < _size38; ++_i43)\n        {\n          var elem44 = null;\n          elem44 = new crouton_thrift.LogRecord();\n          elem44.read(input);\n          this.log_records.push(elem44);\n        }\n        input.readListEnd();\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.SpanRecord.prototype.write = false && function(output) {\n  output.writeStructBegin('SpanRecord');\n  if (this.span_guid !== null && this.span_guid !== undefined) {\n    output.writeFieldBegin('span_guid', Thrift.Type.STRING, 1);\n    output.writeString(this.span_guid);\n    output.writeFieldEnd();\n  }\n  if (this.trace_guid !== null && this.trace_guid !== undefined) {\n    output.writeFieldBegin('trace_guid', Thrift.Type.STRING, 11);\n    output.writeString(this.trace_guid);\n    output.writeFieldEnd();\n  }\n  if (this.runtime_guid !== null && this.runtime_guid !== undefined) {\n    output.writeFieldBegin('runtime_guid', Thrift.Type.STRING, 2);\n    output.writeString(this.runtime_guid);\n    output.writeFieldEnd();\n  }\n  if (this.span_name !== null && this.span_name !== undefined) {\n    output.writeFieldBegin('span_name', Thrift.Type.STRING, 3);\n    output.writeString(this.span_name);\n    output.writeFieldEnd();\n  }\n  if (this.join_ids !== null && this.join_ids !== undefined) {\n    output.writeFieldBegin('join_ids', Thrift.Type.LIST, 4);\n    output.writeListBegin(Thrift.Type.STRUCT, this.join_ids.length);\n    for (var iter45 in this.join_ids)\n    {\n      if (this.join_ids.hasOwnProperty(iter45))\n      {\n        iter45 = this.join_ids[iter45];\n        iter45.write(output);\n      }\n    }\n    output.writeListEnd();\n    output.writeFieldEnd();\n  }\n  if (this.oldest_micros !== null && this.oldest_micros !== undefined) {\n    output.writeFieldBegin('oldest_micros', Thrift.Type.I64, 5);\n    output.writeI64(this.oldest_micros);\n    output.writeFieldEnd();\n  }\n  if (this.youngest_micros !== null && this.youngest_micros !== undefined) {\n    output.writeFieldBegin('youngest_micros', Thrift.Type.I64, 6);\n    output.writeI64(this.youngest_micros);\n    output.writeFieldEnd();\n  }\n  if (this.attributes !== null && this.attributes !== undefined) {\n    output.writeFieldBegin('attributes', Thrift.Type.LIST, 8);\n    output.writeListBegin(Thrift.Type.STRUCT, this.attributes.length);\n    for (var iter46 in this.attributes)\n    {\n      if (this.attributes.hasOwnProperty(iter46))\n      {\n        iter46 = this.attributes[iter46];\n        iter46.write(output);\n      }\n    }\n    output.writeListEnd();\n    output.writeFieldEnd();\n  }\n  if (this.error_flag !== null && this.error_flag !== undefined) {\n    output.writeFieldBegin('error_flag', Thrift.Type.BOOL, 9);\n    output.writeBool(this.error_flag);\n    output.writeFieldEnd();\n  }\n  if (this.log_records !== null && this.log_records !== undefined) {\n    output.writeFieldBegin('log_records', Thrift.Type.LIST, 10);\n    output.writeListBegin(Thrift.Type.STRUCT, this.log_records.length);\n    for (var iter47 in this.log_records)\n    {\n      if (this.log_records.hasOwnProperty(iter47))\n      {\n        iter47 = this.log_records[iter47];\n        iter47.write(output);\n      }\n    }\n    output.writeListEnd();\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\ncrouton_thrift.Auth = function(args) {\n  this.access_token = null;\n  if (args) {\n    if (args.access_token !== undefined) {\n      this.access_token = args.access_token;\n    }\n  }\n};\ncrouton_thrift.Auth.prototype = {};\ncrouton_thrift.Auth.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.STRING) {\n        this.access_token = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 0:\n        input.skip(ftype);\n        break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.Auth.prototype.write = false && function(output) {\n  output.writeStructBegin('Auth');\n  if (this.access_token !== null && this.access_token !== undefined) {\n    output.writeFieldBegin('access_token', Thrift.Type.STRING, 1);\n    output.writeString(this.access_token);\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\ncrouton_thrift.Timing = function(args) {\n  this.receive_micros = null;\n  this.transmit_micros = null;\n  if (args) {\n    if (args.receive_micros !== undefined) {\n      this.receive_micros = args.receive_micros;\n    }\n    if (args.transmit_micros !== undefined) {\n      this.transmit_micros = args.transmit_micros;\n    }\n  }\n};\ncrouton_thrift.Timing.prototype = {};\ncrouton_thrift.Timing.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.I64) {\n        this.receive_micros = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 2:\n      if (ftype == Thrift.Type.I64) {\n        this.transmit_micros = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.Timing.prototype.write = false && function(output) {\n  output.writeStructBegin('Timing');\n  if (this.receive_micros !== null && this.receive_micros !== undefined) {\n    output.writeFieldBegin('receive_micros', Thrift.Type.I64, 1);\n    output.writeI64(this.receive_micros);\n    output.writeFieldEnd();\n  }\n  if (this.transmit_micros !== null && this.transmit_micros !== undefined) {\n    output.writeFieldBegin('transmit_micros', Thrift.Type.I64, 2);\n    output.writeI64(this.transmit_micros);\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\ncrouton_thrift.SampleCount = function(args) {\n  this.oldest_micros = null;\n  this.youngest_micros = null;\n  this.count = null;\n  if (args) {\n    if (args.oldest_micros !== undefined) {\n      this.oldest_micros = args.oldest_micros;\n    }\n    if (args.youngest_micros !== undefined) {\n      this.youngest_micros = args.youngest_micros;\n    }\n    if (args.count !== undefined) {\n      this.count = args.count;\n    }\n  }\n};\ncrouton_thrift.SampleCount.prototype = {};\ncrouton_thrift.SampleCount.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.I64) {\n        this.oldest_micros = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 2:\n      if (ftype == Thrift.Type.I64) {\n        this.youngest_micros = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 3:\n      if (ftype == Thrift.Type.I64) {\n        this.count = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.SampleCount.prototype.write = false && function(output) {\n  output.writeStructBegin('SampleCount');\n  if (this.oldest_micros !== null && this.oldest_micros !== undefined) {\n    output.writeFieldBegin('oldest_micros', Thrift.Type.I64, 1);\n    output.writeI64(this.oldest_micros);\n    output.writeFieldEnd();\n  }\n  if (this.youngest_micros !== null && this.youngest_micros !== undefined) {\n    output.writeFieldBegin('youngest_micros', Thrift.Type.I64, 2);\n    output.writeI64(this.youngest_micros);\n    output.writeFieldEnd();\n  }\n  if (this.count !== null && this.count !== undefined) {\n    output.writeFieldBegin('count', Thrift.Type.I64, 3);\n    output.writeI64(this.count);\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\ncrouton_thrift.MetricsSample = function(args) {\n  this.name = null;\n  this.int64_value = null;\n  this.double_value = null;\n  if (args) {\n    if (args.name !== undefined) {\n      this.name = args.name;\n    } else {\n      throw new Thrift.TProtocolException(Thrift.TProtocolExceptionType.UNKNOWN, 'Required field name is unset!');\n    }\n    if (args.int64_value !== undefined) {\n      this.int64_value = args.int64_value;\n    }\n    if (args.double_value !== undefined) {\n      this.double_value = args.double_value;\n    }\n  }\n};\ncrouton_thrift.MetricsSample.prototype = {};\ncrouton_thrift.MetricsSample.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.STRING) {\n        this.name = input.readString().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 2:\n      if (ftype == Thrift.Type.I64) {\n        this.int64_value = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 3:\n      if (ftype == Thrift.Type.DOUBLE) {\n        this.double_value = input.readDouble().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.MetricsSample.prototype.write = false && function(output) {\n  output.writeStructBegin('MetricsSample');\n  if (this.name !== null && this.name !== undefined) {\n    output.writeFieldBegin('name', Thrift.Type.STRING, 1);\n    output.writeString(this.name);\n    output.writeFieldEnd();\n  }\n  if (this.int64_value !== null && this.int64_value !== undefined) {\n    output.writeFieldBegin('int64_value', Thrift.Type.I64, 2);\n    output.writeI64(this.int64_value);\n    output.writeFieldEnd();\n  }\n  if (this.double_value !== null && this.double_value !== undefined) {\n    output.writeFieldBegin('double_value', Thrift.Type.DOUBLE, 3);\n    output.writeDouble(this.double_value);\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\ncrouton_thrift.Metrics = function(args) {\n  this.counts = null;\n  this.gauges = null;\n  if (args) {\n    if (args.counts !== undefined) {\n      this.counts = args.counts;\n    }\n    if (args.gauges !== undefined) {\n      this.gauges = args.gauges;\n    }\n  }\n};\ncrouton_thrift.Metrics.prototype = {};\ncrouton_thrift.Metrics.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.LIST) {\n        var _size48 = 0;\n        var _rtmp352;\n        this.counts = [];\n        var _etype51 = 0;\n        _rtmp352 = input.readListBegin();\n        _etype51 = _rtmp352.etype;\n        _size48 = _rtmp352.size;\n        for (var _i53 = 0; _i53 < _size48; ++_i53)\n        {\n          var elem54 = null;\n          elem54 = new crouton_thrift.MetricsSample();\n          elem54.read(input);\n          this.counts.push(elem54);\n        }\n        input.readListEnd();\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 2:\n      if (ftype == Thrift.Type.LIST) {\n        var _size55 = 0;\n        var _rtmp359;\n        this.gauges = [];\n        var _etype58 = 0;\n        _rtmp359 = input.readListBegin();\n        _etype58 = _rtmp359.etype;\n        _size55 = _rtmp359.size;\n        for (var _i60 = 0; _i60 < _size55; ++_i60)\n        {\n          var elem61 = null;\n          elem61 = new crouton_thrift.MetricsSample();\n          elem61.read(input);\n          this.gauges.push(elem61);\n        }\n        input.readListEnd();\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.Metrics.prototype.write = false && function(output) {\n  output.writeStructBegin('Metrics');\n  if (this.counts !== null && this.counts !== undefined) {\n    output.writeFieldBegin('counts', Thrift.Type.LIST, 1);\n    output.writeListBegin(Thrift.Type.STRUCT, this.counts.length);\n    for (var iter62 in this.counts)\n    {\n      if (this.counts.hasOwnProperty(iter62))\n      {\n        iter62 = this.counts[iter62];\n        iter62.write(output);\n      }\n    }\n    output.writeListEnd();\n    output.writeFieldEnd();\n  }\n  if (this.gauges !== null && this.gauges !== undefined) {\n    output.writeFieldBegin('gauges', Thrift.Type.LIST, 2);\n    output.writeListBegin(Thrift.Type.STRUCT, this.gauges.length);\n    for (var iter63 in this.gauges)\n    {\n      if (this.gauges.hasOwnProperty(iter63))\n      {\n        iter63 = this.gauges[iter63];\n        iter63.write(output);\n      }\n    }\n    output.writeListEnd();\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\ncrouton_thrift.ReportRequest = function(args) {\n  this.runtime = null;\n  this.span_records = null;\n  this.log_records = null;\n  this.timestamp_offset_micros = null;\n  this.oldest_micros = null;\n  this.youngest_micros = null;\n  this.counters = null;\n  this.internal_logs = null;\n  this.internal_metrics = null;\n  if (args) {\n    if (args.runtime !== undefined) {\n      this.runtime = args.runtime;\n    }\n    if (args.span_records !== undefined) {\n      this.span_records = args.span_records;\n    }\n    if (args.log_records !== undefined) {\n      this.log_records = args.log_records;\n    }\n    if (args.timestamp_offset_micros !== undefined) {\n      this.timestamp_offset_micros = args.timestamp_offset_micros;\n    }\n    if (args.oldest_micros !== undefined) {\n      this.oldest_micros = args.oldest_micros;\n    }\n    if (args.youngest_micros !== undefined) {\n      this.youngest_micros = args.youngest_micros;\n    }\n    if (args.counters !== undefined) {\n      this.counters = args.counters;\n    }\n    if (args.internal_logs !== undefined) {\n      this.internal_logs = args.internal_logs;\n    }\n    if (args.internal_metrics !== undefined) {\n      this.internal_metrics = args.internal_metrics;\n    }\n  }\n};\ncrouton_thrift.ReportRequest.prototype = {};\ncrouton_thrift.ReportRequest.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.STRUCT) {\n        this.runtime = new crouton_thrift.Runtime();\n        this.runtime.read(input);\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 3:\n      if (ftype == Thrift.Type.LIST) {\n        var _size64 = 0;\n        var _rtmp368;\n        this.span_records = [];\n        var _etype67 = 0;\n        _rtmp368 = input.readListBegin();\n        _etype67 = _rtmp368.etype;\n        _size64 = _rtmp368.size;\n        for (var _i69 = 0; _i69 < _size64; ++_i69)\n        {\n          var elem70 = null;\n          elem70 = new crouton_thrift.SpanRecord();\n          elem70.read(input);\n          this.span_records.push(elem70);\n        }\n        input.readListEnd();\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 4:\n      if (ftype == Thrift.Type.LIST) {\n        var _size71 = 0;\n        var _rtmp375;\n        this.log_records = [];\n        var _etype74 = 0;\n        _rtmp375 = input.readListBegin();\n        _etype74 = _rtmp375.etype;\n        _size71 = _rtmp375.size;\n        for (var _i76 = 0; _i76 < _size71; ++_i76)\n        {\n          var elem77 = null;\n          elem77 = new crouton_thrift.LogRecord();\n          elem77.read(input);\n          this.log_records.push(elem77);\n        }\n        input.readListEnd();\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 5:\n      if (ftype == Thrift.Type.I64) {\n        this.timestamp_offset_micros = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 7:\n      if (ftype == Thrift.Type.I64) {\n        this.oldest_micros = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 8:\n      if (ftype == Thrift.Type.I64) {\n        this.youngest_micros = input.readI64().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 9:\n      if (ftype == Thrift.Type.LIST) {\n        var _size78 = 0;\n        var _rtmp382;\n        this.counters = [];\n        var _etype81 = 0;\n        _rtmp382 = input.readListBegin();\n        _etype81 = _rtmp382.etype;\n        _size78 = _rtmp382.size;\n        for (var _i83 = 0; _i83 < _size78; ++_i83)\n        {\n          var elem84 = null;\n          elem84 = new crouton_thrift.NamedCounter();\n          elem84.read(input);\n          this.counters.push(elem84);\n        }\n        input.readListEnd();\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 10:\n      if (ftype == Thrift.Type.LIST) {\n        var _size85 = 0;\n        var _rtmp389;\n        this.internal_logs = [];\n        var _etype88 = 0;\n        _rtmp389 = input.readListBegin();\n        _etype88 = _rtmp389.etype;\n        _size85 = _rtmp389.size;\n        for (var _i90 = 0; _i90 < _size85; ++_i90)\n        {\n          var elem91 = null;\n          elem91 = new crouton_thrift.LogRecord();\n          elem91.read(input);\n          this.internal_logs.push(elem91);\n        }\n        input.readListEnd();\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 11:\n      if (ftype == Thrift.Type.STRUCT) {\n        this.internal_metrics = new crouton_thrift.Metrics();\n        this.internal_metrics.read(input);\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.ReportRequest.prototype.write = false && function(output) {\n  output.writeStructBegin('ReportRequest');\n  if (this.runtime !== null && this.runtime !== undefined) {\n    output.writeFieldBegin('runtime', Thrift.Type.STRUCT, 1);\n    this.runtime.write(output);\n    output.writeFieldEnd();\n  }\n  if (this.span_records !== null && this.span_records !== undefined) {\n    output.writeFieldBegin('span_records', Thrift.Type.LIST, 3);\n    output.writeListBegin(Thrift.Type.STRUCT, this.span_records.length);\n    for (var iter92 in this.span_records)\n    {\n      if (this.span_records.hasOwnProperty(iter92))\n      {\n        iter92 = this.span_records[iter92];\n        iter92.write(output);\n      }\n    }\n    output.writeListEnd();\n    output.writeFieldEnd();\n  }\n  if (this.log_records !== null && this.log_records !== undefined) {\n    output.writeFieldBegin('log_records', Thrift.Type.LIST, 4);\n    output.writeListBegin(Thrift.Type.STRUCT, this.log_records.length);\n    for (var iter93 in this.log_records)\n    {\n      if (this.log_records.hasOwnProperty(iter93))\n      {\n        iter93 = this.log_records[iter93];\n        iter93.write(output);\n      }\n    }\n    output.writeListEnd();\n    output.writeFieldEnd();\n  }\n  if (this.timestamp_offset_micros !== null && this.timestamp_offset_micros !== undefined) {\n    output.writeFieldBegin('timestamp_offset_micros', Thrift.Type.I64, 5);\n    output.writeI64(this.timestamp_offset_micros);\n    output.writeFieldEnd();\n  }\n  if (this.oldest_micros !== null && this.oldest_micros !== undefined) {\n    output.writeFieldBegin('oldest_micros', Thrift.Type.I64, 7);\n    output.writeI64(this.oldest_micros);\n    output.writeFieldEnd();\n  }\n  if (this.youngest_micros !== null && this.youngest_micros !== undefined) {\n    output.writeFieldBegin('youngest_micros', Thrift.Type.I64, 8);\n    output.writeI64(this.youngest_micros);\n    output.writeFieldEnd();\n  }\n  if (this.counters !== null && this.counters !== undefined) {\n    output.writeFieldBegin('counters', Thrift.Type.LIST, 9);\n    output.writeListBegin(Thrift.Type.STRUCT, this.counters.length);\n    for (var iter94 in this.counters)\n    {\n      if (this.counters.hasOwnProperty(iter94))\n      {\n        iter94 = this.counters[iter94];\n        iter94.write(output);\n      }\n    }\n    output.writeListEnd();\n    output.writeFieldEnd();\n  }\n  if (this.internal_logs !== null && this.internal_logs !== undefined) {\n    output.writeFieldBegin('internal_logs', Thrift.Type.LIST, 10);\n    output.writeListBegin(Thrift.Type.STRUCT, this.internal_logs.length);\n    for (var iter95 in this.internal_logs)\n    {\n      if (this.internal_logs.hasOwnProperty(iter95))\n      {\n        iter95 = this.internal_logs[iter95];\n        iter95.write(output);\n      }\n    }\n    output.writeListEnd();\n    output.writeFieldEnd();\n  }\n  if (this.internal_metrics !== null && this.internal_metrics !== undefined) {\n    output.writeFieldBegin('internal_metrics', Thrift.Type.STRUCT, 11);\n    this.internal_metrics.write(output);\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\ncrouton_thrift.Command = function(args) {\n  this.disable = null;\n  if (args) {\n    if (args.disable !== undefined) {\n      this.disable = args.disable;\n    }\n  }\n};\ncrouton_thrift.Command.prototype = {};\ncrouton_thrift.Command.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.BOOL) {\n        this.disable = input.readBool().value;\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 0:\n        input.skip(ftype);\n        break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.Command.prototype.write = false && function(output) {\n  output.writeStructBegin('Command');\n  if (this.disable !== null && this.disable !== undefined) {\n    output.writeFieldBegin('disable', Thrift.Type.BOOL, 1);\n    output.writeBool(this.disable);\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\ncrouton_thrift.ReportResponse = function(args) {\n  this.commands = null;\n  this.timing = null;\n  if (args) {\n    if (args.commands !== undefined) {\n      this.commands = args.commands;\n    }\n    if (args.timing !== undefined) {\n      this.timing = args.timing;\n    }\n  }\n};\ncrouton_thrift.ReportResponse.prototype = {};\ncrouton_thrift.ReportResponse.prototype.read = false && function(input) {\n  input.readStructBegin();\n  while (true)\n  {\n    var ret = input.readFieldBegin();\n    var fname = ret.fname;\n    var ftype = ret.ftype;\n    var fid = ret.fid;\n    if (ftype == Thrift.Type.STOP) {\n      break;\n    }\n    switch (fid)\n    {\n      case 1:\n      if (ftype == Thrift.Type.LIST) {\n        var _size96 = 0;\n        var _rtmp3100;\n        this.commands = [];\n        var _etype99 = 0;\n        _rtmp3100 = input.readListBegin();\n        _etype99 = _rtmp3100.etype;\n        _size96 = _rtmp3100.size;\n        for (var _i101 = 0; _i101 < _size96; ++_i101)\n        {\n          var elem102 = null;\n          elem102 = new crouton_thrift.Command();\n          elem102.read(input);\n          this.commands.push(elem102);\n        }\n        input.readListEnd();\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      case 2:\n      if (ftype == Thrift.Type.STRUCT) {\n        this.timing = new crouton_thrift.Timing();\n        this.timing.read(input);\n      } else {\n        input.skip(ftype);\n      }\n      break;\n      default:\n        input.skip(ftype);\n    }\n    input.readFieldEnd();\n  }\n  input.readStructEnd();\n  return;\n};\n\ncrouton_thrift.ReportResponse.prototype.write = false && function(output) {\n  output.writeStructBegin('ReportResponse');\n  if (this.commands !== null && this.commands !== undefined) {\n    output.writeFieldBegin('commands', Thrift.Type.LIST, 1);\n    output.writeListBegin(Thrift.Type.STRUCT, this.commands.length);\n    for (var iter103 in this.commands)\n    {\n      if (this.commands.hasOwnProperty(iter103))\n      {\n        iter103 = this.commands[iter103];\n        iter103.write(output);\n      }\n    }\n    output.writeListEnd();\n    output.writeFieldEnd();\n  }\n  if (this.timing !== null && this.timing !== undefined) {\n    output.writeFieldBegin('timing', Thrift.Type.STRUCT, 2);\n    this.timing.write(output);\n    output.writeFieldEnd();\n  }\n  output.writeFieldStop();\n  output.writeStructEnd();\n  return;\n};\n\n\nmodule.exports.crouton_thrift = crouton_thrift;\nmodule.exports.Thrift = {}\n})();","const util = require('./util');\n\n/* global WorkerGlobalScope */\n// Find the HTML element that included the tracing library (if there is one).\n// This relies on the fact that scripts are executed as soon as they are\n// included -- thus 'this' script is the last one in the array at the time\n// this is run.\nlet hostScriptElement = (function () {\n    // check to see if we're in a webworker\n    // eslint-disable-next-line no-restricted-globals\n    if (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope) {\n        return null;\n    }\n    if (!util.isBrowser()) {\n        return null;\n    }\n    let scripts = document.getElementsByTagName('SCRIPT');\n    if (!(scripts.length > 0)) {\n        return null;\n    }\n    return scripts[scripts.length - 1];\n}());\n\nfunction urlQueryParameters(defaults) {\n    let vars = {};\n    let qi = window.location.href.indexOf('?');\n    if (qi < 0) {\n        return vars;\n    }\n    let slice = window.location.href.slice(qi + 1);\n    if (slice.indexOf('#') >= 0) {\n        slice = slice.slice(0, slice.indexOf('#'));\n    }\n    let hashes = slice.replace(/\\+/, '%20').split('&');\n    for (let i = 0; i < hashes.length; i++) {\n        let hash = hashes[i].split('=');\n        vars[decodeURIComponent(hash[0])] = decodeURIComponent(hash[1]);\n    }\n    return vars;\n}\n\n// Parses options out of the host <script> element. Allows for easy configuration\n// via the HTML element. Example:\n//\n// <script src='lightstep.min.js'\n//      data-access_token='{my_access_token}'\n//      data-component_name='my_component'></script>\n//\n// Note: relies on the global hostScriptElement variable defined above.\n//\nfunction parseScriptElementOptions(opts, browserOpts) {\n    if (!hostScriptElement) {\n        return;\n    }\n\n    let { dataset } = hostScriptElement;\n\n    let accessToken = dataset.access_token;\n    if (typeof accessToken === 'string' && accessToken.length > 0) {\n        opts.access_token = accessToken;\n    }\n\n    let componentName = dataset.component_name;\n    if (typeof componentName === 'string' && componentName.length > 0) {\n        opts.component_name = componentName;\n    }\n\n    let collectorHost = dataset.collector_host;\n    if (typeof collectorHost === 'string' && collectorHost.length > 0) {\n        opts.collector_host = collectorHost;\n    }\n    let collectorPort = dataset.collector_port;\n    if (collectorPort) {\n        opts.collector_port = parseInt(collectorPort, 10);\n    }\n    let collectorPath = dataset.collector_path;\n    if (typeof collectorPath === 'string' && collectorPath.length > 0) {\n        opts.collector_path = collectorPath;\n    }\n    let collectorEncryption = dataset.collector_encryption;\n    if (collectorEncryption) {\n        opts.collector_encryption = collectorEncryption;\n    }\n\n    let { enable } = dataset;\n    if (typeof enable === 'string') {\n        if (enable === 'true') {\n            opts.enable = true;\n        } else if (enable === 'false') {\n            opts.enable = false;\n        }\n    }\n    let { verbosity } = dataset;\n    if (typeof verbosity === 'string') {\n        opts.verbosity = parseInt(verbosity, 10);\n    }\n\n    let init = dataset.init_global_tracer;\n    if (typeof init === 'string') {\n        if (init === 'true') {\n            browserOpts.init_global_tracer = true;\n        } else if (init === 'false') {\n            browserOpts.init_global_tracer = false;\n        }\n    }\n\n    // NOTE: this is a little inelegant as this is hard-coding support for a\n    // \"plug-in\" option.\n    if (typeof dataset.xhr_instrumentation === 'string' && dataset.xhr_instrumentation === 'true') {\n        opts.xhr_instrumentation = true;\n    }\n\n    if (typeof dataset.instrument_page_load === 'string' && dataset.instrument_page_load === 'true') {\n        opts.instrument_page_load = true;\n    }\n}\n\nfunction parseScriptElementOptionsNoop(opts, browserOpts) {\n\n}\n\n// Parses options out of the current URL query string. The query parameters use\n// the 'lightstep_' prefix to reduce the chance of collision with\n// application-specific query parameters.\n//\n// This mechanism is particularly useful for debugging purposes as it does not\n// require any code or configuration changes.\n//\nfunction parseURLQueryOptions(opts) {\n    let params = urlQueryParameters();\n    if (params.lightstep_verbosity) {\n        try {\n            opts.verbosity = parseInt(params.lightstep_verbosity, 10);\n        } catch (_ignored) { /* Ignored */ }\n    }\n    if (params.lightstep_log_to_console) {\n        opts.log_to_console = true;\n    }\n}\n\nfunction parseURLQueryOptionsNoop(opts) {\n    return {};\n}\n\nmodule.exports = {\n    parseScriptElementOptions : util.isBrowser() ? parseScriptElementOptions : parseScriptElementOptionsNoop,\n    parseURLQueryOptions      : util.isBrowser() ? parseURLQueryOptions : parseURLQueryOptionsNoop,\n};\n","// eslint-disable-next-line import/extensions\nconst optionsParser = require('./options_parser.js');\nconst util = require('./util');\n\nconst kRuntimeGUIDCookiePrefix = 'lightstep_guid';\nconst kSessionIDCookieKey = 'lightstep_session_id';\nconst kCookieTimeToLiveSeconds = 7 * 24 * 60 * 60;\n\nlet nowMicrosImp = (function () {\n    // Is a hi-res timer available?\n    if (window.performance\n        && window.performance.now\n        && window.performance.timing\n        && window.performance.timing.navigationStart) {\n        let start = performance.timing.navigationStart;\n        return function () {\n            return Math.floor((start + performance.now()) * 1000.0);\n        };\n    }\n    // The low-res timer is the best we can do\n    return function () {\n        return Date.now() * 1000.0;\n    };\n}());\n\nclass PlatformBrowser {\n    name() {\n        return 'browser';\n    }\n\n    nowMicros() {\n        return nowMicrosImp();\n    }\n\n    // Return the GUID to use for the runtime. The intention is to reuse the\n    // GUID so that logically a single browser session looks like a single\n    // runtime.\n    runtimeGUID(groupName) {\n        // Account for the groupName in the same that multiple apps or services\n        // are running on the same domain (and should not share the same\n        // runtime GUID).\n        let cookieKey = encodeURIComponent(`${kRuntimeGUIDCookiePrefix}/${groupName}`);\n        let uuid = util.cookie(cookieKey) || this._generateLongUUID();\n        util.cookie(cookieKey, uuid, kCookieTimeToLiveSeconds, '/');\n\n        // Also create a session ID as well to give the server more information\n        // to coordinate with.\n        let sessionID = util.cookie(kSessionIDCookieKey) || this._generateLongUUID();\n        util.cookie(kSessionIDCookieKey, sessionID, kCookieTimeToLiveSeconds, '/');\n\n        return uuid;\n    }\n\n    generateUUID() {\n        return this._generateLongUUID();\n    }\n\n    _generateLongUUID() {\n        /* eslint-disable no-bitwise */\n        let p0 = `00000000${Math.abs((Math.random() * 0xFFFFFFFF) | 0).toString(16)}`.substr(-8);\n        let p1 = `00000000${Math.abs((Math.random() * 0xFFFFFFFF) | 0).toString(16)}`.substr(-8);\n        return `${p0}${p1}`;\n        /* eslint-enable no-bitwise */\n    }\n\n    onBeforeExit(...args) {\n        // This will result in the final report not being made in non-browser\n        // environments like React Native. Flush should be called explicitly in\n        // those environments\n        if (util.isBrowser()) {\n            window.addEventListener('beforeunload', ...args);\n        }\n    }\n\n    plugins(opts) {\n        return [\n            require('../../../plugins/instrument_xhr'),\n            require('../../../plugins/instrument_fetch'),\n            require('../../../plugins/instrument_document_load'),\n        ];\n    }\n\n    options(imp) {\n        let tracerOpts = {};\n        let browserOpts = {};\n        optionsParser.parseScriptElementOptions(tracerOpts, browserOpts);\n        optionsParser.parseURLQueryOptions(tracerOpts, browserOpts);\n        return tracerOpts;\n    }\n\n    static initLibrary(lib) {\n        let tracerOpts = {};\n        let browserOpts = {};\n        optionsParser.parseScriptElementOptions(tracerOpts, browserOpts);\n\n        if (browserOpts.init_global_tracer) {\n            PlatformBrowser.initGlobalTracer(lib, tracerOpts);\n        }\n    }\n\n    static initGlobalTracer(lib, opts) {\n        if (typeof window !== 'object') {\n            return;\n        }\n        if (typeof window.opentracing !== 'object') {\n            return;\n        }\n        opentracing.initGlobalTracer(new lib.Tracer(opts)); // eslint-disable-line no-undef\n    }\n\n    tracerTags() {\n        return {\n            'lightstep.tracer_platform' : 'browser',\n        };\n    }\n\n    // There's no way to truly \"fatal\" on the browser; the best approximation\n    // is an Error exception.\n    fatal(message) {\n        throw new Error(message);\n    }\n\n    localStoreGet(key) {\n        try {\n            if (!window.sessionStorage) {\n                return null;\n            }\n        } catch (_ignored) {\n            // Accessing `sessionStorage` or `localStorage` in an `<iframe>` in Chrome throws when\n            // the user setting \"block third-party cookies and site data\" is turned on.\n            //\n            // eslint-disable-next-line max-len\n            // https://www.chromium.org/for-testers/bug-reporting-guidelines/uncaught-securityerror-failed-to-read-the-localstorage-property-from-window-access-is-denied-for-this-document\n            return null;\n        }\n        try {\n            return JSON.parse(sessionStorage.getItem(`lightstep/${key}`));\n        } catch (_ignored) {\n            return null;\n        }\n    }\n\n    localStoreSet(key, value) {\n        try {\n            if (!window.sessionStorage) {\n                return;\n            }\n        } catch (_ignored) {\n            // (See comment above)\n            return;\n        }\n        try {\n            sessionStorage.setItem(`lightstep/${key}`, JSON.stringify(value));\n        } catch (_ignored) { /* Ignored */ }\n    }\n}\n\nmodule.exports = PlatformBrowser;\n","// eslint-disable-next-line import/extensions\nmodule.exports = require('./generated/thrift_all.js').Thrift;\n","export default class TransportBrowser {\n    constructor() {\n        this._host = '';\n        this._port = 0;\n        this._path = '';\n        this._encryption = '';\n    }\n\n    ensureConnection(opts) {\n        this._host = opts.collector_host;\n        this._port = opts.collector_port;\n        this._path = opts.collector_path;\n        this._encryption = opts.collector_encryption;\n    }\n\n    report(detached, auth, report, done) {\n        try {\n            if (!detached) {\n                this._reportAJAX(auth, report, done);\n            } else {\n                this._reportAsyncScript(auth, report, done);\n            }\n        } catch (e) {\n            return done(e, null);\n        }\n    }\n\n    _reportAJAX(auth, report, done) {\n        let payload = JSON.stringify(report.toThrift());\n        let protocol = (this._encryption === 'none') ? 'http' : 'https';\n        let url = `${protocol}://${this._host}:${this._port}${this._path}/api/v0/reports`;\n        let xhr = new XMLHttpRequest();\n        xhr.open('POST', url);\n        // Note: the browser automatically sets 'Connection' and 'Content-Length'\n        // and *does not* allow they to be set manually\n        xhr.setRequestHeader('LightStep-Access-Token', auth.getAccessToken());\n        xhr.setRequestHeader('Content-Type', 'application/json');\n        //req.setRequestHeader('Content-Encoding', 'gzip');\n        xhr.onreadystatechange = function () {\n            if (this.readyState === 4) {\n                let err = null;\n                let resp = null;\n                if (this.status !== 200) {\n                    err = new Error(`status code = ${this.status}`);\n                } else if (!this.responseText) {\n                    err = new Error('unexpected empty response');\n                } else {\n                    try {\n                        resp = JSON.parse(this.responseText);\n                    } catch (exception) {\n                        err = exception;\n                    }\n                }\n                return done(err, resp);\n            }\n        };\n        xhr.send(payload);\n    }\n\n    // Do a \"tail flush\" using an async browser script load.  This does not get\n    // interrupted as a normal Thirft RPC would when navigating away from\n    // the page.\n    _reportAsyncScript(auth, report, done) {\n        let authJSON   = JSON.stringify(auth.toThrift());\n        let reportJSON = JSON.stringify(report.toThrift());\n        let protocol = (this._encryption === 'none') ? 'http' : 'https';\n        let url = `${protocol}://${this._host}:${this._port}${this._path}/_rpc/v1/reports/uri_encoded`\n            + `?auth=${encodeURIComponent(authJSON)}`\n            + `&report=${encodeURIComponent(reportJSON)}`;\n\n        let elem = document.createElement('script');\n        elem.async = true;\n        elem.defer = true;\n        elem.src = url;\n        elem.type = 'text/javascript';\n\n        let hostElem = document.getElementsByTagName('head')[0];\n        if (hostElem) {\n            hostElem.appendChild(elem);\n        }\n        return done(null, null);\n    }\n}\n","/* eslint-disable */\n\nfunction isBrowser() {\n    return typeof document !== \"undefined\";\n}\n\n// This function is copied directly from https://github.com/litejs/browser-cookie-lite.\n// It is licensed under the MIT License and authored by Lauri Rooden.\nfunction cookie(name, value, ttl, path, domain, secure) {\n    if (arguments.length > 1) {\n        let newCookie = name + '=' + encodeURIComponent(value) +\n            (ttl ? \"; expires=\" + new Date(+new Date()+(ttl*1000)).toUTCString() : '') +\n            (path   ? \"; path=\" + path : '') +\n            (domain ? \"; domain=\" + domain : '') +\n            (secure ? \"; secure\" : '');\n        document.cookie = newCookie;\n        return newCookie;\n    }\n    return decodeURIComponent(((\"; \"+document.cookie).split(\"; \"+name+\"=\")[1]||\"\").split(\";\")[0]);\n}\n\nfunction cookieNoop() {\n    return null;\n}\n\n/* eslint-enable */\n\nmodule.exports = {\n    cookie    : isBrowser() ? cookie : cookieNoop,\n    isBrowser : isBrowser,\n};\n","export default class UnsupportedPropagator {\n    constructor(tracer, name) {\n        this._tracer = tracer;\n        this._name = name;\n    }\n\n    inject(spanContext, carrier) {\n        this._tracer._error(`Unsupported format: ${this._name}`);\n        return null;\n    }\n\n    extract(carrier) {\n        this._tracer._error(`Unsupported format: ${this._name}`);\n    }\n}\n","import LightStepPropagator from './propagator_ls';\n\nconst CARRIER_B3_TRACER_STATE_PREFIX = 'x-b3-';\n\nexport default class B3Propagator extends LightStepPropagator {\n    constructor(tracer) {\n        super(tracer);\n        this._carrierPrefix = CARRIER_B3_TRACER_STATE_PREFIX;\n    }\n\n    inject(spanContext, carrier) {\n        if (!carrier) {\n            this._tracer._error('Unexpected null carrier in call to inject');\n            return;\n        }\n        if (typeof carrier !== 'object') {\n            this._tracer._error(`Unexpected '${typeof carrier}' FORMAT_TEXT_MAP carrier in call to inject`);\n            return;\n        }\n\n        let traceId = spanContext.traceGUID();\n        if (traceId.length === 32 && traceId.substr(0, 16) === '0000000000000000') {\n            traceId = traceId.substr(16); // take least significant 8 bytes (16 chars)\n        }\n\n        carrier[`${this._carrierPrefix}spanid`] = spanContext._guid;\n        carrier[`${this._carrierPrefix}traceid`] = traceId;\n        if (spanContext._sampled) {\n            carrier[`${this._carrierPrefix}sampled`] = '1';\n        } else {\n            carrier[`${this._carrierPrefix}sampled`] = '0';\n        }\n        spanContext.forEachBaggageItem((key, value) => {\n            carrier[`${this._baggagePrefix}${key}`] = value;\n        });\n        return carrier;\n    }\n}\n","import _each from '../_each';\nimport SpanContextImp from './span_context_imp';\nimport CARRIER_BAGGAGE_PREFIX from './propagator_ls';\n\nconst CARRIER_DD_TRACER_STATE_PREFIX = 'x-datadog-';\n\nexport default class DDPropagator {\n    constructor(tracer) {\n        this._tracer = tracer;\n        this._baggagePrefix = CARRIER_BAGGAGE_PREFIX;\n        this._carrierPrefix = CARRIER_DD_TRACER_STATE_PREFIX;\n    }\n\n    inject(spanContext, carrier) {\n        if (!carrier) {\n            this._tracer._error('Unexpected null carrier in call to inject');\n            return;\n        }\n        if (typeof carrier !== 'object') {\n            this._tracer._error(`Unexpected '${typeof carrier}' FORMAT_TEXT_MAP carrier in call to inject`);\n            return;\n        }\n\n        // eslint-disable-next-line max-len\n        // Per https://github.com/lightstep/lightstep-tracer-javascript/blob/master/src/imp/platform/node/platform_node.js#L91\n        // all generated GUIDs are base 16 strings.\n        // DD headers expect integers, not base 16 values.\n        carrier[`${this._carrierPrefix}parent-id`] = parseInt(spanContext._guid, 16).toString();\n        carrier[`${this._carrierPrefix}trace-id`] = parseInt(spanContext.traceGUID(), 16).toString();\n        if (spanContext._sampled) {\n            carrier[`${this._carrierPrefix}sampling-priority`] = '1';\n        } else {\n            carrier[`${this._carrierPrefix}sampling-priority`] = '0';\n        }\n\n        spanContext.forEachBaggageItem((key, value) => {\n            carrier[`${this._baggagePrefix}${key}`] = value;\n        });\n        return carrier;\n    }\n\n    extract(carrier) {\n        // Iterate over the contents of the carrier and set the properties\n        // accordingly.\n        let foundFields = 0;\n        let spanGUID = null;\n        let traceGUID = null;\n        let sampled = true;\n\n        _each(carrier, (value, key) => {\n            key = key.toLowerCase();\n            if (key.substr(0, this._carrierPrefix.length) !== this._carrierPrefix) {\n                return;\n            }\n            let suffix = key.substr(this._carrierPrefix.length);\n\n            switch (suffix) {\n            case 'trace-id':\n                foundFields++;\n                traceGUID = parseInt(value, 10).toString(16);\n                break;\n            case 'parent-id':\n                foundFields++;\n                spanGUID = parseInt(value, 10).toString(16);\n                break;\n            case 'sampling-priority':\n                // TODO: support sampling priority somehow. This is a float64 that does not\n                // necessarily represent the sampling decision\n                if (value === 0) {\n                    sampled = false;\n                }\n                break;\n            default:\n                this._tracer._error(`Unrecognized carrier key '${key}' with recognized prefix. Ignoring.`);\n                break;\n            }\n        });\n\n        if (foundFields === 0) {\n            // This is not an error per se, there was simply no SpanContext\n            // in the carrier.\n            return null;\n        }\n        if (foundFields < 2) {\n            // A partial SpanContext suggests some sort of data corruption.\n            this._tracer._error(`Only found a partial SpanContext: ${carrier}`);\n            return null;\n        }\n\n        let spanContext = new SpanContextImp(spanGUID, traceGUID, sampled);\n\n        _each(carrier, (value, key) => {\n            key = key.toLowerCase();\n            if (key.substr(0, this._baggagePrefix.length) !== this._baggagePrefix) {\n                return;\n            }\n            let suffix = key.substr(this._baggagePrefix.length);\n            spanContext.setBaggageItem(suffix, value);\n        });\n        return spanContext;\n    }\n}\n","import _each from '../_each';\nimport SpanContextImp from './span_context_imp';\n\nconst CARRIER_TRACER_STATE_PREFIX = 'ot-tracer-';\nconst CARRIER_BAGGAGE_PREFIX = 'ot-baggage-';\n\nexport default class LightStepPropagator {\n    constructor(tracer) {\n        this._tracer = tracer;\n        this._carrierPrefix = CARRIER_TRACER_STATE_PREFIX;\n        this._baggagePrefix = CARRIER_BAGGAGE_PREFIX;\n    }\n\n    inject(spanContext, carrier) {\n        if (!carrier) {\n            this._tracer._error('Unexpected null carrier in call to inject');\n            return;\n        }\n        if (typeof carrier !== 'object') {\n            this._tracer._error(`Unexpected '${typeof carrier}' FORMAT_TEXT_MAP carrier in call to inject`);\n            return;\n        }\n\n        carrier[`${this._carrierPrefix}spanid`] = spanContext._guid;\n        carrier[`${this._carrierPrefix}traceid`] = spanContext._traceGUID;\n        carrier[`${this._carrierPrefix}sampled`] = 'true';\n        spanContext.forEachBaggageItem((key, value) => {\n            carrier[`${this._baggagePrefix}${key}`] = value;\n        });\n        return carrier;\n    }\n\n    extract(carrier) {\n        // Iterate over the contents of the carrier and set the properties\n        // accordingly.\n        let foundFields = 0;\n        let spanGUID = null;\n        let traceGUID = null;\n        let sampled = true;\n\n        _each(carrier, (value, key) => {\n            key = key.toLowerCase();\n            if (key.substr(0, this._carrierPrefix.length) !== this._carrierPrefix) {\n                return;\n            }\n            let suffix = key.substr(this._carrierPrefix.length);\n\n            switch (suffix) {\n            case 'traceid':\n                foundFields++;\n                traceGUID = value;\n                break;\n            case 'spanid':\n                foundFields++;\n                spanGUID = value;\n                break;\n            case 'sampled':\n                switch (value) {\n                case 0:\n                case '0':\n                case false:\n                case 'false':\n                    sampled = false;\n                    break;\n                default:\n                    sampled = true;\n                    break;\n                }\n                break;\n            default:\n                this._tracer._error(`Unrecognized carrier key '${key}' with recognized prefix. Ignoring.`);\n                break;\n            }\n        });\n\n        if (foundFields === 0) {\n            // This is not an error per se, there was simply no SpanContext\n            // in the carrier.\n            return null;\n        }\n        if (foundFields < 2) {\n            // A partial SpanContext suggests some sort of data corruption.\n            this._tracer._error(`Only found a partial SpanContext: ${carrier}`);\n            return null;\n        }\n\n        let spanContext = new SpanContextImp(spanGUID, traceGUID, sampled);\n\n        _each(carrier, (value, key) => {\n            key = key.toLowerCase();\n            if (key.substr(0, this._baggagePrefix.length) !== this._baggagePrefix) {\n                return;\n            }\n            let suffix = key.substr(this._baggagePrefix.length);\n            spanContext.setBaggageItem(suffix, value);\n        });\n        return spanContext;\n    }\n}\n","import { crouton_thrift } from '../platform_abstraction_layer'; // eslint-disable-line camelcase\nimport _each from '../_each'; // eslint-disable-line camelcase\nimport * as coerce from './coerce';\n\nexport default class ReportImp {\n    constructor(runtime, oldestMicros, youngestMicros, spanRecords, internalLogs, counters, timestampOffsetMicros) {\n        this._runtime = runtime;\n        this._oldestMicros = oldestMicros;\n        this._youngestMicros = youngestMicros;\n        this._spanRecords = spanRecords;\n        this._internalLogs = internalLogs;\n        this._counters = counters;\n        this._timestampOffsetMicros = timestampOffsetMicros;\n    }\n\n    getSpanRecords() {\n        return this._spanRecords;\n    }\n\n    getInternalLogs() {\n        return this._internalLogs;\n    }\n\n    getCounters() {\n        return this._counters;\n    }\n\n    toThrift() {\n        _each(this._spanRecords, (span) => {\n            span.runtime_guid = this._runtimeGUID;\n        });\n\n        let thriftCounters = [];\n        _each(this._counters, (value, key) => {\n            if (value === 0) {\n                return;\n            }\n            // eslint-disable-next-line camelcase\n            thriftCounters.push(new crouton_thrift.MetricsSample({\n                name         : coerce.toString(key),\n                double_value : coerce.toNumber(value),\n            }));\n        });\n\n        let thriftSpanRecords = [];\n        _each(this._spanRecords, (spanRecord) => {\n            thriftSpanRecords.push(spanRecord._toThrift());\n        });\n\n        // eslint-disable-next-line camelcase\n        return new crouton_thrift.ReportRequest({\n            runtime          : this._runtime.toThrift(),\n            oldest_micros    : this._oldestMicros,\n            youngest_micros  : this._youngestMicros,\n            span_records     : thriftSpanRecords,\n            internal_logs    : this._internalLogs,\n            // eslint-disable-next-line camelcase\n            internal_metrics : new crouton_thrift.Metrics({\n                counts : thriftCounters,\n            }),\n            timestamp_offset_micros : this._timestampOffsetMicros,\n        });\n    }\n}\n","import { crouton_thrift } from '../platform_abstraction_layer'; // eslint-disable-line camelcase\nimport _each from '../_each'; // eslint-disable-line camelcase\nimport * as coerce from './coerce';\n\nexport default class RuntimeImp {\n    constructor(runtimeGUID, startMicros, componentName, attributes) {\n        this._runtimeGUID = runtimeGUID;\n        this._startMicros = startMicros;\n        this._componentName = componentName;\n        this._attributes = attributes;\n    }\n\n    toThrift() {\n        let thriftAttrs = [];\n        _each(this._attributes, (val, key) => {\n            // eslint-disable-next-line camelcase\n            thriftAttrs.push(new crouton_thrift.KeyValue({\n                Key   : coerce.toString(key),\n                Value : coerce.toString(val),\n            }));\n        });\n\n        // NOTE: for legacy reasons, the Thrift field is called \"group_name\"\n        // but is semantically equivalent to the \"component_name\"\n        // eslint-disable-next-line camelcase\n        return new crouton_thrift.Runtime({\n            guid         : this._runtimeGUID,\n            start_micros : this._startMicros,\n            group_name   : this._componentName,\n            attrs        : thriftAttrs,\n        });\n    }\n}\n","import _each from '../_each';\n\nexport default class SpanContextImp {\n    // ---------------------------------------------------------------------- //\n    // OpenTracing Implementation\n    // ---------------------------------------------------------------------- //\n\n    setBaggageItem(key, value) {\n        this._baggage[key] = value;\n    }\n\n    getBaggageItem(key) {\n        return this._baggage[key];\n    }\n\n    toTraceId() {\n        return this._traceGUID;\n    }\n\n    toSpanId() {\n        return this._guid;\n    }\n\n    // ---------------------------------------------------------------------- //\n    // LightStep Extensions\n    // ---------------------------------------------------------------------- //\n\n    // This is part of the formal OT API in Go; and will likely be supported\n    // across platforms.\n    //\n    // https://github.com/opentracing/opentracing.github.io/issues/103\n    forEachBaggageItem(f) {\n        _each(this._baggage, (val, key) => {\n            f(key, val);\n        });\n    }\n\n    // traceGUID returns a 128 bit trace ID.\n    traceGUID() {\n        return `${this._upperTraceGUID}${this._traceGUID}`;\n    }\n\n    // ---------------------------------------------------------------------- //\n    // Private methods\n    // ---------------------------------------------------------------------- //\n\n    constructor(spanGUID, traceGUID, sampled) {\n        this._baggage = {};\n        this._guid = spanGUID;\n        this._sampled = true;\n        // Ignore undefined or null when determining truthiness.\n        if (sampled === false) {\n            this._sampled = sampled;\n        }\n        // upperTraceGUID is the most significant 8 bytes of a B3/TraceContext\n        // 16 byte trace ID. Represented in base16.\n        this._upperTraceGUID = '0000000000000000';\n        this._traceGUID = traceGUID;\n        if (this._traceGUID && this._traceGUID.length === 32) {\n            this._upperTraceGUID = traceGUID.substr(0, 16);\n            this._traceGUID = traceGUID.substr(16);\n        }\n    }\n}\n","import * as opentracing from 'opentracing';\nimport * as coerce from './coerce';\nimport * as constants from '../constants';\nimport _each from '../_each';\nimport { crouton_thrift } from '../platform_abstraction_layer'; // eslint-disable-line camelcase\nimport LogRecordImp from './log_record_imp'; // eslint-disable-line camelcase\nimport util from './util/util';\n\nexport default class SpanImp extends opentracing.Span {\n    // ---------------------------------------------------------------------- //\n    // opentracing.Span SPI\n    // ---------------------------------------------------------------------- //\n\n    _tracer() {\n        return this._tracerImp;\n    }\n\n    _context() {\n        return this._ctx;\n    }\n\n    _setOperationName(name) {\n        this._operationName = `${name}`;\n    }\n\n    _setBaggageItem(key, value) {\n        this._ctx.setBaggageItem(key, value);\n    }\n\n    _getBaggageItem(key) {\n        return this._ctx.getBaggageItem(key);\n    }\n\n    _addTags(keyValuePairs) {\n        let self = this;\n        _each(keyValuePairs, (value, key) => {\n            self._tags[key] = value;\n        });\n    }\n\n    _log(keyValuePairs, timestamp) {\n        let self = this;\n        const argumentType = typeof keyValuePairs;\n        if (argumentType !== 'object') {\n            self._tracerImp._error('Span.log() expects an object as its first argument');\n            return;\n        }\n\n        let tsMicros = timestamp\n            ? (timestamp * 1000)\n            : self._tracerImp._platform.nowMicros();\n\n        let record = new LogRecordImp(\n            self._tracerImp.getLogFieldKeyHardLimit(),\n            self._tracerImp.getLogFieldValueHardLimit(),\n            tsMicros,\n            keyValuePairs,\n        );\n        self._log_records = self._log_records || [];\n        self._log_records.push(record);\n        self._tracerImp.emit('log_added', record);\n    }\n\n    _finish(finishTime) {\n        return this.end(finishTime);\n    }\n\n    // ---------------------------------------------------------------------- //\n    // Private methods\n    // ---------------------------------------------------------------------- //\n\n    constructor(tracer, name, spanContext) {\n        super();\n\n        console.assert(typeof tracer === 'object', 'Invalid runtime'); // eslint-disable-line no-console\n\n        this._tracerImp = tracer;\n        this._ctx = spanContext;\n        this._ended  = false;\n\n        this._operationName = name;\n        this._tags          = {};\n        this._beginMicros   = tracer._platform.nowMicros();\n        this._endMicros     = 0;\n        this._errorFlag     = false;\n        this._log_records   = null;\n    }\n\n    // ---------------------------------------------------------------------- //\n    // LightStep Extensions\n    // ---------------------------------------------------------------------- //\n\n    getOperationName() {\n        return this._operationName;\n    }\n\n    // Getter only. The GUID is immutable once set internally.\n    guid() {\n        return this._ctx._guid;\n    }\n\n    traceGUID() {\n        return this._ctx._traceGUID;\n    }\n\n    parentGUID() {\n        return this._tags.parent_span_guid;\n    }\n\n    setParentGUID(guid) {\n        this._tags.parent_span_guid = coerce.toString(guid);\n        return this;\n    }\n\n    beginMicros() {\n        return this._beginMicros;\n    }\n\n    setBeginMicros(micros) {\n        this._beginMicros = micros;\n        return this;\n    }\n\n    endMicros() {\n        return this._endMicros;\n    }\n\n    setEndMicros(micros) {\n        this._endMicros = micros;\n        return this;\n    }\n\n    isSampled() {\n        return this._ctx._sampled;\n    }\n\n    /**\n     * Returns a URL to the trace containing this span.\n     *\n     * Unlike most methods, it *is* safe to call this method after `finish()`.\n     *\n     * @return {string} the absolute URL for the span\n     */\n    generateTraceURL() {\n        let micros;\n        if (this._beginMicros > 0 && this._endMicros > 0) {\n            micros = Math.floor((this._beginMicros + this._endMicros) / 2);\n        } else {\n            micros = this._tracerImp._platform.nowMicros();\n        }\n\n        let urlPrefix = constants.LIGHTSTEP_APP_URL_PREFIX;\n        let accessToken = encodeURIComponent(this._tracerImp.options().access_token);\n        let guid = encodeURIComponent(this.guid());\n        return `${urlPrefix}/${accessToken}/trace?span_guid=${guid}&at_micros=${micros}`;\n    }\n\n    getTags() {\n        return this._tags;\n    }\n\n    /**\n     * Finishes the span.\n     *\n     * @param  {Number} finishTime\n     *         Optional Unix timestamp in milliseconds setting an explicit\n     *         finish time for the span.\n     */\n    end(finishTime) {\n        // Ensure a single span is not recorded multiple times\n        if (this._ended) {\n            return;\n        }\n        this._ended = true;\n\n        if (finishTime !== undefined) {\n            this.setEndMicros(Math.floor(finishTime * 1000));\n        }\n\n        // Do not set endMicros if it has already been set. This accounts for\n        // the case of a span that has had it's times set manually (i.e. allows\n        // for retroactively created spans that might not be possible to create\n        // in real-time).\n        if (this._endMicros === 0) {\n            this.setEndMicros(this._tracerImp._platform.nowMicros());\n        }\n\n        if (util.shouldSendMetaSpan(this._tracer().options(), this.getTags())) {\n            this._tracerImp.startSpan(constants.LS_META_SP_FINISH, {\n                tags : {\n                    [constants.LS_META_EVENT_KEY] : true,\n                    [constants.LS_META_TRACE_KEY] : this.traceGUID(),\n                    [constants.LS_META_SPAN_KEY]  : this.guid(),\n                },\n            }).finish();\n        }\n\n        // Only record span if sampled\n        if (this.isSampled()) {\n            this._tracerImp._addSpanRecord(this);\n        }\n    }\n\n    _toThrift() {\n        let attributes = [];\n        _each(this._tags, (value, key) => {\n            // eslint-disable-next-line camelcase\n            attributes.push(new crouton_thrift.KeyValue({\n                Key   : coerce.toString(key),\n                Value : coerce.toString(value),\n            }));\n        });\n\n        let logs = [];\n        _each(this._log_records, (logRecord) => {\n            let logThrift = logRecord.toThrift();\n            this._tracerImp._counters['logs.keys.over_limit'] += logRecord.getNumKeysOverLimit();\n            this._tracerImp._counters['logs.values.over_limit'] += logRecord.getNumValuesOverLimit();\n            logs.push(logThrift);\n        });\n\n        // eslint-disable-next-line camelcase\n        return new crouton_thrift.SpanRecord({\n            span_guid       : this.guid(),\n            trace_guid      : this.traceGUID(),\n            runtime_guid    : this._tracerImp.guid(),\n            span_name       : this._operationName,\n            oldest_micros   : this._beginMicros,\n            youngest_micros : this._endMicros,\n            attributes      : attributes,\n            error_flag      : this._errorFlag,\n            log_records     : logs,\n        });\n    }\n}\n","//============================================================================//\n// Imports\n//============================================================================//\n\nimport EventEmitter from 'eventemitter3';\nimport * as opentracing from 'opentracing';\n\nimport SpanContextImp from './span_context_imp';\nimport SpanImp from './span_imp';\nimport _each from '../_each';\nimport { Platform, ThriftTransport } from '../platform_abstraction_layer';\nimport AuthImp from './auth_imp';\nimport RuntimeImp from './runtime_imp';\nimport ReportImp from './report_imp';\nimport UnsupportedPropagator from './propagator';\nimport LightStepPropagator from './propagator_ls';\n\nconst ClockState    = require('./util/clock_state');\nconst LogBuilder    = require('./log_builder');\nconst coerce        = require('./coerce');\nconst constants     = require('../constants');\nconst globals       = require('./globals');\nconst packageObject = require('../../package.json');\nconst util          = require('./util/util');\n\nconst DEFAULT_COLLECTOR_HOSTNAME   = 'collector.lightstep.com';\nconst DEFAULT_COLLECTOR_PORT_TLS   = 443;\nconst DEFAULT_COLLECTOR_PORT_PLAIN = 80;\nconst DEFAULT_COLLECTOR_PATH       = '';\n\n// Internal errors should be rare. Set a low limit to ensure a cascading failure\n// does not compound an existing problem by trying to send a great deal of\n// internal error data.\nconst MAX_INTERNAL_LOGS = 20;\n\nlet _singleton = null;\n\nexport default class Tracer extends opentracing.Tracer {\n    constructor(opts) {\n        super();\n\n        this._delegateEventEmitterMethods();\n\n        opts = opts || {};\n\n        if (!_singleton) {\n            globals.setOptions(opts);\n            _singleton = this;\n        }\n\n        // Platform abstraction layer\n        this._platform = new Platform(this);\n        this._runtimeGUID = opts.guid || this.override_runtime_guid || null; // Set once the group name is set\n        this._plugins = {};\n        this._options = {};\n        this._optionDescs = [];\n        this._makeOptionsTable();\n\n        this._opentracing = opentracing;\n        if (opts.opentracing_module) {\n            this._opentracing = opts.opentracing_module;\n        }\n\n        let now = this._platform.nowMicros();\n\n        // The thrift authentication and runtime struct are created as soon as\n        // the necessary initialization options are available.\n        this._startMicros = now;\n        this._auth = null;\n        this._runtime = null;\n\n        let logger = {\n            warn  : (msg, payload) => { this._warn(msg, payload); },\n            error : (err, payload) => { this._error(err, payload); },\n        };\n\n        if (opts) {\n            this._transport = opts.override_transport;\n        }\n\n        this._propagators = {};\n        this._propagators[this._opentracing.FORMAT_HTTP_HEADERS] = new LightStepPropagator(this);\n        this._propagators[this._opentracing.FORMAT_TEXT_MAP] = new LightStepPropagator(this);\n        this._propagators[this._opentracing.FORMAT_BINARY] = new UnsupportedPropagator(\n            this,\n            this._opentracing.FORMAT_BINARY,\n        );\n\n        if (opts && opts.propagators) {\n            this._propagators = { ...this._propagators, ...opts.propagators };\n        }\n\n        this._reportingLoopActive = false;\n        this._first_report_has_run = false;\n        this._reportYoungestMicros = now;\n        this._reportTimer = null;\n        this._reportErrorStreak = 0; // Number of consecutive errors\n        this._lastVisibleErrorMillis = 0;\n        this._skippedVisibleErrors = 0;\n\n        // Set addActiveRootSpan() for detail\n        this._activeRootSpanSet = {};\n        this._activeRootSpan = null;\n\n        // Span reporting buffer and per-report data\n        // These data are reset on every successful report.\n        this._spanRecords = [];\n\n        // The counter names need to match those accepted by the collector.\n        // These are internal counters only.\n        this._counters = {\n            'internal.errors'        : 0,\n            'internal.warnings'      : 0,\n            'spans.dropped'          : 0,\n            'logs.dropped'           : 0,\n            'logs.keys.over_limit'   : 0,\n            'logs.values.over_limit' : 0,\n            'reports.errors.send'    : 0,\n        };\n\n        // For internal (not client) logs reported to the collector\n        this._internalLogs = [];\n\n        // Current runtime state / status\n        this._flushIsActive = false;\n\n        // Built-in plugins\n        this.addPlugin(require('../plugins/log_to_console'));\n\n        // Initialize the platform options after the built-in plugins in\n        // case any of those options affect the built-ins.\n        this.addPlatformPlugins(opts);\n        this.setPlatformOptions(opts);\n\n        // Set constructor arguments\n        if (opts) {\n            this.options(opts);\n        }\n\n        if (typeof this._transport === 'undefined' || this._transport === null) {\n            switch (this._options.transport) {\n            case 'thrift':\n                this._transport = new ThriftTransport(logger);\n                this._info('Using thrift transport per user-defined option.');\n                break;\n            default:\n                this._transport = new ThriftTransport(logger);\n                this._info('Using thrift transport per user-defined option.');\n            }\n        }\n\n        // For clock skew adjustment.\n        // Must be set after options have been set.\n        this._useClockState = !this._options.disable_clock_skew_correction;\n        this._clockState = new ClockState({\n            nowMicros     : () => this._platform.nowMicros(),\n            localStoreGet : () => {\n                let key = `clock_state/${this._options.collector_host}`;\n                return this._platform.localStoreGet(key);\n            },\n            localStoreSet : (value) => {\n                let key = `clock_state/${this._options.collector_host}`;\n                return this._platform.localStoreSet(key, value);\n            },\n        });\n\n        // This relies on the options being set: call this last.\n        this._setupReportOnExit();\n\n        this._info(`Tracer created with guid ${this._runtimeGUID}`);\n\n        if (this._options.access_token.length === 0) {\n            this._warn(\n                `Access token not set -\n            this requires a satellite with access token checking disabled,\n            such as a developer satellite.`,\n            );\n        }\n\n        this.startPlugins();\n    }\n\n    // Morally speaking, Tracer also inherits from EventEmmiter, but we must\n    // fake it via composition.\n    //\n    // If not obvious on inspection: a hack.\n    _delegateEventEmitterMethods() {\n        let self = this;\n        this._ee = new EventEmitter();\n        // The list of methods at https://nodejs.org/api/events.html\n        _each([\n            'addListener',\n            'emit',\n            'eventNames',\n            'getMaxListeners',\n            'listenerCount',\n            'listeners',\n            'on',\n            'once',\n            'prependListener',\n            'prependOnceListener',\n            'removeAllListeners',\n            'removeListener',\n            'setMaxListeners',\n        ], (methodName) => {\n            self[methodName] = function () {\n                if (self._ee[methodName]) {\n                    // eslint-disable-next-line prefer-spread\n                    self._ee[methodName].apply(self._ee, arguments);\n                }\n            };\n        });\n    }\n\n    _makeOptionsTable() {\n        /* eslint-disable key-spacing, no-multi-spaces */\n\n        // NOTE: make 'verbosity' the first option so it is processed first on\n        // options changes and takes effect as soon as possible.\n        this.addOption('verbosity',             {\n            type : 'int', min: 0, max: 9, defaultValue: 1,\n        });\n\n        // Core options\n        this.addOption('access_token',          { type: 'string',  defaultValue: '' });\n        this.addOption('component_name',        { type: 'string',  defaultValue: '' });\n        this.addOption('collector_host',        { type: 'string',  defaultValue: DEFAULT_COLLECTOR_HOSTNAME });\n        this.addOption('collector_port',        { type: 'int',     defaultValue: DEFAULT_COLLECTOR_PORT_TLS });\n        this.addOption('collector_path',        { type: 'string',  defaultValue: DEFAULT_COLLECTOR_PATH });\n        this.addOption('collector_encryption',  { type: 'string',  defaultValue: 'tls' });\n        this.addOption('tags',                  { type: 'any',     defaultValue: {} });\n        this.addOption('max_reporting_interval_millis',  { type: 'int',     defaultValue: 2500 });\n        this.addOption('disable_clock_skew_correction', { type: 'bool', defaultValue: false });\n        this.addOption('transport',             { type: 'string', defaultValue: 'thrift' });\n\n        // Non-standard, may be deprecated\n        this.addOption('disabled',              { type: 'bool',    defaultValue: false });\n        this.addOption('max_span_records',      { type: 'int',     defaultValue: 4096 });\n        this.addOption('default_span_tags',     { type: 'any',     defaultValue: {} });\n        this.addOption('report_timeout_millis', { type: 'int',     defaultValue: 30000 });\n        this.addOption('gzip_json_requests',    { type: 'bool',    defaultValue: true });\n        this.addOption('disable_reporting_loop', { type: 'bool',    defaultValue: false });\n        this.addOption('disable_report_on_exit', { type: 'bool',    defaultValue: false });\n        this.addOption('delay_initial_report_millis', { type: 'int', defaultValue: 1000 });\n        this.addOption('error_throttle_millis', { type: 'int',     defaultValue: 60000 });\n        this.addOption('logger',                { type: 'function', defaultValue: this._printToConsole.bind(this) });\n        this.addOption(\n            'clear_span_buffer_consecutive_errors',\n            { type: 'int', defaultValue: null },\n        );\n\n        // Debugging options\n        //\n        // These are not part of the supported public API.\n        //\n        // If false, SSL certificate verification is skipped. Useful for testing.\n        this.addOption('certificate_verification',      { type: 'bool',    defaultValue: true });\n        // I.e. report only on explicit calls to flush()\n\n        // Unit testing options\n        this.addOption('override_transport',            { type : 'any',    defaultValue: null });\n        this.addOption('silent',                        { type : 'bool',   defaultValue: false });\n\n        // Hard upper limits to protect against worst-case scenarios for log field sizes.\n        this.addOption('log_field_key_hard_limit',   { type: 'int',     defaultValue: 256 });\n        this.addOption('log_field_value_hard_limit', { type: 'int',     defaultValue: 1024 });\n\n        // Meta Event reporting options\n        this.addOption('disable_meta_event_reporting', { type: 'bool', defaultValue: false });\n\n        /* eslint-disable key-spacing, no-multi-spaces */\n    }\n\n    // ---------------------------------------------------------------------- //\n    // opentracing.Tracer SPI\n    // ---------------------------------------------------------------------- //\n\n    _startSpan(name, fields) {\n        // First, assemble the SpanContextImp for our SpanImp.\n        let parentCtxImp = null;\n        fields = fields || {};\n        if (fields.references) {\n            for (let i = 0; i < fields.references.length; i++) {\n                let ref = fields.references[i];\n                let type = ref.type();\n                if (type === this._opentracing.REFERENCE_CHILD_OF\n                    || type === this._opentracing.REFERENCE_FOLLOWS_FROM) {\n                    let context = ref.referencedContext();\n                    if (!context) {\n                        this._error('Span reference has an invalid context', context);\n                        // eslint-disable-next-line no-continue\n                        continue;\n                    }\n                    parentCtxImp = context;\n                    break;\n                }\n            }\n        }\n\n        let traceGUID = parentCtxImp ? parentCtxImp.traceGUID() : this.generateTraceGUIDForRootSpan();\n        let sampled = parentCtxImp ? parentCtxImp._sampled : true;\n        let spanCtx = new SpanContextImp(this._platform.generateUUID(), traceGUID, sampled);\n        let spanImp = new SpanImp(this, name, spanCtx);\n        spanImp.addTags(this._options.default_span_tags);\n\n        _each(fields, (value, key) => {\n            switch (key) {\n            case 'references':\n                // Ignore: handled before constructing the span\n                break;\n            case 'startTime':\n                // startTime is in milliseconds\n                spanImp.setBeginMicros(Math.floor(value * 1000));\n                break;\n            case 'tags':\n                spanImp.addTags(value);\n                break;\n            default:\n                this._warn(`Ignoring unknown field '${key}'`);\n                break;\n            }\n        });\n\n        if (parentCtxImp !== null) {\n            spanImp.setParentGUID(parentCtxImp._guid);\n\n            // Copy baggage items from parent to child\n            parentCtxImp.forEachBaggageItem((k, v) => spanCtx.setBaggageItem(k, v));\n        }\n\n        this.emit('start_span', spanImp);\n\n        if (util.shouldSendMetaSpan(this.options(), spanImp.getTags())) {\n            this.startSpan(\n                constants.LS_META_SP_START,\n                {\n                    tags : {\n                        [constants.LS_META_EVENT_KEY]: true,\n                        [constants.LS_META_TRACE_KEY]: spanImp.traceGUID(),\n                        [constants.LS_META_SPAN_KEY]: spanImp.guid(),\n                    },\n                },\n            )\n                .finish();\n        }\n        return spanImp;\n    }\n\n    _inject(spanContext, format, carrier) {\n        if (this.options().meta_event_reporting === true) {\n            this.startSpan(\n                constants.LS_META_INJECT,\n                {\n                    tags: {\n                        [constants.LS_META_EVENT_KEY]: true,\n                        [constants.LS_META_TRACE_KEY]: spanContext._traceGUID,\n                        [constants.LS_META_SPAN_KEY]: spanContext._guid,\n                        [constants.LS_META_PROPAGATION_KEY]: format,\n                    },\n                },\n            )\n                .finish();\n        }\n        switch (format) {\n        case this._opentracing.FORMAT_HTTP_HEADERS:\n            this._propagators[this._opentracing.FORMAT_HTTP_HEADERS].inject(spanContext, carrier);\n            break;\n        case this._opentracing.FORMAT_TEXT_MAP:\n            this._propagators[this._opentracing.FORMAT_TEXT_MAP].inject(spanContext, carrier);\n            break;\n        case this._opentracing.FORMAT_BINARY:\n            this._propagators[this._opentracing.FORMAT_BINARY].inject(spanContext, carrier);\n            break;\n        default:\n            this._error(`Unknown format: ${format}`);\n            break;\n        }\n    }\n\n    _extract(format, carrier) {\n        let sc = null;\n        switch (format) {\n        case this._opentracing.FORMAT_HTTP_HEADERS:\n            sc = this._propagators[this._opentracing.FORMAT_HTTP_HEADERS].extract(carrier);\n            break;\n        case this._opentracing.FORMAT_TEXT_MAP:\n            sc = this._propagators[this._opentracing.FORMAT_TEXT_MAP].extract(carrier);\n            break;\n        case this._opentracing.FORMAT_BINARY:\n            sc = this._propagators[this._opentracing.FORMAT_BINARY].extract(carrier);\n            break;\n        default:\n            this._error(`Unsupported format: ${format}`);\n            return null;\n        }\n        if (this.options().meta_event_reporting === true && sc) {\n            this.startSpan(\n                constants.LS_META_EXTRACT,\n                {\n                    tags: {\n                        [constants.LS_META_EVENT_KEY]: true,\n                        [constants.LS_META_TRACE_KEY]: sc._traceGUID,\n                        [constants.LS_META_SPAN_KEY]: sc._guid,\n                        [constants.LS_META_PROPAGATION_KEY]: format,\n                    },\n                },\n            )\n                .finish();\n        }\n        return sc;\n    }\n\n    // ---------------------------------------------------------------------- //\n    // LightStep extensions\n    // ---------------------------------------------------------------------- //\n\n    /**\n     * Manually sends a report of all buffered data.\n     *\n     * @param  {Function} done - callback function invoked when the report\n     *         either succeeds or fails.\n     */\n    flush(done) {\n        if (!done) {\n            done = function () {};\n        }\n        if (this._options.disabled) {\n            this._warn('Manual flush() called in disabled state.');\n            return done(null);\n        }\n        this._flushReport(true, false, done);\n    }\n\n    //-----------------------------------------------------------------------//\n    // Options\n    //-----------------------------------------------------------------------//\n\n    guid() {\n        return this._runtimeGUID;\n    }\n\n    verbosity() {\n        // The 'undefined' handling below is for logs that may occur before the\n        // options are initialized.\n        let v = this._options.verbosity;\n        return (v === undefined) ? 1 : v;\n    }\n\n    // Call to generate a new Trace GUID\n    generateTraceGUIDForRootSpan() {\n        let guid = this._platform.generateUUID();\n        if (this._activeRootSpan) {\n            guid = this._activeRootSpan.traceGUID();\n        }\n        return guid;\n    }\n\n    setPlatformOptions(userOptions) {\n        let opts = this._platform.options(this) || {};\n        _each(userOptions, (val, key) => {\n            opts[key] = val;\n        });\n        this.options(opts);\n    }\n\n    // Register a new option.  Used by plug-ins.\n    addOption(name, desc) {\n        desc.name = name;\n        this._optionDescs.push(desc);\n        this._options[desc.name] = desc.defaultValue;\n    }\n\n    options(opts) {\n        if (arguments.length === 0) {\n            console.assert(typeof this._options === 'object',   // eslint-disable-line\n                'Internal error: _options field incorrect',\n            );\n            return this._options;\n        }\n        if (typeof opts !== 'object') {\n            throw new Error(`options() must be called with an object: type was ${typeof opts}`);\n        }\n\n        // \"collector_port\" 0 acts as an alias for \"use the default\".\n        if (opts.collector_port === 0) {\n            delete opts.collector_port;\n        }\n\n        // \"collector_encryption\" acts an alias for the common cases of 'collector_port'\n        if (opts.collector_encryption !== undefined && opts.collector_port === undefined) {\n            opts.collector_port = opts.collector_encryption !== 'none'\n                ? DEFAULT_COLLECTOR_PORT_TLS\n                : DEFAULT_COLLECTOR_PORT_PLAIN;\n        }\n        // set meta event reporting to false by default, it will be enabled by the satellite\n        this.meta_event_reporting = false;\n\n        // Track what options have been modified\n        let modified = {};\n        let unchanged = {};\n        _each(this._optionDescs, (desc) => {\n            this._setOptionInternal(modified, unchanged, opts, desc);\n        });\n\n        // Check for any invalid options: is there a key in the specified operation\n        // that didn't result either in a change or a reset to the existing value?\n        Object.keys(opts).forEach((key) => {\n            if (modified[key] === undefined && unchanged[key] === undefined) {\n                this._warn(`Invalid option ${key} with value ${opts[key]}`);\n            }\n        });\n\n        //\n        // Update the state information based on the changes\n        //\n        this._initReportingDataIfNeeded(modified);\n\n        if (!this._reportingLoopActive) {\n            this._startReportingLoop();\n        }\n\n        if (this.verbosity() >= 3) {\n            let optionsString = '';\n            let count = 0;\n            _each(modified, (val, key) => {\n                optionsString += `\\t${JSON.stringify(key)}: ${JSON.stringify(val.newValue)}\\n`;\n                count++;\n            });\n            if (count > 0) {\n                this._debug(`Options modified:\\n${optionsString}`);\n            }\n        }\n        this.emit('options', modified, this._options, this);\n    }\n\n    _setOptionInternal(modified, unchanged, opts, desc) {\n        let { name } = desc;\n        let value = opts[name];\n        let valueType = typeof value;\n        if (value === undefined) {\n            return;\n        }\n\n        // Parse the option (and check constraints)\n        switch (desc.type) {\n        case 'any':\n            break;\n\n        case 'bool':\n            if (value !== true && value !== false) {\n                this._error(`Invalid boolean option '${name}' '${value}'`);\n                return;\n            }\n            break;\n\n        case 'function':\n            if (typeof value !== 'function') {\n                this._error(`Invalid function option '${name}' '${value}'`);\n                return;\n            }\n            break;\n\n        case 'int':\n            if (valueType !== 'number' || Math.floor(value) !== value) {\n                this._error(`Invalid int option '${name}' '${value}'`);\n                return;\n            }\n            if (desc.min !== undefined && desc.max !== undefined) {\n                if (!(value >= desc.min && value <= desc.max)) {\n                    this._error(`Option '${name}' out of range '${value}' is not between ${desc.min} and ${desc.max}`);  // eslint-disable-line max-len\n                    return;\n                }\n            }\n            break;\n\n        case 'string':\n            switch (valueType) {\n            case 'string':\n                break;\n            case 'number':\n                value = coerce.toString(value);\n                break;\n            default:\n                this._error(`Invalid string option ${name} ${value}`);\n                return;\n            }\n            break;\n\n        case 'array':\n            // Per http://stackoverflow.com/questions/4775722/check-if-object-is-array\n            if (Object.prototype.toString.call(value) !== '[object Array]') {\n                this._error(`Invalid type for array option ${name}: found '${valueType}'`);\n                return;\n            }\n            break;\n\n        default:\n            this._error(`Unknown option type '${desc.type}'`);\n            return;\n        }\n\n        // Set the new value, recording any modifications\n        let oldValue = this._options[name];\n        if (oldValue === undefined) {\n            throw new Error(`Attempt to set unknown option ${name}`);\n        }\n\n        // Ignore no-op changes for types that can be checked quickly\n        if (valueType !== 'object' && oldValue === value) {\n            unchanged[name] = true;\n            return;\n        }\n\n        modified[name] = {\n            oldValue : oldValue,\n            newValue : value,\n        };\n        this._options[name] = value;\n    }\n\n    // The authorization and runtime information is initialized as soon\n    // as it is available.  This allows logs and spans to be buffered before\n    // the library is initialized, which can be helpul in a complex setup with\n    // many subsystems.\n    //\n    _initReportingDataIfNeeded(modified) {\n        // Ignore redundant initialization; complaint on inconsistencies\n        if (this._auth !== null) {\n            if (!this._runtime) {\n                return this._error('Inconsistent state: auth initialized without runtime.');\n            }\n            if (modified.access_token) {\n                throw new Error('Cannot change access_token after it has been set.');\n            }\n            if (modified.component_name) {\n                throw new Error('Cannot change component_name after it has been set.');\n            }\n            if (modified.collector_host) {\n                throw new Error('Cannot change collector_host after the connection is established');\n            }\n            if (modified.collector_port) {\n                throw new Error('Cannot change collector_port after the connection is established');\n            }\n            if (modified.collector_path) {\n                throw new Error('Cannot change collector_path after the connection is established');\n            }\n            if (modified.collector_encryption) {\n                throw new Error('Cannot change collector_encryption after the connection is established');\n            }\n            return;\n        }\n\n        this._runtimeGUID = this._platform.runtimeGUID(this._options.component_name);\n\n        this._auth = new AuthImp(this._options.access_token);\n\n        //\n        // Assemble the tracer tags from the user-specified and automatic,\n        // internal tags.\n        //\n        let tags = {};\n        _each(this._options.tags, (value, key) => {\n            if (typeof value !== 'string') {\n                this._error(`Tracer tag value is not a string: key=${key}`);\n                return;\n            }\n            tags[key] = value;\n        });\n        tags['lightstep.tracer_version'] = packageObject.version;\n        let platformTags = this._platform.tracerTags();\n        _each(platformTags, (val, key) => {\n            tags[key] = val;\n        });\n\n        this._runtime = new RuntimeImp(this._runtimeGUID, this._startMicros, this._options.component_name, tags);\n\n        this._info('Initializing reporting data', {\n            component_name : this._options.component_name,\n            access_token   : this._auth.getAccessToken(),\n        });\n        this.emit('reporting_initialized');\n    }\n\n    getLogFieldKeyHardLimit() {\n        return this._options.log_field_key_hard_limit;\n    }\n\n    getLogFieldValueHardLimit() {\n        return this._options.log_field_value_hard_limit;\n    }\n\n    //-----------------------------------------------------------------------//\n    // Plugins\n    //-----------------------------------------------------------------------//\n\n    addPlatformPlugins(opts) {\n        let pluginSet = this._platform.plugins(opts);\n        _each(pluginSet, (val) => {\n            this.addPlugin(val);\n        });\n    }\n\n    addPlugin(plugin) {\n        // Don't add plug-ins twice\n        let name = plugin.name();\n        if (this._plugins[name]) {\n            return;\n        }\n\n        this._plugins[name] = plugin;\n        plugin.addOptions(this);\n    }\n\n    startPlugins() {\n        _each(this._plugins, (val, key) => {\n            this._plugins[key].start(this);\n        });\n    }\n\n    //-----------------------------------------------------------------------//\n    // Spans\n    //-----------------------------------------------------------------------//\n\n    // This is a LightStep-specific feature that should be used sparingly. It\n    // sets a \"global\" root span such that spans that would *otherwise* be root\n    // span instead inherit the trace GUID of the active root span. This is\n    // best clarified by example:\n    //\n    // On document load in the browser, an \"active root span\" is created for\n    // the page load process. Any spans started without an explicit parent\n    // will the document load trace GUID instead of starting a trace GUID.\n    // This implicit root remains active only until the page is done loading.\n    //\n    // Any span adding itself as a root span *must* remove itself along with\n    // calling finish(). This will *not* be done automatically.\n    //\n    // NOTE: currently, only the trace GUID is transferred; it may or may not\n    // make sure to make this a proper parent.\n    //\n    // NOTE: the root span tracking is handled as a set rather than a single\n    // global to avoid conflicts between libraries.\n    addActiveRootSpan(span) {\n        this._activeRootSpanSet[span._guid] = span;\n        this._setActiveRootSpanToYoungest();\n    }\n\n    removeActiveRootSpan(span) {\n        delete this._activeRootSpanSet[span._guid];\n        this._setActiveRootSpanToYoungest();\n    }\n\n    _setActiveRootSpanToYoungest() {\n        // Set the _activeRootSpan to the youngest of the roots in case of\n        // multiple.\n        this._activeRootSpan = null;\n        _each(this._activeRootSpanSet, (span) => {\n            if (!this._activeRootSpan\n                || span._beginMicros > this._activeRootSpan._beginMicros) {\n                this._activeRootSpan = span;\n            }\n        });\n    }\n\n    //-----------------------------------------------------------------------//\n    // Encoding / decoding\n    //-----------------------------------------------------------------------//\n\n    _objectToUint8Array(obj) {\n        let jsonString;\n        try {\n            // encodeURIComponent() is a *very* inefficient, but simple and\n            // well-supported way to avoid having to think about Unicode in\n            // in the conversion to a UInt8Array.\n            //\n            // Writing multiple bytes for String.charCodeAt and\n            // String.codePointAt would be an alternate approach; again,\n            // simplicitly is being preferred over efficiency for the moment.\n            jsonString = encodeURIComponent(JSON.stringify(obj));\n        } catch (e) {\n            this._error('Could not binary encode carrier data.');\n            return null;\n        }\n\n        let buffer = new ArrayBuffer(jsonString.length);\n        let view = new Uint8Array(buffer);\n        for (let i = 0; i < jsonString.length; i++) {\n            let code = jsonString.charCodeAt(i);\n            if (!(code >= 0 && code <= 255)) {\n                this._error('Unexpected character code');\n                return null;\n            }\n            view[i] = code;\n        }\n        return view;\n    }\n\n    _uint8ArrayToObject(arr) {\n        if (!arr) {\n            this._error('Array is null');\n            return null;\n        }\n\n        let jsonString = '';\n        for (let i = 0; i < arr.length; i++) {\n            jsonString += String.fromCharCode(arr[i]);\n        }\n        try {\n            return JSON.parse(decodeURIComponent(jsonString));\n        } catch (e) {\n            this._error('Could not decode binary data.');\n            return null;\n        }\n    }\n\n    //-----------------------------------------------------------------------//\n    // Logging\n    //-----------------------------------------------------------------------//\n\n    log() {\n        let b = new LogBuilder(this);\n        return b;\n    }\n\n    //-----------------------------------------------------------------------//\n    // Buffers\n    //-----------------------------------------------------------------------//\n\n    _clearBuffers() {\n        this._spanRecords = [];\n        this._internalLogs = [];\n\n        // Create a new object to avoid overwriting the values in any references\n        // to the old object\n        let counters = {};\n        _each(this._counters, (unused, key) => {\n            counters[key] = 0;\n        });\n        this._counters = counters;\n    }\n\n    _buffersAreEmpty() {\n        if (this._spanRecords.length > 0) {\n            return false;\n        }\n        if (this._internalLogs.length > 0) {\n            return false;\n        }\n\n        let countersAllZero = true;\n        _each(this._counters, (val) => {\n            if (val > 0) {\n                countersAllZero = false;\n            }\n        });\n        return countersAllZero;\n    }\n\n    _addSpanRecord(record) {\n        this._internalAddSpanRecord(record);\n        this.emit('span_added', record);\n    }\n\n    _internalAddSpanRecord(record) {\n        if (!record) {\n            this._error('Attempt to add null record to buffer');\n            return;\n        }\n\n        if (this._spanRecords.length >= this._options.max_span_records) {\n            let index = Math.floor(this._spanRecords.length * Math.random());\n            this._spanRecords[index] = record;\n            this._counters['spans.dropped']++;\n        } else {\n            this._spanRecords.push(record);\n        }\n    }\n\n    _restoreRecords(spans, internalLogs, counters) {\n        _each(spans, (span) => {\n            this._internalAddSpanRecord(span);\n        });\n\n        let currentInternalLogs = this._internalLogs;\n        this._internalLogs = [];\n        let toAdd = internalLogs.concat(currentInternalLogs);\n        _each(toAdd, (log) => {\n            this._pushInternalLog(log);\n        });\n\n        _each(counters, (value, key) => {\n            if (key in this._counters) {\n                this._counters[key] += value;\n            } else {\n                this._error(`Bad counter name: ${key}`);\n            }\n        });\n    }\n\n    /**\n     * clearSpanRecordsIfMaxErrors checks to see if the tracer was configured to\n     * empty the span buffer after a fixed amount of errors. If it is configured,\n     * and there has been an error streak equal to the configured value,\n     * it will empty spanRecords and record that the spans were dropped.\n     *\n     * @private\n     */\n    _clearSpanRecordsIfMaxErrors() {\n        const maxErrorsToEmpty = this.options().clear_span_buffer_consecutive_errors;\n        if (maxErrorsToEmpty === null || this._reportErrorStreak < maxErrorsToEmpty) {\n            return;\n        }\n\n        // spanRecords is configured to be emptied\n        // the number of dropped spans and reporting errors should still be maintained since\n        // the loop may still in the process of a report.\n        const numSpansToDrop = this._spanRecords.length;\n        this._counters['spans.dropped'] += numSpansToDrop;\n        this._spanRecords = [];\n\n        this._warn('Span buffer flushed, max consecutive errors reached', {\n            max_consecutive_errors: maxErrorsToEmpty,\n            spans_dropped: numSpansToDrop,\n        });\n    }\n\n    //-----------------------------------------------------------------------//\n    // Reporting loop\n    //-----------------------------------------------------------------------//\n\n    _setupReportOnExit() {\n        if (this._options.disable_report_on_exit) {\n            this._debug('report-on-exit is disabled.');\n            return;\n        }\n\n        // Do a final explicit flush. Note that the final flush may enqueue\n        // asynchronous callbacks that cause the 'beforeExit' event to be\n        // re-emitted when those callbacks finish.\n        let finalFlushOnce = 0;\n        let finalFlush = () => {\n            if (finalFlushOnce++ > 0) { return; }\n            this._info('Final flush before exit.');\n            this._flushReport(false, true, (err) => {\n                if (err) {\n                    this._warn('Final report before exit failed', {\n                        error                  : err,\n                        unflushed_spans        : this._spanRecords.length,\n                        buffer_youngest_micros : this._reportYoungestMicros,\n                    });\n                }\n            });\n        };\n        this._platform.onBeforeExit(finalFlush);\n    }\n\n    _startReportingLoop() {\n        if (this._options.disabled) {\n            this._info('Not starting reporting loop: instrumentation is disabled.');\n            return;\n        }\n        if (this._options.disable_reporting_loop) {\n            this._info('Not starting reporting loop: reporting loop is disabled.');\n            return;\n        }\n        if (this._auth === null) {\n            // Don't start the loop until the thrift data necessary to do the\n            // report is set up.\n            return;\n        }\n        if (this._reportingLoopActive) {\n            this._info('Reporting loop already started!');\n            return;\n        }\n\n        this._info('Starting reporting loop:', this._runtime);\n        this._reportingLoopActive = true;\n\n        // Stop the reporting loop so the Node.js process does not become a\n        // zombie waiting for the timers.\n        let stopReportingOnce = 0;\n        let stopReporting = () => {\n            if (stopReportingOnce++ > 0) { return; }\n            this._stopReportingLoop();\n        };\n        this._platform.onBeforeExit(stopReporting);\n\n        // Begin the asynchronous reporting loop\n        let loop = () => {\n            this._enqueueNextReport((err) => {\n                if (this._reportingLoopActive) {\n                    loop();\n                }\n            });\n        };\n\n        const delay = Math.floor(Math.random() * this._options.delay_initial_report_millis);\n        util.detachedTimeout(() => {\n            loop();\n        }, delay);\n    }\n\n    _stopReportingLoop() {\n        this._debug('Stopping reporting loop');\n\n        this._reportingLoopActive = false;\n        clearTimeout(this._reportTimer);\n        this._reportTimer = null;\n    }\n\n    _enqueueNextReport(done) {\n        // If there's already a report request enqueued, ignore this new\n        // request.\n        if (this._reportTimer) {\n            return;\n        }\n\n        // If the clock state is still being primed, potentially use the\n        // shorted report interval.\n        //\n        // However, do not use the shorter interval in the case of an error.\n        // That does not provide sufficient backoff.\n        let reportInterval = this._options.max_reporting_interval_millis;\n        if (this._reportErrorStreak === 0\n            && this._useClockState\n            && !this._clockState.isReady()) {\n            reportInterval = Math.min(constants.CLOCK_STATE_REFRESH_INTERVAL_MS, reportInterval);\n        }\n\n        // After 3 consecutive errors, expand the retry delay up to 8x the\n        // normal interval, jitter the delay by +/- 25%, and be sure to back off\n        // *at least* the standard reporting interval in the case of an error.\n        let backOff = 1 + Math.min(7, Math.max(0, this._reportErrorStreak));\n        let basis = backOff * reportInterval;\n        let jitter = 1.0 + (Math.random() * 0.5 - 0.25);\n        let delay = Math.floor(Math.max(0, jitter * basis));\n\n        this._debug(`Delaying next flush for ${delay}ms`);\n        this._reportTimer = util.detachedTimeout(() => {\n            this._reportTimer = null;\n            this._flushReport(false, false, done);\n        }, delay);\n    }\n\n    /**\n     * Internal worker for a flush of buffered data into a report.\n     *\n     * @param  {bool} manual - this is a manually invoked flush request. Don't\n     *         override this call with a clock state syncing flush, for example.\n     * @param  {bool} detached - this is an \"at exit\" flush that should not block\n     *         the calling process in any manner. This is specifically called\n     *         \"detached\" due to the browser use case where the report is done,\n     *         not just asynchronously, but as a script request that continues\n     *         to run even if the page is navigated away from mid-request.\n     * @param  {function} done - standard callback function called on success\n     *         or error.\n     */\n    _flushReport(manual, detached, done) {\n        done = done || function (err) {};\n\n        let clockReady = this._clockState.isReady();\n        let clockOffsetMicros = this._clockState.offsetMicros();\n\n        // Diagnostic information on the clock correction\n        this._debug('time correction state', {\n            offset_micros  : clockOffsetMicros,\n            active_samples : this._clockState.activeSampleCount(),\n            ready          : clockReady,\n        });\n\n        let spanRecords = this._spanRecords;\n        let counters = this._counters;\n        let internalLogs = this._internalLogs;\n\n        // If the clock is not ready, do an \"empty\" flush to build more clock\n        // samples before the real data is reported.\n        // A detached flush (i.e. one intended to fire at exit or other \"last\n        // ditch effort\" event) should always use the real data.\n        if (this._useClockState && !manual && !clockReady && !detached) {\n            this._debug('Flushing empty report to prime clock state');\n            spanRecords = [];\n            counters    = {};\n            internalLogs = [];\n        } else {\n            // Early out if we can.\n            if (this._buffersAreEmpty()) {\n                this._debug('Skipping empty report');\n                return done(null);\n            }\n\n            // Clear the object buffers as the data is now in the local\n            // variables\n            this._clearBuffers();\n            this._debug(`Flushing report (${spanRecords.length} spans)`);\n        }\n\n        this._transport.ensureConnection(this._options);\n\n        // Ensure the runtime GUID is set as it is possible buffer logs and\n        // spans before the GUID is necessarily set.\n        console.assert(this._runtimeGUID !== null, 'No runtime GUID for Tracer'); // eslint-disable-line no-console\n\n        let timestampOffset = this._useClockState ? clockOffsetMicros : 0;\n        let now = this._platform.nowMicros();\n        let report = new ReportImp(\n            this._runtime,\n            this._reportYoungestMicros,\n            now,\n            spanRecords,\n            internalLogs,\n            counters,\n            timestampOffset,\n        );\n\n        this.emit('prereport', report);\n        let originMicros = this._platform.nowMicros();\n\n        if (this._options.meta_event_reporting && !this._first_report_has_run) {\n            this._first_report_has_run = true;\n            this.startSpan(constants.LS_META_TRACER_CREATE, {\n                tags: {\n                    [constants.LS_META_EVENT_KEY]: true,\n                    [constants.LS_META_TRACER_GUID_KEY]: this._runtimeGUID,\n                },\n            }).finish();\n        }\n\n        this._transport.report(detached, this._auth, report, (err, res) => {\n            let destinationMicros = this._platform.nowMicros();\n            let reportWindowSeconds = (now - report.oldest_micros) / 1e6;\n\n            if (err) {\n                // How many errors in a row? Influences the report backoff.\n                this._reportErrorStreak++;\n\n                // On a failed report, re-enqueue the data that was going to be\n                // sent.\n                let errString;\n                if (err.message) {\n                    errString = `${err.message}`;\n                } else {\n                    errString = `${err}`;\n                }\n                this._warn(`Error in report: ${errString}`, {\n                    last_report_seconds_ago : reportWindowSeconds,\n                });\n\n                this._restoreRecords(\n                    report.getSpanRecords(),\n                    report.getInternalLogs(),\n                    report.getCounters(),\n                );\n\n                // Increment the counter *after* the counters are restored\n                this._counters['reports.errors.send']++;\n\n                this._clearSpanRecordsIfMaxErrors();\n\n                this.emit('report_error', err, {\n                    error    : err,\n                    streak   : this._reportErrorStreak,\n                    detached : detached,\n                });\n            } else {\n                if (this.verbosity() >= 4) {\n                    this._debug(`Report flushed for last ${reportWindowSeconds} seconds`, {\n                        spans_reported : report.getSpanRecords().length,\n                    });\n                }\n\n                // Update internal data after the successful report\n                this._reportErrorStreak = 0;\n                this._reportYoungestMicros = now;\n\n                // Update the clock state if there's info from the report\n                if (res) {\n                    if (res.timing && res.timing.receive_micros && res.timing.transmit_micros) {\n                        // Handle thrift transport timing response.\n                        this._clockState.addSample(\n                            originMicros,\n                            res.timing.receive_micros,\n                            res.timing.transmit_micros,\n                            destinationMicros,\n                        );\n                    } else if (res.receiveTimestamp && res.transmitTimestamp) {\n                        // Handle protobuf transport timing response.\n                        this._clockState.addSample(\n                            originMicros,\n                            res.receiveTimestamp.seconds * 1e6 + res.receiveTimestamp.nanos / 1e3,\n                            res.transmitTimestamp.seconds * 1e6 + res.transmitTimestamp.nanos / 1e3,\n                            destinationMicros,\n                        );\n                    } else {\n                        // The response does not have timing information. Disable\n                        // the clock state assuming there'll never be timing data\n                        // to use.\n                        this._useClockState = false;\n                    }\n\n                    if (res.errors && res.errors.length > 0) {\n                        // Handle thrift errors.\n                        this._warn('Errors in report', res.errors);\n                    } else if (res.errorsList && res.errorsList.length > 0) {\n                        // Handle protobuf errors.\n                        this._warn('Errors in report', res.errorsList);\n                    }\n\n                    if (res.commandsList && res.commandsList.length > 0) {\n                        // Handle both thrift and protobuf commands response.\n                        if (res.commandsList[0].devMode && this.options().disable_meta_event_reporting !== true) {\n                            this.options().meta_event_reporting = true;\n                        }\n                    }\n                } else {\n                    this._useClockState = false;\n                }\n\n                this.emit('report', report, res);\n            }\n            return done(err);\n        });\n    }\n\n    //-----------------------------------------------------------------------//\n    // Stats and metrics\n    //-----------------------------------------------------------------------//\n\n    /**\n     * Internal API that returns some internal metrics.\n     */\n    stats() {\n        return {\n            counters : this._counters,\n        };\n    }\n\n    //-----------------------------------------------------------------------//\n    // Internal logging & errors\n    //-----------------------------------------------------------------------//\n    // The rules for how internal logs are processed:\n    //\n    // * Internal logs that are included in the Collector report:\n    //      - Always send errors logs along with the reports\n    //      - Never include any other logs\n    // * Internal logs that are echoed to the host application:\n    //      - See the README.md :)\n    //\n    _debug(msg, payload) {\n        if (this.verbosity() < 4) {\n            return;\n        }\n        this._options.logger('debug', msg, payload);\n    }\n\n    _info(msg, payload) {\n        if (this.verbosity() < 3) {\n            return;\n        }\n        this._options.logger('info', msg, payload);\n    }\n\n    _warn(msg, payload) {\n        this._counters['internal.warnings']++;\n\n        if (this.verbosity() < 3) {\n            return;\n        }\n        this._options.logger('warn', msg, payload);\n    }\n\n    _error(msg, payload) {\n        this._counters['internal.errors']++;\n\n        // Internal errors are always reported to the collector\n        let record = this.log()\n            .level(constants.LOG_ERROR)\n            .message(msg)\n            .payload(payload)\n            .record();\n        this._pushInternalLog(record);\n\n        // Internal errors are reported to the host console conditionally based\n        // on the verbosity level.\n        let verbosity = this.verbosity();\n        if (verbosity === 0) {\n            return;\n        }\n\n        // Error messages are throttled in verbosity === 1 mode\n        const now = Date.now();\n        if (verbosity === 1) {\n            const nextVisible = this._lastVisibleErrorMillis + this._options.error_throttle_millis;\n            if (now < nextVisible) {\n                this._skippedVisibleErrors++;\n                return;\n            }\n            if (this._skippedVisibleErrors > 0) {\n                /* eslint-disable max-len */\n                const s = `${this._skippedVisibleErrors} errors masked since last logged error. Increase 'verbosity' option to see all errors.`;\n                /* eslint-enable max-len */\n                this._options.logger('error', s, payload);\n            }\n        }\n\n        this._options.logger('error', msg, payload);\n        this._lastVisibleErrorMillis = now;\n        this._skippedVisibleErrors = 0;\n    }\n\n    _printToConsole(level, msg, payload) {\n        let method = 'log';\n        let message = `[LightStep:INFO] ${msg}`;\n        if (level === 'debug') {\n            method = 'log';\n            message = `[LightStep:DEBUG] ${msg}`;\n        } else if (level === 'info') {\n            method = 'log';\n            message = `[LightStep:INFO] ${msg}`;\n        } else if (level === 'warn') {\n            method = 'warn';\n            message = `[LightStep:WARN] ${msg}`;\n        } else if (level === 'error') {\n            method = 'error';\n            message = `[LightStep:ERROR] ${msg}`;\n        }\n\n        // Internal option to silence intentional errors generated by the unit\n        // tests.\n        if (this._options.silent) {\n            return;\n        }\n\n        if (payload !== undefined) {\n            console[method](message, payload); // eslint-disable-line no-console\n        }  else {\n            console[method](message); // eslint-disable-line no-console\n        }\n    }\n\n    _pushInternalLog(record) {\n        if (!record) {\n            return;\n        }\n        if (this._internalLogs.length >= MAX_INTERNAL_LOGS) {\n            record.message = `MAX_INTERNAL_LOGS limit hit. Last error: ${record.message}`;\n            this._internalLogs[this._internalLogs.length - 1] = record;\n        } else {\n            this._internalLogs.push(record);\n        }\n    }\n}\n","// eslint-disable-next-line import/no-import-module-exports\nimport _each from '../../_each';\n\n// How many updates before a sample is considered old. This happens to\n// be one less than the number of samples in our buffer but that's\n// somewhat arbitrary.\nconst kMaxOffsetAge = 7;\n\nconst kStoredSamplesTTLMicros = 60 * 60 * 1000 * 1000; // 1 hour\n\nclass ClockState {\n    constructor(opts) {\n        this._nowMicros     = opts.nowMicros;\n        this._localStoreGet = opts.localStoreGet;\n        this._localStoreSet = opts.localStoreSet;\n\n        // The last eight samples, computed from timing information in\n        // RPCs.\n        this._samples = [];\n        this._currentOffsetMicros = 0;\n\n        // How many updates since we've updated currentOffsetMicros.\n        this._currentOffsetAge = kMaxOffsetAge + 1;\n\n        // Try to load samples from the local store.\n        // Only use the data if it's recent.\n        let storedData = this._localStoreGet();\n        if (storedData\n            && storedData.timestamp_micros\n            && storedData.timestamp_micros > this._nowMicros() - kStoredSamplesTTLMicros) {\n            // Make sure there are no more than (kMaxOffsetAge+1) elements\n            this._samples = storedData.samples.slice(-(kMaxOffsetAge + 1));\n        }\n        // Update the current offset based on these data.\n        this.update();\n    }\n\n    // Add a new timing sample and update the offset.\n    addSample(\n        originMicros,\n        receiveMicros,\n        transmitMicros,\n        destinationMicros,\n    ) {\n        let latestDelayMicros = Number.MAX_VALUE;\n        let latestOffsetMicros = 0;\n        // Ensure that all of the data are valid before using them. If\n        // not, we'll push a {0, MAX} record into the queue.\n        if (originMicros > 0 && receiveMicros > 0\n            && transmitMicros > 0 && destinationMicros > 0) {\n            latestDelayMicros = (destinationMicros - originMicros)\n                - (transmitMicros - receiveMicros);\n            latestOffsetMicros = ((receiveMicros - originMicros)\n                           + (transmitMicros - destinationMicros)) / 2;\n        }\n\n        // Discard the oldest sample and push the new one.\n        if (this._samples.length === kMaxOffsetAge + 1) {\n            this._samples.shift();\n        }\n        this._samples.push({\n            delayMicros  : latestDelayMicros,\n            offsetMicros : latestOffsetMicros,\n        });\n        this._currentOffsetAge++;\n\n        // Update the local store with this new sample.\n        this._localStoreSet({\n            timestamp_micros : this._nowMicros(),\n            samples          : this._samples,\n        });\n        this.update();\n    }\n\n    // Update the time offset based on the current samples.\n    update() {\n        // This is simplified version of the clock filtering in Simple\n        // NTP. It ignores precision and dispersion (frequency error). In\n        // brief, it keeps the 8 (kMaxOffsetAge+1) most recent\n        // delay-offset pairs, and considers the offset with the smallest\n        // delay to be the best one. However, it only uses this new offset\n        // if the change (relative to the last offset) is small compared\n        // to the estimated error.\n        //\n        // See:\n        // https://tools.ietf.org/html/rfc5905#appendix-A.5.2\n        // http://books.google.com/books?id=pdTcJBfnbq8C\n        //   esp. section 3.5\n        // http://www.eecis.udel.edu/~mills/ntp/html/filter.html\n        // http://www.eecis.udel.edu/~mills/database/brief/algor/algor.pdf\n        // http://www.eecis.udel.edu/~mills/ntp/html/stats.html\n\n        // TODO: Consider huff-n'-puff if the delays are highly asymmetric.\n        // http://www.eecis.udel.edu/~mills/ntp/html/huffpuff.html\n\n        // Find the sample with the smallest delay; the corresponding\n        // offset is the \"best\" one.\n        let minDelayMicros = Number.MAX_VALUE;\n        let bestOffsetMicros = 0;\n        _each(this._samples, (sample) => {\n            if (sample.delayMicros < minDelayMicros) {\n                minDelayMicros = sample.delayMicros;\n                bestOffsetMicros = sample.offsetMicros;\n            }\n        });\n\n        // No update.\n        if (bestOffsetMicros === this._currentOffsetMicros) {\n            return;\n        }\n\n        // Now compute the jitter, i.e. the error relative to the new\n        // offset were we to use it.\n        let jitter = 0;\n        _each(this._samples, (sample) => {\n            // eslint-disable-next-line no-restricted-properties\n            jitter += (bestOffsetMicros - sample.offsetMicros) ** 2;\n        });\n        jitter = Math.sqrt(jitter / this._samples.length);\n\n        // Ignore spikes: only use the new offset if the change is not too\n        // large... unless the current offset is too old. The \"too old\"\n        // condition is also triggered when update() is called from the\n        // constructor.\n        const kSGATE = 3; // See RFC 5905\n        if (this._currentOffsetAge > kMaxOffsetAge\n            || Math.abs(this._currentOffsetMicros - bestOffsetMicros) < kSGATE * jitter) {\n            this._currentOffsetMicros = bestOffsetMicros;\n            this._currentOffsetAge = 0;\n        }\n    }\n\n    // Returns the difference in microseconds between the server's clock\n    // and our clock. This should be added to any local timestamps before\n    // sending them to the server. Note that a negative offset means that\n    // the local clock is ahead of the server's.\n    offsetMicros() {\n        return Math.floor(this._currentOffsetMicros);\n    }\n\n    // Returns true if we've performed enough measurements to be confident\n    // in the current offset.\n    isReady() {\n        return this._samples.length > 3;\n    }\n\n    activeSampleCount() {\n        return this._samples.length;\n    }\n}\n\nmodule.exports = ClockState;\n","const converter = require('hex2dec');\n\nclass Util {\n    // Similar to a regular setTimeout() call, but dereferences the timer so the\n    // program execution will not be held up by this timer.\n    detachedTimeout(callback, delay) {\n        let timer = setTimeout(callback, delay);\n        if (timer.unref) {\n            timer.unref();\n        }\n        return timer;\n    }\n\n    shouldSendMetaSpan(opts, tags) {\n        let shouldSendSpan = opts.meta_event_reporting === true && tags['lightstep.meta_event'] !== true;\n        return shouldSendSpan;\n    }\n\n    // Use native BigInt if available. Native BigInt has a significant\n    // performance improvement over hex2dec\n    hexToDec(hexString) {\n        if (typeof global.BigInt !== 'function') {\n            return converter.hexToDec(hexString);\n        }\n\n        // eslint-ignore-line\n        return global.BigInt(`0x${hexString}`).toString(10);\n    }\n}\n\nexport default new Util();\n","/* eslint-disable import/no-import-module-exports */\nimport Tracer from './imp/tracer_imp';\nimport LightStepPropagator from './imp/propagator_ls';\nimport B3Propagator from './imp/propagator_b3';\nimport DDPropagator from './imp/propagator_dd';\nimport SpanContext from './imp/span_context_imp';\nimport { Platform } from './platform_abstraction_layer';\n\nconst library = {\n    Tracer              : Tracer,\n    LightStepPropagator : LightStepPropagator,\n    B3Propagator        : B3Propagator,\n    DDPropagator        : DDPropagator,\n    SpanContext         : SpanContext,\n};\n\nPlatform.initLibrary(library);\nmodule.exports = library;\n","/* eslint-disable import/extensions */\n/* global PLATFORM_BROWSER */\n\n// Hide the differences in how the Thrift compiler generates code for the\n// different platforms as well as expose a Platform class to abstract a few\n// general differences in the platforms.\nif ((typeof PLATFORM_BROWSER !== 'undefined') && PLATFORM_BROWSER) {\n    module.exports = {\n        Platform        : require('./imp/platform/browser/platform_browser.js'),\n        ThriftTransport : require('./imp/platform/browser/transport_httpthrift.js'),\n        thrift          : require('./imp/platform/browser/thrift.js'),\n        crouton_thrift  : require('./imp/platform/browser/crouton_thrift.js'),\n    };\n} else {\n    module.exports = {\n        Platform        : require('./imp/platform/node/platform_node.js'),\n        ThriftTransport : require('./imp/platform/node/transport_httpthrift.js'),\n        // Note: THRIFT-5029 requires us to use a non-standard require\n        // TODO: remove non-standard require after https://github.com/apache/thrift/pull/1947 merges\n        thrift          : require('thrift/lib/nodejs/lib/thrift'),\n        crouton_thrift  : require('./imp/platform/node/crouton_thrift.js'),\n    };\n}\n","// eslint-disable-next-line import/no-import-module-exports\nimport _each from '../_each';\n\nclass InstrumentPageLoad {\n    constructor() {\n        this._inited = false;\n        this._span = null;\n    }\n\n    name() {\n        return 'instrument_page_load';\n    }\n\n    addOptions(tracerImp) {\n        tracerImp.addOption('instrument_page_load', { type : 'bool', defaultValue : false });\n    }\n\n    start(tracerImp) {\n        if (this._inited) {\n            return;\n        }\n        this._inited = true;\n\n        if (typeof window !== 'object' || typeof document !== 'object') {\n            return;\n        }\n\n        const currentOptions = tracerImp.options();\n        if (currentOptions.instrument_page_load) {\n            this._ensureSpanStarted(tracerImp);\n            document.addEventListener('readystatechange', this._handleReadyStateChange.bind(this));\n        }\n    }\n\n    stop() {\n    }\n\n    _ensureSpanStarted(tracerImp) {\n        if (!this._span) {\n            this._span = tracerImp.startSpan('document/load');\n            tracerImp.addActiveRootSpan(this._span);\n        }\n    }\n\n    _handleReadyStateChange() {\n        if (!this._span) {\n            return;\n        }\n\n        let span = this._span;\n        let state = document.readyState;\n        let payload;\n        if (state === 'complete') {\n            payload = {};\n            if (window.performance && performance.timing) {\n                this._addTimingSpans(span, performance.timing);\n                payload['window.performance.timing'] = performance.timing;\n            }\n        }\n\n        span.logEvent(`document.readystatechange ${state}`, payload);\n\n        if (state === 'complete') {\n            if (span.tracer()) {\n                span.tracer().removeActiveRootSpan(span.tracer());\n            }\n            span.finish();\n        }\n    }\n\n    _copyNavigatorProperties(nav) {\n        let dst = {};\n        for (let key in nav) { // eslint-disable-line guard-for-in, no-restricted-syntax\n            try {\n                let value = nav[key];\n                switch (key) {\n                case 'plugins': {\n                    let p = [];\n                    for (let i = 0; i < value.length; i++) {\n                        let item = value.item(i);\n                        p.push({\n                            name        : item.name,\n                            description : item.description,\n                        });\n                    }\n                    dst[key] = p;\n                } break;\n\n                case 'mimeTypes': {\n                    let p = [];\n                    for (let i = 0; i < value.length; i++) {\n                        let item = value.item(i);\n                        p.push({\n                            type        : item.type,\n                            description : item.description,\n                            suffixes    : item.suffixes,\n                        });\n                    }\n                    dst[key] = p;\n                } break;\n\n                default:\n                    dst[key] = value;\n                    break;\n                }\n            } catch (e) {\n                // Skip, just in case\n            }\n        }\n        return dst;\n    }\n\n    // Retroactively create the appropriate spans and logs\n    _addTimingSpans(parentImp, timing) {\n        // NOTE: this currently relies on LightStep-specific APIs\n        if (!parentImp) {\n            return;\n        }\n\n        parentImp.setTag('user_agent', navigator.userAgent);\n\n        _each(timing, (value, key) => {\n            // e.g. secureConnectionStart is not always set\n            if (typeof value !== 'number' || value === 0) {\n                return;\n            }\n\n            let payload;\n\n            if (key === 'navigationStart' && typeof navigator === 'object') {\n                payload = {\n                    navigator : this._copyNavigatorProperties(navigator),\n                };\n            }\n            parentImp.log({\n                message : `document ${key}`,\n                payload : payload,\n            }, value);\n        });\n\n        parentImp.setBeginMicros(timing.navigationStart * 1000.0);\n\n        parentImp.tracer().startSpan('document/time_to_first_byte', { childOf : parentImp })\n            .setBeginMicros(timing.requestStart * 1000.0)\n            .setEndMicros(timing.responseStart * 1000.0)\n            .finish();\n        parentImp.tracer()\n            .startSpan('document/response_transfer', { childOf : parentImp })\n            .setBeginMicros(timing.responseStart * 1000.0)\n            .setEndMicros(timing.responseEnd * 1000.0)\n            .finish();\n        parentImp.tracer().startSpan('document/dom_load', { childOf : parentImp })\n            .setBeginMicros(timing.domLoading * 1000.0)\n            .setEndMicros(timing.domInteractive * 1000.0)\n            .finish();\n    }\n}\n\nmodule.exports = new InstrumentPageLoad();\n","// eslint-disable-next-line import/no-import-module-exports\nimport * as opentracing from 'opentracing';\n\n// Capture the proxied values on script load (i.e. ASAP) in case there are\n// multiple layers of instrumentation.\nlet proxiedFetch;\nif (typeof window === 'object' && typeof window.fetch !== 'undefined') {\n    proxiedFetch = window.fetch;\n}\n\nfunction getCookies() {\n    if (typeof document === 'undefined' || !document.cookie) {\n        return null;\n    }\n    let cookies = document.cookie.split(';');\n    let data = {};\n    let count = 0;\n    for (let i = 0; i < cookies.length; i++) {\n        let parts = cookies[i].split('=', 2);\n        if (parts.length === 2) {\n            let key = parts[0].replace(/^\\s+/, '').replace(/\\s+$/, '');\n            data[key] = decodeURIComponent(parts[1]);\n            try {\n                data[key] = JSON.parse(data[key]);\n            } catch (_ignored) { /* Ignored */ }\n            count++;\n        }\n    }\n    if (count > 0) {\n        return data;\n    }\n    return null;\n}\n\n// Normalize the getAllResponseHeaders output\nfunction getResponseHeaders(response) {\n    const result = {};\n    const entries = response.headers.entries();\n    for (let i = 0; i < entries.length; i++) {\n        const pair = entries[i];\n        const [key, val] = pair;\n        result[key] = val;\n    }\n    return result;\n}\n\n// Automatically create spans for all requests made via window.fetch.\n//\n// NOTE: this code currently works only with a single Tracer.\n//\nclass InstrumentFetch {\n    constructor() {\n        this._enabled = this._isValidContext();\n        this._proxyInited = false;\n        this._internalExclusions = [];\n        this._tracer = null;\n        this._handleOptions = this._handleOptions.bind(this);\n    }\n\n    name() {\n        return 'instrument_fetch';\n    }\n\n    addOptions(tracerImp) {\n        tracerImp.addOption('fetch_instrumentation', { type : 'bool', defaultValue : false });\n        tracerImp.addOption('fetch_url_inclusion_patterns', { type : 'array', defaultValue : [/.*/] });\n        tracerImp.addOption('fetch_url_exclusion_patterns', { type : 'array', defaultValue : [] });\n        tracerImp.addOption('fetch_url_header_inclusion_patterns', { type : 'array', defaultValue : [/.*/] });\n        tracerImp.addOption('fetch_url_header_exclusion_patterns', { type : 'array', defaultValue : [] });\n        tracerImp.addOption('include_cookies', { type : 'bool', defaultValue : true });\n    }\n\n    start(tracerImp) {\n        if (!this._enabled) {\n            return;\n        }\n        this._tracer = tracerImp;\n\n        let currentOptions = tracerImp.options();\n        this._addServiceHostToExclusions(currentOptions);\n        this._handleOptions({}, currentOptions);\n        tracerImp.on('options', this._handleOptions);\n    }\n\n    stop() {\n        if (!this._enabled) {\n            return;\n        }\n        window.fetch = proxiedFetch;\n    }\n\n    /**\n     * Respond to options changes on the Tracer.\n     *\n     * Note that `modified` is the options that have changed in this call,\n     * along with their previous and new values. `current` is the full set of\n     * current options *including* the newly modified values.\n     */\n    _handleOptions(modified, current) {\n        // Automatically add the service host itself to the list of exclusions\n        // to avoid reporting on the reports themselves\n        let serviceHost = modified.collector_host;\n        if (serviceHost) {\n            this._addServiceHostToExclusions(current);\n        }\n\n        // Set up the proxied fetch calls unless disabled\n        if (!this._proxyInited && current.fetch_instrumentation) {\n            this._proxyInited = true;\n            window.fetch = this._instrumentFetch();\n        }\n    }\n\n    /**\n     * Ensure that the reports to the collector don't get instrumented as well,\n     * as that recursive instrumentation is more confusing than valuable!\n     */\n    _addServiceHostToExclusions(opts) {\n        if (opts.collector_host.length === 0) {\n            return;\n        }\n\n        // http://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex\n        function escapeRegExp(str) {\n            return (`${str}`).replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n        }\n\n        // Check against the hostname without the port as well as the canonicalized\n        // URL may drop the standard port.\n        let host = escapeRegExp(opts.collector_host);\n        let port = escapeRegExp(opts.collector_port);\n        let set = [new RegExp(`^https?://${host}:${port}`)];\n        if (port === '80') {\n            set.push(new RegExp(`^http://${host}`));\n        } else if (port === '443') {\n            set.push(new RegExp(`^https://${host}`));\n        }\n        this._internalExclusions = set;\n    }\n\n    /**\n     * Check preconditions for the auto-instrumentation of fetch to work properly.\n     * There are a lot of potential JavaScript platforms.\n     */\n    _isValidContext() {\n        if (typeof window === 'undefined') {\n            return false;\n        }\n        if (!window.fetch) {\n            return false;\n        }\n        return true;\n    }\n\n    _instrumentFetch() {\n        let self = this;\n        let tracer = this._tracer;\n\n        return function (input, init) {\n            const request = new Request(input, init);\n            const opts = tracer.options();\n\n            if (!self._shouldTrace(tracer, request.url)) {\n                // eslint-disable-next-line prefer-spread\n                return proxiedFetch(request);\n            }\n\n            let span = tracer.startSpan('fetch');\n            tracer.addActiveRootSpan(span);\n\n            const parsed = new URL(request.url);\n            let tags = {\n                method : request.method,\n                url    : request.url,\n\n                // NOTE: Purposefully excluding username:password from tags.\n                // TODO: consider sanitizing URL to mask / remove that information from the trace in general\n                hash     : parsed.hash,\n                href     : parsed.href,\n                protocol : parsed.protocol,\n                origin   : parsed.origin,\n                host     : parsed.host,\n                hostname : parsed.hostname,\n                port     : parsed.port,\n                pathname : parsed.pathname,\n                search   : parsed.search,\n            };\n            if (opts.include_cookies) {\n                tags.cookies = getCookies();\n            }\n\n            // Add Open-Tracing headers\n            if (self._shouldAddHeadersToRequest(tracer, request.url)) {\n                const headersCarrier = {};\n                tracer.inject(span.context(), opentracing.FORMAT_HTTP_HEADERS, headersCarrier);\n                Object.keys(headersCarrier).forEach((key) => {\n                    if (!request.headers.get(key)) request.headers.set(key, headersCarrier[key]);\n                });\n            }\n            span.log({\n                event       : 'sending',\n                method      : request.method,\n                url         : request.url,\n                openPayload : tags,\n            });\n            span.addTags(tags);\n\n            return proxiedFetch(request).then((response) => {\n                if (!response.ok) {\n                    span.addTags({ error : true });\n                }\n                span.log({\n                    method       : request.method,\n                    headers      : getResponseHeaders(response),\n                    status       : response.status,\n                    statusText   : response.statusText,\n                    responseType : response.type,\n                    url          : response.url,\n                });\n                tracer.removeActiveRootSpan(span);\n                span.finish();\n                return response;\n            }).catch((e) => {\n                span.addTags({ error : true });\n                tracer.removeActiveRootSpan(span);\n                span.log({\n                    event : 'error',\n                    error : e,\n                });\n                span.finish();\n                throw e;\n            });\n        };\n    }\n\n    _shouldTrace(tracer, url) {\n        // This shouldn't be possible, but let's be paranoid\n        if (!tracer || !url) {\n            return false;\n        }\n\n        let opts = tracer.options();\n        if (opts.disabled) {\n            return false;\n        }\n\n        if (this._internalExclusions.some((ex) => ex.test(url))) {\n            return false;\n        }\n\n        if (opts.fetch_url_exclusion_patterns.some((ex) => ex.test(url))) {\n            return false;\n        }\n        if (opts.fetch_url_inclusion_patterns.some((inc) => inc.test(url))) {\n            return true;\n        }\n        return false;\n    }\n\n    _shouldAddHeadersToRequest(tracer, url) {\n        // This shouldn't be possible, but let's be paranoid\n        if (!tracer || !url) {\n            return false;\n        }\n\n        let opts = tracer.options();\n        if (opts.disabled) {\n            return false;\n        }\n\n        if (opts.fetch_url_header_exclusion_patterns.some((ex) => ex.test(url))) {\n            return false;\n        }\n        if (opts.fetch_url_header_inclusion_patterns.some((inc) => inc.test(url))) {\n            return true;\n        }\n        return false;\n    }\n}\n\nmodule.exports = new InstrumentFetch();\n","// eslint-disable-next-line import/no-import-module-exports\nimport * as opentracing from 'opentracing';\n\n// Capture the proxied values on script load (i.e. ASAP) in case there are\n// multiple layers of instrumentation.\nlet proxied = {};\nif (typeof window === 'object' && typeof window.XMLHttpRequest !== 'undefined') {\n    proxied = {\n        XMLHttpRequest   : XMLHttpRequest,\n        open             : XMLHttpRequest.prototype.open,\n        send             : XMLHttpRequest.prototype.send,\n        setRequestHeader : XMLHttpRequest.prototype.setRequestHeader,\n    };\n}\n\nfunction getCookies() {\n    if (typeof document === 'undefined' || !document.cookie) {\n        return null;\n    }\n    let cookies = document.cookie.split(';');\n    let data = {};\n    let count = 0;\n    for (let i = 0; i < cookies.length; i++) {\n        let parts = cookies[i].split('=', 2);\n        if (parts.length === 2) {\n            let key = parts[0].replace(/^\\s+/, '').replace(/\\s+$/, '');\n            data[key] = decodeURIComponent(parts[1]);\n            try {\n                data[key] = JSON.parse(data[key]);\n            } catch (_ignored) { /* Ignored */ }\n            count++;\n        }\n    }\n    if (count > 0) {\n        return data;\n    }\n    return null;\n}\n\n// Normalize the getAllResponseHeaders output\nfunction getResponseHeaders(xhr) {\n    let raw = xhr.getAllResponseHeaders();\n    let parts = raw.replace(/\\s+$/, '').split(/\\n/);\n    for (let i = 0; i < parts.length; i++) {\n        parts[i] = parts[i].replace(/\\r/g, '').replace(/^\\s+/, '').replace(/\\s+$/, '');\n    }\n    return parts;\n}\n\n// Automatically create spans for all XMLHttpRequest objects.\n//\n// NOTE: this code currently works only with a single Tracer.\n//\nclass InstrumentXHR {\n    constructor() {\n        this._enabled = this._isValidContext();\n        this._proxyInited = false;\n        this._internalExclusions = [];\n        this._tracer = null;\n        this._handleOptions = this._handleOptions.bind(this);\n    }\n\n    name() {\n        return 'instrument_xhr';\n    }\n\n    addOptions(tracerImp) {\n        tracerImp.addOption('xhr_instrumentation', { type : 'bool', defaultValue : false });\n        tracerImp.addOption('xhr_url_inclusion_patterns', { type : 'array', defaultValue : [/.*/] });\n        tracerImp.addOption('xhr_url_exclusion_patterns', { type : 'array', defaultValue : [] });\n        tracerImp.addOption('xhr_url_header_inclusion_patterns', { type : 'array', defaultValue : [/.*/] });\n        tracerImp.addOption('xhr_url_header_exclusion_patterns', { type : 'array', defaultValue : [] });\n        tracerImp.addOption('include_cookies', { type : 'bool', defaultValue : true });\n    }\n\n    start(tracerImp) {\n        if (!this._enabled) {\n            return;\n        }\n        this._tracer = tracerImp;\n\n        let currentOptions = tracerImp.options();\n        this._addServiceHostToExclusions(currentOptions);\n        this._handleOptions({}, currentOptions);\n        tracerImp.on('options', this._handleOptions);\n    }\n\n    stop() {\n        if (!this._enabled) {\n            return;\n        }\n        let proto = proxied.XMLHttpRequest.prototype;\n        proto.open = proxied.open;\n        proto.send = proxied.send;\n    }\n\n    /**\n     * Respond to options changes on the Tracer.\n     *\n     * Note that `modified` is the options that have changed in this call,\n     * along with their previous and new values. `current` is the full set of\n     * current options *including* the newly modified values.\n     */\n    _handleOptions(modified, current) {\n        // Automatically add the service host itself to the list of exclusions\n        // to avoid reporting on the reports themselves\n        let serviceHost = modified.collector_host;\n        if (serviceHost) {\n            this._addServiceHostToExclusions(current);\n        }\n\n        // Set up the proxied XHR calls unless disabled\n        if (!this._proxyInited && current.xhr_instrumentation) {\n            this._proxyInited = true;\n            let proto = proxied.XMLHttpRequest.prototype;\n            proto.setRequestHeader = this._instrumentSetRequestHeader();\n            proto.open = this._instrumentOpen();\n            proto.send = this._instrumentSend();\n        }\n    }\n\n    /**\n     * Ensure that the reports to the collector don't get instrumented as well,\n     * as that recursive instrumentation is more confusing than valuable!\n     */\n    _addServiceHostToExclusions(opts) {\n        if (opts.collector_host.length === 0) {\n            return;\n        }\n\n        // http://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex\n        function escapeRegExp(str) {\n            return (`${str}`).replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n        }\n\n        // Check against the hostname without the port as well as the canonicalized\n        // URL may drop the standard port.\n        let host = escapeRegExp(opts.collector_host);\n        let port = escapeRegExp(opts.collector_port);\n        let set = [new RegExp(`^https?://${host}:${port}`)];\n        if (port === '80') {\n            set.push(new RegExp(`^http://${host}`));\n        } else if (port === '443') {\n            set.push(new RegExp(`^https://${host}`));\n        }\n        this._internalExclusions = set;\n    }\n\n    /**\n     * Check preconditions for the auto-instrumentation of XHRs to work properly.\n     * There are a lot of potential JavaScript platforms.\n     */\n    _isValidContext() {\n        if (typeof window === 'undefined') {\n            return false;\n        }\n        if (!window.XMLHttpRequest) {\n            return false;\n        }\n        if (!window.XMLHttpRequest.prototype) {\n            return false;\n        }\n        return true;\n    }\n\n    _instrumentSetRequestHeader() {\n        return function (header, value) {\n            this.__requestHeaders = this.__requestHeaders || {};\n            this.__requestHeaders[header] = value;\n            return proxied.setRequestHeader.apply(this, arguments);\n        };\n    }\n\n    _instrumentOpen() {\n        let self = this;\n        let tracer = this._tracer;\n\n        return function (method, url, asyncArg, user, password) {\n            if (!self._shouldTrace(tracer, this, url)) {\n                return proxied.open.apply(this, arguments);\n            }\n            const opts = tracer.options();\n\n            let span = tracer.startSpan('XMLHttpRequest');\n            tracer.addActiveRootSpan(span);\n            this.__tracer_span = span;\n            this.__tracer_url = url;\n\n            let tags = {\n                method : method,\n                url    : url,\n                async  : asyncArg,\n                user   : user,\n            };\n            if (url) {\n                // eslint-disable-next-line prefer-destructuring\n                tags.url_pathname = url.split('?')[0];\n            }\n\n            let openPayload = { ...tags };\n            if (opts.include_cookies) {\n                openPayload.cookies = getCookies();\n            }\n\n            // Note: async defaults to true\n            let async = (asyncArg === undefined ? true : asyncArg);\n            if (async) {\n                this.addEventListener('readystatechange', function () {\n                    if (this.readyState === 0) {\n                        span.log({\n                            readyState : 0,\n                            event      : 'unsent',\n                        });\n                    } else if (this.readyState === 1) {\n                        span.log({\n                            readyState : 1,\n                            event      : 'sending',\n                        });\n                    } else if (this.readyState === 2) {\n                        span.log({\n                            readyState  : 2,\n                            event       : 'headers received',\n                            method      : method,\n                            url         : url,\n                            openPayload : openPayload,\n                            headers     : getResponseHeaders(this),\n                        });\n                        span.addTags(tags);\n                    } else if (this.readyState === 3) {\n                        span.log({\n                            readyState : 3,\n                            event      : 'loading',\n                        });\n                    } else if (this.readyState === 4) {\n                        let { responseType } = this;\n                        span.log({\n                            readyState   : 4,\n                            url          : url,\n                            method       : method,\n                            headers      : getResponseHeaders(this),\n                            status       : this.status,\n                            statusText   : this.statusText,\n                            responseType : responseType,\n                        });\n                        tracer.removeActiveRootSpan(span);\n                        span.finish();\n                    } else {\n                        span.log({\n                            readyState : this.readyState,\n                        });\n                    }\n                });\n            }\n\n            let result = proxied.open.apply(this, arguments);\n            if (!async) {\n                tracer.removeActiveRootSpan(span);\n                span.finish();\n            }\n            return result;\n        };\n    }\n\n    _instrumentSend() {\n        let self = this;\n        let tracer = this._tracer;\n        return function () {\n            if (!self._shouldTrace(tracer, this, this.__tracer_url)) {\n                return proxied.send.apply(this, arguments);\n            }\n\n            let span = this.__tracer_span;\n            if (!span) {\n                return proxied.send.apply(this, arguments);\n            }\n\n            let data = Array.prototype.slice.call(arguments);\n            let len;\n            if (data.length === 1) {\n                if (data[0] && data[0].length) {\n                    len = data[0].length;\n                }\n                try {\n                    data = JSON.parse(data[0]);\n                } catch (e) {\n                    // Ignore the error\n                }\n            }\n            let lenStr = (len === undefined) ? '' : `, data length=${len}`;\n            span.log({\n                event       : 'send',\n                data_length : lenStr,\n            });\n\n            // Add Open-Tracing headers\n            if (self._shouldAddHeadersToRequest(tracer, this.__tracer_url)) {\n                const headersCarrier = {};\n                tracer.inject(span.context(), opentracing.FORMAT_HTTP_HEADERS, headersCarrier);\n                const keys = Object.keys(headersCarrier);\n                keys.forEach((key) => {\n                    proxied.setRequestHeader.call(this, key, headersCarrier[key]);\n                });\n            }\n\n            return proxied.send.apply(this, arguments);\n        };\n    }\n\n    _shouldTrace(tracer, xhr, url) {\n        // This shouldn't be possible, but let's be paranoid\n        if (!tracer || !url) {\n            return false;\n        }\n\n        let opts = tracer.options();\n        if (opts.disabled) {\n            return false;\n        }\n\n        if (this._internalExclusions.some((ex) => ex.test(url))) {\n            return false;\n        }\n\n        if (opts.xhr_url_exclusion_patterns.some((ex) => ex.test(url))) {\n            return false;\n        }\n        if (opts.xhr_url_inclusion_patterns.some((inc) => inc.test(url))) {\n            return true;\n        }\n        return false;\n    }\n\n    _shouldAddHeadersToRequest(tracer, url) {\n        // This shouldn't be possible, but let's be paranoid\n        if (!tracer || !url) {\n            return false;\n        }\n\n        let opts = tracer.options();\n        if (opts.disabled) {\n            return false;\n        }\n\n        if (opts.xhr_url_header_exclusion_patterns.some((ex) => ex.test(url))) {\n            return false;\n        }\n        if (opts.xhr_url_header_inclusion_patterns.some((inc) => inc.test(url))) {\n            return true;\n        }\n        return false;\n    }\n}\n\nmodule.exports = new InstrumentXHR();\n","const constants = require('../constants');\n\nclass LogToConsole {\n    constructor() {\n        this._enabled = false;\n        this._tracer = null;\n        this._optionsCb = this._handleOptions.bind(this);\n        this._logAddedCb = this._handleLogAdded.bind(this);\n    }\n\n    name() {\n        return 'log_to_console';\n    }\n\n    addOptions(tracerImp) {\n        tracerImp.addOption('log_to_console', {\n            type         : 'bool',\n            defaultValue : false,\n        });\n        tracerImp.on('options', this._optionsCb);\n    }\n\n    start(tracer, tracerImp) {\n        this._tracer = tracer;\n    }\n\n    stop() {\n        this._tracer.removeListener('options', this._optionsCb);\n    }\n\n    _handleOptions(modified, current, tracerImp) {\n        let enabled = current.log_to_console;\n        if (this._enabled === enabled) {\n            return;\n        }\n        this._enabled = enabled;\n        if (this._enabled) {\n            tracerImp.on('log_added', this._logAddedCb);\n        } else {\n            tracerImp.removeListener('log_added', this._logAddedCb);\n        }\n    }\n\n    _handleLogAdded(record) {\n        let level = constants.LOG_STRING_TO_LEVEL[record.level];\n        let { message } = record;\n\n        // Ignore records without a message (e.g. a stable_name log record)\n        if (!message) {\n            return;\n        }\n\n        let payload = record.payload_json;\n        if (payload) {\n            try {\n                payload = JSON.parse(payload);\n            } catch (_ignored) { /* ignored */ }\n        }\n\n        switch (level) {\n        case constants.LOG_ERROR:\n        case constants.LOG_FATAL:\n            if (payload !== undefined) {\n                console.error(message, payload); // eslint-disable-line no-console\n            } else {\n                console.error(message); // eslint-disable-line no-console\n            }\n            break;\n        case constants.LOG_WARN:\n            if (payload !== undefined) {\n                console.warn(message, payload); // eslint-disable-line no-console\n            } else {\n                console.warn(message); // eslint-disable-line no-console\n            }\n            break;\n        case constants.LOG_INFO:\n        default:\n            if (payload !== undefined) {\n                console.log(message, payload); // eslint-disable-line no-console\n            } else {\n                console.log(message); // eslint-disable-line no-console\n            }\n            break;\n        }\n    }\n}\n\nmodule.exports = new LogToConsole();\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/**\n * A function for converting hex <-> dec w/o loss of precision.\n *\n * The problem is that parseInt(\"0x12345...\") isn't precise enough to convert\n * 64-bit integers correctly.\n *\n * Internally, this uses arrays to encode decimal digits starting with the least\n * significant:\n * 8 = [8]\n * 16 = [6, 1]\n * 1024 = [4, 2, 0, 1]\n *\n * Source: http://www.danvk.org/hex2dec.html\n */\n\n// Adds two arrays for the given base (10 or 16), returning the result.\n// This turns out to be the only \"primitive\" operation we need.\nfunction add(x, y, base) {\n  var z = [];\n  var n = Math.max(x.length, y.length);\n  var carry = 0;\n  var i = 0;\n  while (i < n || carry) {\n    var xi = i < x.length ? x[i] : 0;\n    var yi = i < y.length ? y[i] : 0;\n    var zi = carry + xi + yi;\n    z.push(zi % base);\n    carry = Math.floor(zi / base);\n    i++;\n  }\n  return z;\n}\n\n// Returns a*x, where x is an array of decimal digits and a is an ordinary\n// JavaScript number. base is the number base of the array x.\nfunction multiplyByNumber(num, x, base) {\n  if (num < 0) return null;\n  if (num == 0) return [];\n\n  var result = [];\n  var power = x;\n  while (true) {\n    if (num & 1) {\n      result = add(result, power, base);\n    }\n    num = num >> 1;\n    if (num === 0) break;\n    power = add(power, power, base);\n  }\n\n  return result;\n}\n\nfunction parseToDigitsArray(str, base) {\n  var digits = str.split('');\n  var ary = [];\n  for (var i = digits.length - 1; i >= 0; i--) {\n    var n = parseInt(digits[i], base);\n    if (isNaN(n)) return null;\n    ary.push(n);\n  }\n  return ary;\n}\n\nfunction convertBase(str, fromBase, toBase) {\n  var digits = parseToDigitsArray(str, fromBase);\n  if (digits === null) return null;\n\n  var outArray = [];\n  var power = [1];\n  for (var i = 0; i < digits.length; i++) {\n    // invariant: at this point, fromBase^i = power\n    if (digits[i]) {\n      outArray = add(outArray, multiplyByNumber(digits[i], power, toBase), toBase);\n    }\n    power = multiplyByNumber(fromBase, power, toBase);\n  }\n\n  var out = '';\n  for (var i = outArray.length - 1; i >= 0; i--) {\n    out += outArray[i].toString(toBase);\n  }\n  if (out === '') {\n    out = '0';\n  }\n  return out;\n}\n\nfunction decToHex(decStr, opts) {\n  var hidePrefix = opts && opts.prefix === false;\n  var hex = convertBase(decStr, 10, 16);\n  return hex ? (hidePrefix ? hex : '0x' + hex) : null;\n}\n\nfunction hexToDec(hexStr) {\n  if (hexStr.substring(0, 2) === '0x') hexStr = hexStr.substring(2);\n  hexStr = hexStr.toLowerCase();\n  return convertBase(hexStr, 16, 10);\n}\n\nmodule.exports = {\n  hexToDec: hexToDec,\n  decToHex: decToHex\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Convenience class to use as a binary carrier.\n *\n * Any valid Object with a field named `buffer` may be used as a binary carrier;\n * this class is only one such type of object that can be used.\n */\nvar BinaryCarrier = /** @class */ (function () {\n    function BinaryCarrier(buffer) {\n        this.buffer = buffer;\n    }\n    return BinaryCarrier;\n}());\nexports.default = BinaryCarrier;\n//# sourceMappingURL=binary_carrier.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * The FORMAT_BINARY format represents SpanContexts in an opaque binary\n * carrier.\n *\n * Tracer.inject() will set the buffer field to an Array-like (Array,\n * ArrayBuffer, or TypedBuffer) object containing the injected binary data.\n * Any valid Object can be used as long as the buffer field of the object\n * can be set.\n *\n * Tracer.extract() will look for `carrier.buffer`, and that field is\n * expected to be an Array-like object (Array, ArrayBuffer, or\n * TypedBuffer).\n */\nexports.FORMAT_BINARY = 'binary';\n/**\n * The FORMAT_TEXT_MAP format represents SpanContexts using a\n * string->string map (backed by a Javascript Object) as a carrier.\n *\n * NOTE: Unlike FORMAT_HTTP_HEADERS, FORMAT_TEXT_MAP places no restrictions\n * on the characters used in either the keys or the values of the map\n * entries.\n *\n * The FORMAT_TEXT_MAP carrier map may contain unrelated data (e.g.,\n * arbitrary gRPC metadata); as such, the Tracer implementation should use\n * a prefix or other convention to distinguish Tracer-specific key:value\n * pairs.\n */\nexports.FORMAT_TEXT_MAP = 'text_map';\n/**\n * The FORMAT_HTTP_HEADERS format represents SpanContexts using a\n * character-restricted string->string map (backed by a Javascript Object)\n * as a carrier.\n *\n * Keys and values in the FORMAT_HTTP_HEADERS carrier must be suitable for\n * use as HTTP headers (without modification or further escaping). That is,\n * the keys have a greatly restricted character set, casing for the keys\n * may not be preserved by various intermediaries, and the values should be\n * URL-escaped.\n *\n * The FORMAT_HTTP_HEADERS carrier map may contain unrelated data (e.g.,\n * arbitrary HTTP headers); as such, the Tracer implementation should use a\n * prefix or other convention to distinguish Tracer-specific key:value\n * pairs.\n */\nexports.FORMAT_HTTP_HEADERS = 'http_headers';\n/**\n * A Span may be the \"child of\" a parent Span. In a “child of” reference,\n * the parent Span depends on the child Span in some capacity.\n *\n * See more about reference types at https://github.com/opentracing/specification\n */\nexports.REFERENCE_CHILD_OF = 'child_of';\n/**\n * Some parent Spans do not depend in any way on the result of their child\n * Spans. In these cases, we say merely that the child Span “follows from”\n * the parent Span in a causal sense.\n *\n * See more about reference types at https://github.com/opentracing/specification\n */\nexports.REFERENCE_FOLLOWS_FROM = 'follows_from';\n//# sourceMappingURL=constants.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/** SPAN_KIND hints at relationship between spans, e.g. client/server */\nexports.SPAN_KIND = 'span.kind';\n/** Marks a span representing the client-side of an RPC or other remote call */\nexports.SPAN_KIND_RPC_CLIENT = 'client';\n/** Marks a span representing the server-side of an RPC or other remote call */\nexports.SPAN_KIND_RPC_SERVER = 'server';\n/** Marks a span representing the producing-side within a messaging system or other remote call */\nexports.SPAN_KIND_MESSAGING_PRODUCER = 'producer';\n/** Marks a span representing the consuming-side within a messaging system or other remote call */\nexports.SPAN_KIND_MESSAGING_CONSUMER = 'consumer';\n/**\n * ERROR (boolean) true if and only if the application considers the operation\n * represented by the Span to have failed\n */\nexports.ERROR = 'error';\n/**\n * COMPONENT (string) ia s low-cardinality identifier of the module, library,\n * or package that is generating a span.\n */\nexports.COMPONENT = 'component';\n/**\n * SAMPLING_PRIORITY (number) determines the priority of sampling this Span.\n * If greater than 0, a hint to the Tracer to do its best to capture the trace.\n * If 0, a hint to the trace to not-capture the trace. If absent, the Tracer\n * should use its default sampling mechanism.\n */\nexports.SAMPLING_PRIORITY = 'sampling.priority';\n// ---------------------------------------------------------------------------\n// PEER_* tags can be emitted by either client-side of server-side to describe\n// the other side/service in a peer-to-peer communications, like an RPC call.\n// ---------------------------------------------------------------------------\n/**\n * PEER_SERVICE (string) Remote service name (for some unspecified\n * definition of \"service\"). E.g., \"elasticsearch\", \"a_custom_microservice\", \"memcache\"\n */\nexports.PEER_SERVICE = 'peer.service';\n/** PEER_HOSTNAME (string) Remote hostname. E.g., \"opentracing.io\", \"internal.dns.name\" */\nexports.PEER_HOSTNAME = 'peer.hostname';\n/**\n * PEER_ADDRESS (string) Remote \"address\", suitable for use in a\n * networking client library. This may be a \"ip:port\", a bare\n * \"hostname\", a FQDN, or even a JDBC substring like \"mysql://prod-db:3306\"\n */\nexports.PEER_ADDRESS = 'peer.address';\n/**\n * PEER_HOST_IPV4 (number) Remote IPv4 address as a .-separated tuple.\n * E.g., \"127.0.0.1\"\n */\nexports.PEER_HOST_IPV4 = 'peer.ipv4';\n// PEER_HOST_IPV6 (string) Remote IPv6 address as a string of\n// colon-separated 4-char hex tuples. E.g., \"2001:0db8:85a3:0000:0000:8a2e:0370:7334\"\nexports.PEER_HOST_IPV6 = 'peer.ipv6';\n// PEER_PORT (number) Remote port. E.g., 80\nexports.PEER_PORT = 'peer.port';\n// ---------------------------------------------------------------------------\n// HTTP tags\n// ---------------------------------------------------------------------------\n/**\n * HTTP_URL (string) URL of the request being handled in this segment of the\n * trace, in standard URI format. E.g., \"https://domain.net/path/to?resource=here\"\n */\nexports.HTTP_URL = 'http.url';\n/**\n * HTTP_METHOD (string) HTTP method of the request for the associated Span. E.g.,\n * \"GET\", \"POST\"\n */\nexports.HTTP_METHOD = 'http.method';\n/**\n * HTTP_STATUS_CODE (number) HTTP response status code for the associated Span.\n * E.g., 200, 503, 404\n */\nexports.HTTP_STATUS_CODE = 'http.status_code';\n// -------------------------------------------------------------------------\n// Messaging tags\n// -------------------------------------------------------------------------\n/**\n * MESSAGE_BUS_DESTINATION (string) An address at which messages can be exchanged.\n * E.g. A Kafka record has an associated \"topic name\" that can be extracted\n * by the instrumented producer or consumer and stored using this tag.\n */\nexports.MESSAGE_BUS_DESTINATION = 'message_bus.destination';\n// --------------------------------------------------------------------------\n// Database tags\n// --------------------------------------------------------------------------\n/**\n * DB_INSTANCE (string) Database instance name. E.g., In java, if the\n * jdbc.url=\"jdbc:mysql://127.0.0.1:3306/customers\", the instance name is \"customers\".\n */\nexports.DB_INSTANCE = 'db.instance';\n/**\n * DB_STATEMENT (string) A database statement for the given database type.\n * E.g., for db.type=\"SQL\", \"SELECT * FROM wuser_table\";\n * for db.type=\"redis\", \"SET mykey 'WuValue'\".\n */\nexports.DB_STATEMENT = 'db.statement';\n/**\n * DB_TYPE (string) Database type. For any SQL database, \"sql\". For others,\n * the lower-case database category, e.g. \"cassandra\", \"hbase\", or \"redis\".\n */\nexports.DB_TYPE = 'db.type';\n/**\n * DB_USER (string) Username for accessing database. E.g., \"readonly_user\"\n * or \"reporting_user\"\n */\nexports.DB_USER = 'db.user';\n//# sourceMappingURL=tags.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Constants = require(\"./constants\");\nvar reference_1 = require(\"./reference\");\nvar span_1 = require(\"./span\");\n/**\n * Return a new REFERENCE_CHILD_OF reference.\n *\n * @param {SpanContext} spanContext - the parent SpanContext instance to\n *        reference.\n * @return a REFERENCE_CHILD_OF reference pointing to `spanContext`\n */\nfunction childOf(spanContext) {\n    // Allow the user to pass a Span instead of a SpanContext\n    if (spanContext instanceof span_1.default) {\n        spanContext = spanContext.context();\n    }\n    return new reference_1.default(Constants.REFERENCE_CHILD_OF, spanContext);\n}\nexports.childOf = childOf;\n/**\n * Return a new REFERENCE_FOLLOWS_FROM reference.\n *\n * @param {SpanContext} spanContext - the parent SpanContext instance to\n *        reference.\n * @return a REFERENCE_FOLLOWS_FROM reference pointing to `spanContext`\n */\nfunction followsFrom(spanContext) {\n    // Allow the user to pass a Span instead of a SpanContext\n    if (spanContext instanceof span_1.default) {\n        spanContext = spanContext.context();\n    }\n    return new reference_1.default(Constants.REFERENCE_FOLLOWS_FROM, spanContext);\n}\nexports.followsFrom = followsFrom;\n//# sourceMappingURL=functions.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tracer_1 = require(\"./tracer\");\nvar noopTracer = new tracer_1.default();\nvar _globalTracer = null;\n// Allows direct importing/requiring of the global tracer:\n//\n// let globalTracer = require('opentracing/global');\n//      OR\n// import globalTracer from 'opentracing/global';\n//\n// Acts a bridge to the global tracer that can be safely called before the\n// global tracer is initialized. The purpose of the delegation is to avoid the\n// sometimes nearly intractible initialization order problems that can arise in\n// applications with a complex set of dependencies, while also avoiding the\n// case where\nvar GlobalTracerDelegate = /** @class */ (function (_super) {\n    __extends(GlobalTracerDelegate, _super);\n    function GlobalTracerDelegate() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    GlobalTracerDelegate.prototype.startSpan = function () {\n        var tracer = _globalTracer || noopTracer;\n        return tracer.startSpan.apply(tracer, arguments);\n    };\n    GlobalTracerDelegate.prototype.inject = function () {\n        var tracer = _globalTracer || noopTracer;\n        return tracer.inject.apply(tracer, arguments);\n    };\n    GlobalTracerDelegate.prototype.extract = function () {\n        var tracer = _globalTracer || noopTracer;\n        return tracer.extract.apply(tracer, arguments);\n    };\n    return GlobalTracerDelegate;\n}(tracer_1.default));\nvar globalTracerDelegate = new GlobalTracerDelegate();\n/**\n * Set the global Tracer.\n *\n * The behavior is undefined if this function is called more than once.\n *\n * @param {Tracer} tracer - the Tracer implementation\n */\nfunction initGlobalTracer(tracer) {\n    _globalTracer = tracer;\n}\nexports.initGlobalTracer = initGlobalTracer;\n/**\n * Returns the global tracer.\n */\nfunction globalTracer() {\n    // Return the delegate.  Since the global tracer is largely a convenience\n    // (the user can always create their own tracers), the delegate is used to\n    // give the added convenience of not needing to worry about initialization\n    // order.\n    return globalTracerDelegate;\n}\nexports.globalTracer = globalTracer;\n//# sourceMappingURL=global_tracer.js.map","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar binary_carrier_1 = require(\"./binary_carrier\");\nexports.BinaryCarrier = binary_carrier_1.default;\nvar Tags = require(\"./ext/tags\");\nexports.Tags = Tags;\nvar Noop = require(\"./noop\");\nvar reference_1 = require(\"./reference\");\nexports.Reference = reference_1.default;\nvar span_1 = require(\"./span\");\nexports.Span = span_1.default;\nvar span_context_1 = require(\"./span_context\");\nexports.SpanContext = span_context_1.default;\nvar tracer_1 = require(\"./tracer\");\nexports.Tracer = tracer_1.Tracer;\nvar mock_tracer_1 = require(\"./mock_tracer\");\nexports.MockTracer = mock_tracer_1.MockTracer;\n__export(require(\"./global_tracer\"));\n__export(require(\"./constants\"));\n__export(require(\"./functions\"));\n// Initialize the noops last to avoid a dependecy cycle between the classes.\nNoop.initialize();\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar mock_context_1 = require(\"./mock_context\");\nexports.MockContext = mock_context_1.default;\nvar mock_span_1 = require(\"./mock_span\");\nexports.MockSpan = mock_span_1.default;\nvar mock_tracer_1 = require(\"./mock_tracer\");\nexports.MockTracer = mock_tracer_1.default;\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar span_context_1 = require(\"../span_context\");\n/**\n * OpenTracing Context implementation designed for use in\n * unit tests.\n */\nvar MockContext = /** @class */ (function (_super) {\n    __extends(MockContext, _super);\n    function MockContext(span) {\n        var _this = _super.call(this) || this;\n        // Store a reference to the span itself since this is a mock tracer\n        // intended to make debugging and unit testing easier.\n        _this._span = span;\n        return _this;\n    }\n    MockContext.prototype.span = function () {\n        return this._span;\n    };\n    return MockContext;\n}(span_context_1.SpanContext));\nexports.MockContext = MockContext;\nexports.default = MockContext;\n//# sourceMappingURL=mock_context.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Index a collection of reported MockSpans in a way that's easy to run unit\n * test assertions against.\n */\nvar MockReport = /** @class */ (function () {\n    function MockReport(spans) {\n        var _this = this;\n        this.spans = spans;\n        this.spansByUUID = {};\n        this.spansByTag = {};\n        this.debugSpans = [];\n        this.unfinishedSpans = [];\n        spans.forEach(function (span) {\n            if (span._finishMs === 0) {\n                _this.unfinishedSpans.push(span);\n            }\n            _this.spansByUUID[span.uuid()] = span;\n            _this.debugSpans.push(span.debug());\n            var tags = span.tags();\n            Object.keys(tags).forEach(function (key) {\n                var val = tags[key];\n                _this.spansByTag[key] = _this.spansByTag[key] || {};\n                _this.spansByTag[key][val] = _this.spansByTag[key][val] || [];\n                _this.spansByTag[key][val].push(span);\n            });\n        });\n    }\n    MockReport.prototype.firstSpanWithTagValue = function (key, val) {\n        var m = this.spansByTag[key];\n        if (!m) {\n            return null;\n        }\n        var n = m[val];\n        if (!n) {\n            return null;\n        }\n        return n[0];\n    };\n    return MockReport;\n}());\nexports.MockReport = MockReport;\nexports.default = MockReport;\n//# sourceMappingURL=mock_report.js.map","\"use strict\";\n/* eslint-disable import/no-extraneous-dependencies */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar opentracing = require(\"../index\");\nvar mock_context_1 = require(\"./mock_context\");\n/**\n * OpenTracing Span implementation designed for use in unit tests.\n */\nvar MockSpan = /** @class */ (function (_super) {\n    __extends(MockSpan, _super);\n    //------------------------------------------------------------------------//\n    // MockSpan-specific\n    //------------------------------------------------------------------------//\n    function MockSpan(tracer) {\n        var _this = _super.call(this) || this;\n        _this._mockTracer = tracer;\n        _this._uuid = _this._generateUUID();\n        _this._startMs = Date.now();\n        _this._finishMs = 0;\n        _this._operationName = '';\n        _this._tags = {};\n        _this._logs = [];\n        return _this;\n    }\n    //------------------------------------------------------------------------//\n    // OpenTracing implementation\n    //------------------------------------------------------------------------//\n    MockSpan.prototype._context = function () {\n        return new mock_context_1.default(this);\n    };\n    MockSpan.prototype._setOperationName = function (name) {\n        this._operationName = name;\n    };\n    MockSpan.prototype._addTags = function (set) {\n        var keys = Object.keys(set);\n        for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n            var key = keys_1[_i];\n            this._tags[key] = set[key];\n        }\n    };\n    MockSpan.prototype._log = function (fields, timestamp) {\n        this._logs.push({\n            fields: fields,\n            timestamp: timestamp\n        });\n    };\n    MockSpan.prototype._finish = function (finishTime) {\n        this._finishMs = finishTime || Date.now();\n    };\n    MockSpan.prototype.uuid = function () {\n        return this._uuid;\n    };\n    MockSpan.prototype.operationName = function () {\n        return this._operationName;\n    };\n    MockSpan.prototype.durationMs = function () {\n        return this._finishMs - this._startMs;\n    };\n    MockSpan.prototype.tags = function () {\n        return this._tags;\n    };\n    MockSpan.prototype.tracer = function () {\n        return this._mockTracer;\n    };\n    MockSpan.prototype._generateUUID = function () {\n        var p0 = (\"00000000\" + Math.abs((Math.random() * 0xFFFFFFFF) | 0).toString(16)).substr(-8);\n        var p1 = (\"00000000\" + Math.abs((Math.random() * 0xFFFFFFFF) | 0).toString(16)).substr(-8);\n        return \"\" + p0 + p1;\n    };\n    MockSpan.prototype.addReference = function (ref) {\n    };\n    /**\n     * Returns a simplified object better for console.log()'ing.\n     */\n    MockSpan.prototype.debug = function () {\n        var obj = {\n            uuid: this._uuid,\n            operation: this._operationName,\n            millis: [this._finishMs - this._startMs, this._startMs, this._finishMs]\n        };\n        if (Object.keys(this._tags).length) {\n            obj.tags = this._tags;\n        }\n        return obj;\n    };\n    return MockSpan;\n}(opentracing.Span));\nexports.MockSpan = MockSpan;\nexports.default = MockSpan;\n//# sourceMappingURL=mock_span.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// TODO: Move mock-tracer to its own NPM package once it is complete and tested.\nvar opentracing = require(\"../index\");\nvar mock_report_1 = require(\"./mock_report\");\nvar mock_span_1 = require(\"./mock_span\");\n/**\n * OpenTracing Tracer implementation designed for use in unit tests.\n */\nvar MockTracer = /** @class */ (function (_super) {\n    __extends(MockTracer, _super);\n    //------------------------------------------------------------------------//\n    // MockTracer-specific\n    //------------------------------------------------------------------------//\n    function MockTracer() {\n        var _this = _super.call(this) || this;\n        _this._spans = [];\n        return _this;\n    }\n    //------------------------------------------------------------------------//\n    // OpenTracing implementation\n    //------------------------------------------------------------------------//\n    MockTracer.prototype._startSpan = function (name, fields) {\n        // _allocSpan is given it's own method so that derived classes can\n        // allocate any type of object they want, but not have to duplicate\n        // the other common logic in startSpan().\n        var span = this._allocSpan();\n        span.setOperationName(name);\n        this._spans.push(span);\n        if (fields.references) {\n            for (var _i = 0, _a = fields.references; _i < _a.length; _i++) {\n                var ref = _a[_i];\n                span.addReference(ref);\n            }\n        }\n        // Capture the stack at the time the span started\n        span._startStack = new Error().stack;\n        return span;\n    };\n    MockTracer.prototype._inject = function (span, format, carrier) {\n        throw new Error('NOT YET IMPLEMENTED');\n    };\n    MockTracer.prototype._extract = function (format, carrier) {\n        throw new Error('NOT YET IMPLEMENTED');\n    };\n    MockTracer.prototype._allocSpan = function () {\n        return new mock_span_1.default(this);\n    };\n    /**\n     * Discard any buffered data.\n     */\n    MockTracer.prototype.clear = function () {\n        this._spans = [];\n    };\n    /**\n     * Return the buffered data in a format convenient for making unit test\n     * assertions.\n     */\n    MockTracer.prototype.report = function () {\n        return new mock_report_1.default(this._spans);\n    };\n    return MockTracer;\n}(opentracing.Tracer));\nexports.MockTracer = MockTracer;\nexports.default = MockTracer;\n//# sourceMappingURL=mock_tracer.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar span_1 = require(\"./span\");\nvar span_context_1 = require(\"./span_context\");\nvar tracer_1 = require(\"./tracer\");\nexports.tracer = null;\nexports.spanContext = null;\nexports.span = null;\n// Deferred initialization to avoid a dependency cycle where Tracer depends on\n// Span which depends on the noop tracer.\nfunction initialize() {\n    exports.tracer = new tracer_1.default();\n    exports.span = new span_1.default();\n    exports.spanContext = new span_context_1.default();\n}\nexports.initialize = initialize;\n//# sourceMappingURL=noop.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar span_1 = require(\"./span\");\n/**\n * Reference pairs a reference type constant (e.g., REFERENCE_CHILD_OF or\n * REFERENCE_FOLLOWS_FROM) with the SpanContext it points to.\n *\n * See the exported childOf() and followsFrom() functions at the package level.\n */\nvar Reference = /** @class */ (function () {\n    /**\n     * Initialize a new Reference instance.\n     *\n     * @param {string} type - the Reference type constant (e.g.,\n     *        REFERENCE_CHILD_OF or REFERENCE_FOLLOWS_FROM).\n     * @param {SpanContext} referencedContext - the SpanContext being referred\n     *        to. As a convenience, a Span instance may be passed in instead\n     *        (in which case its .context() is used here).\n     */\n    function Reference(type, referencedContext) {\n        this._type = type;\n        this._referencedContext = (referencedContext instanceof span_1.default ?\n            referencedContext.context() :\n            referencedContext);\n    }\n    /**\n     * @return {string} The Reference type (e.g., REFERENCE_CHILD_OF or\n     *         REFERENCE_FOLLOWS_FROM).\n     */\n    Reference.prototype.type = function () {\n        return this._type;\n    };\n    /**\n     * @return {SpanContext} The SpanContext being referred to (e.g., the\n     *         parent in a REFERENCE_CHILD_OF Reference).\n     */\n    Reference.prototype.referencedContext = function () {\n        return this._referencedContext;\n    };\n    return Reference;\n}());\nexports.default = Reference;\n//# sourceMappingURL=reference.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar noop = require(\"./noop\");\n/**\n * Span represents a logical unit of work as part of a broader Trace. Examples\n * of span might include remote procedure calls or a in-process function calls\n * to sub-components. A Trace has a single, top-level \"root\" Span that in turn\n * may have zero or more child Spans, which in turn may have children.\n */\nvar Span = /** @class */ (function () {\n    function Span() {\n    }\n    // ---------------------------------------------------------------------- //\n    // OpenTracing API methods\n    // ---------------------------------------------------------------------- //\n    /**\n     * Returns the SpanContext object associated with this Span.\n     *\n     * @return {SpanContext}\n     */\n    Span.prototype.context = function () {\n        return this._context();\n    };\n    /**\n     * Returns the Tracer object used to create this Span.\n     *\n     * @return {Tracer}\n     */\n    Span.prototype.tracer = function () {\n        return this._tracer();\n    };\n    /**\n     * Sets the string name for the logical operation this span represents.\n     *\n     * @param {string} name\n     */\n    Span.prototype.setOperationName = function (name) {\n        this._setOperationName(name);\n        return this;\n    };\n    /**\n     * Sets a key:value pair on this Span that also propagates to future\n     * children of the associated Span.\n     *\n     * setBaggageItem() enables powerful functionality given a full-stack\n     * opentracing integration (e.g., arbitrary application data from a web\n     * client can make it, transparently, all the way into the depths of a\n     * storage system), and with it some powerful costs: use this feature with\n     * care.\n     *\n     * IMPORTANT NOTE #1: setBaggageItem() will only propagate baggage items to\n     * *future* causal descendants of the associated Span.\n     *\n     * IMPORTANT NOTE #2: Use this thoughtfully and with care. Every key and\n     * value is copied into every local *and remote* child of the associated\n     * Span, and that can add up to a lot of network and cpu overhead.\n     *\n     * @param {string} key\n     * @param {string} value\n     */\n    Span.prototype.setBaggageItem = function (key, value) {\n        this._setBaggageItem(key, value);\n        return this;\n    };\n    /**\n     * Returns the value for a baggage item given its key.\n     *\n     * @param  {string} key\n     *         The key for the given trace attribute.\n     * @return {string}\n     *         String value for the given key, or undefined if the key does not\n     *         correspond to a set trace attribute.\n     */\n    Span.prototype.getBaggageItem = function (key) {\n        return this._getBaggageItem(key);\n    };\n    /**\n     * Adds a single tag to the span.  See `addTags()` for details.\n     *\n     * @param {string} key\n     * @param {any} value\n     */\n    Span.prototype.setTag = function (key, value) {\n        var _a;\n        // NOTE: the call is normalized to a call to _addTags()\n        this._addTags((_a = {}, _a[key] = value, _a));\n        return this;\n    };\n    /**\n     * Adds the given key value pairs to the set of span tags.\n     *\n     * Multiple calls to addTags() results in the tags being the superset of\n     * all calls.\n     *\n     * The behavior of setting the same key multiple times on the same span\n     * is undefined.\n     *\n     * The supported type of the values is implementation-dependent.\n     * Implementations are expected to safely handle all types of values but\n     * may choose to ignore unrecognized / unhandle-able values (e.g. objects\n     * with cyclic references, function objects).\n     *\n     * @return {[type]} [description]\n     */\n    Span.prototype.addTags = function (keyValueMap) {\n        this._addTags(keyValueMap);\n        return this;\n    };\n    /**\n     * Add a log record to this Span, optionally at a user-provided timestamp.\n     *\n     * For example:\n     *\n     *     span.log({\n     *         size: rpc.size(),  // numeric value\n     *         URI: rpc.URI(),  // string value\n     *         payload: rpc.payload(),  // Object value\n     *         \"keys can be arbitrary strings\": rpc.foo(),\n     *     });\n     *\n     *     span.log({\n     *         \"error.description\": someError.description(),\n     *     }, someError.timestampMillis());\n     *\n     * @param {object} keyValuePairs\n     *        An object mapping string keys to arbitrary value types. All\n     *        Tracer implementations should support bool, string, and numeric\n     *        value types, and some may also support Object values.\n     * @param {number} timestamp\n     *        An optional parameter specifying the timestamp in milliseconds\n     *        since the Unix epoch. Fractional values are allowed so that\n     *        timestamps with sub-millisecond accuracy can be represented. If\n     *        not specified, the implementation is expected to use its notion\n     *        of the current time of the call.\n     */\n    Span.prototype.log = function (keyValuePairs, timestamp) {\n        this._log(keyValuePairs, timestamp);\n        return this;\n    };\n    /**\n     * DEPRECATED\n     */\n    Span.prototype.logEvent = function (eventName, payload) {\n        return this._log({ event: eventName, payload: payload });\n    };\n    /**\n     * Sets the end timestamp and finalizes Span state.\n     *\n     * With the exception of calls to Span.context() (which are always allowed),\n     * finish() must be the last call made to any span instance, and to do\n     * otherwise leads to undefined behavior.\n     *\n     * @param  {number} finishTime\n     *         Optional finish time in milliseconds as a Unix timestamp. Decimal\n     *         values are supported for timestamps with sub-millisecond accuracy.\n     *         If not specified, the current time (as defined by the\n     *         implementation) will be used.\n     */\n    Span.prototype.finish = function (finishTime) {\n        this._finish(finishTime);\n        // Do not return `this`. The Span generally should not be used after it\n        // is finished so chaining is not desired in this context.\n    };\n    // ---------------------------------------------------------------------- //\n    // Derived classes can choose to implement the below\n    // ---------------------------------------------------------------------- //\n    // By default returns a no-op SpanContext.\n    Span.prototype._context = function () {\n        return noop.spanContext;\n    };\n    // By default returns a no-op tracer.\n    //\n    // The base class could store the tracer that created it, but it does not\n    // in order to ensure the no-op span implementation has zero members,\n    // which allows V8 to aggressively optimize calls to such objects.\n    Span.prototype._tracer = function () {\n        return noop.tracer;\n    };\n    // By default does nothing\n    Span.prototype._setOperationName = function (name) {\n    };\n    // By default does nothing\n    Span.prototype._setBaggageItem = function (key, value) {\n    };\n    // By default does nothing\n    Span.prototype._getBaggageItem = function (key) {\n        return undefined;\n    };\n    // By default does nothing\n    //\n    // NOTE: both setTag() and addTags() map to this function. keyValuePairs\n    // will always be an associative array.\n    Span.prototype._addTags = function (keyValuePairs) {\n    };\n    // By default does nothing\n    Span.prototype._log = function (keyValuePairs, timestamp) {\n    };\n    // By default does nothing\n    //\n    // finishTime is expected to be either a number or undefined.\n    Span.prototype._finish = function (finishTime) {\n    };\n    return Span;\n}());\nexports.Span = Span;\nexports.default = Span;\n//# sourceMappingURL=span.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * SpanContext represents Span state that must propagate to descendant Spans\n * and across process boundaries.\n *\n * SpanContext is logically divided into two pieces: the user-level \"Baggage\"\n * (see setBaggageItem and getBaggageItem) that propagates across Span\n * boundaries and any Tracer-implementation-specific fields that are needed to\n * identify or otherwise contextualize the associated Span instance (e.g., a\n * <trace_id, span_id, sampled> tuple).\n */\nvar SpanContext = /** @class */ (function () {\n    function SpanContext() {\n    }\n    // The SpanContext is entirely implementation dependent\n    /**\n     * Returns a string representation of the implementation internal trace ID.\n     *\n     * @returns {string}\n     */\n    SpanContext.prototype.toTraceId = function () {\n        return '';\n    };\n    /**\n     * Returns a string representation of the implementation internal span ID.\n     *\n     * @returns {string}\n     */\n    SpanContext.prototype.toSpanId = function () {\n        return '';\n    };\n    return SpanContext;\n}());\nexports.SpanContext = SpanContext;\nexports.default = SpanContext;\n//# sourceMappingURL=span_context.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Functions = require(\"./functions\");\nvar Noop = require(\"./noop\");\nvar span_1 = require(\"./span\");\n/**\n * Tracer is the entry-point between the instrumentation API and the tracing\n * implementation.\n *\n * The default object acts as a no-op implementation.\n *\n * Note to implementators: derived classes can choose to directly implement the\n * methods in the \"OpenTracing API methods\" section, or optionally the subset of\n * underscore-prefixed methods to pick up the argument checking and handling\n * automatically from the base class.\n */\nvar Tracer = /** @class */ (function () {\n    function Tracer() {\n    }\n    // ---------------------------------------------------------------------- //\n    // OpenTracing API methods\n    // ---------------------------------------------------------------------- //\n    /**\n     * Starts and returns a new Span representing a logical unit of work.\n     *\n     * For example:\n     *\n     *     // Start a new (parentless) root Span:\n     *     var parent = Tracer.startSpan('DoWork');\n     *\n     *     // Start a new (child) Span:\n     *     var child = Tracer.startSpan('load-from-db', {\n     *         childOf: parent.context(),\n     *     });\n     *\n     *     // Start a new async (FollowsFrom) Span:\n     *     var child = Tracer.startSpan('async-cache-write', {\n     *         references: [\n     *             opentracing.followsFrom(parent.context())\n     *         ],\n     *     });\n     *\n     * @param {string} name - the name of the operation (REQUIRED).\n     * @param {SpanOptions} [options] - options for the newly created span.\n     * @return {Span} - a new Span object.\n     */\n    Tracer.prototype.startSpan = function (name, options) {\n        if (options === void 0) { options = {}; }\n        // Convert options.childOf to fields.references as needed.\n        if (options.childOf) {\n            // Convert from a Span or a SpanContext into a Reference.\n            var childOf = Functions.childOf(options.childOf);\n            if (options.references) {\n                options.references.push(childOf);\n            }\n            else {\n                options.references = [childOf];\n            }\n            delete (options.childOf);\n        }\n        return this._startSpan(name, options);\n    };\n    /**\n     * Injects the given SpanContext instance for cross-process propagation\n     * within `carrier`. The expected type of `carrier` depends on the value of\n     * `format.\n     *\n     * OpenTracing defines a common set of `format` values (see\n     * FORMAT_TEXT_MAP, FORMAT_HTTP_HEADERS, and FORMAT_BINARY), and each has\n     * an expected carrier type.\n     *\n     * Consider this pseudocode example:\n     *\n     *     var clientSpan = ...;\n     *     ...\n     *     // Inject clientSpan into a text carrier.\n     *     var headersCarrier = {};\n     *     Tracer.inject(clientSpan.context(), Tracer.FORMAT_HTTP_HEADERS, headersCarrier);\n     *     // Incorporate the textCarrier into the outbound HTTP request header\n     *     // map.\n     *     Object.assign(outboundHTTPReq.headers, headersCarrier);\n     *     // ... send the httpReq\n     *\n     * @param  {SpanContext} spanContext - the SpanContext to inject into the\n     *         carrier object. As a convenience, a Span instance may be passed\n     *         in instead (in which case its .context() is used for the\n     *         inject()).\n     * @param  {string} format - the format of the carrier.\n     * @param  {any} carrier - see the documentation for the chosen `format`\n     *         for a description of the carrier object.\n     */\n    Tracer.prototype.inject = function (spanContext, format, carrier) {\n        // Allow the user to pass a Span instead of a SpanContext\n        if (spanContext instanceof span_1.default) {\n            spanContext = spanContext.context();\n        }\n        return this._inject(spanContext, format, carrier);\n    };\n    /**\n     * Returns a SpanContext instance extracted from `carrier` in the given\n     * `format`.\n     *\n     * OpenTracing defines a common set of `format` values (see\n     * FORMAT_TEXT_MAP, FORMAT_HTTP_HEADERS, and FORMAT_BINARY), and each has\n     * an expected carrier type.\n     *\n     * Consider this pseudocode example:\n     *\n     *     // Use the inbound HTTP request's headers as a text map carrier.\n     *     var headersCarrier = inboundHTTPReq.headers;\n     *     var wireCtx = Tracer.extract(Tracer.FORMAT_HTTP_HEADERS, headersCarrier);\n     *     var serverSpan = Tracer.startSpan('...', { childOf : wireCtx });\n     *\n     * @param  {string} format - the format of the carrier.\n     * @param  {any} carrier - the type of the carrier object is determined by\n     *         the format.\n     * @return {SpanContext}\n     *         The extracted SpanContext, or null if no such SpanContext could\n     *         be found in `carrier`\n     */\n    Tracer.prototype.extract = function (format, carrier) {\n        return this._extract(format, carrier);\n    };\n    // ---------------------------------------------------------------------- //\n    // Derived classes can choose to implement the below\n    // ---------------------------------------------------------------------- //\n    // NOTE: the input to this method is *always* an associative array. The\n    // public-facing startSpan() method normalizes the arguments so that\n    // all N implementations do not need to worry about variations in the call\n    // signature.\n    //\n    // The default behavior returns a no-op span.\n    Tracer.prototype._startSpan = function (name, fields) {\n        return Noop.span;\n    };\n    // The default behavior is a no-op.\n    Tracer.prototype._inject = function (spanContext, format, carrier) {\n    };\n    // The default behavior is to return a no-op SpanContext.\n    Tracer.prototype._extract = function (format, carrier) {\n        return Noop.spanContext;\n    };\n    return Tracer;\n}());\nexports.Tracer = Tracer;\nexports.default = Tracer;\n//# sourceMappingURL=tracer.js.map","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/lib.js\");\n",""],"names":["_each","obj","cb","key","hasOwnProperty","call","LOG_INFO","LOG_WARN","LOG_ERROR","LOG_FATAL","LOG_LEVEL_TO_STRING","LOG_STRING_TO_LEVEL","I","W","E","F","CLOCK_STATE_REFRESH_INTERVAL_MS","LIGHTSTEP_APP_URL_PREFIX","JOIN_ID_PREFIX","LS_META_EVENT_KEY","LS_META_PROPAGATION_KEY","LS_META_TRACE_KEY","LS_META_SPAN_KEY","LS_META_TRACER_GUID_KEY","LS_META_EXTRACT","LS_META_INJECT","LS_META_SP_START","LS_META_SP_FINISH","LS_META_TRACER_CREATE","FORMAT_B3","AuthImp","accessToken","_accessToken","length","crouton_thrift","Auth","access_token","toString","value","toNumber","Number","toBoolean","PackageGlobals","options","opts","val","module","exports","constants","require","coerce","LogBuilder","runtime","_runtime","_record","LogRecord","timestamp_micros","_platform","nowMicros","runtime_guid","span_guid","stable_name","message","level","thread_id","filename","line_number","stack_frames","payload_json","error_flag","_addLogRecord","micros","msg","num","error","guid","undefined","stableName","flag","data","_encodePayload","payloadJSON","JSON","stringify","_ignored","LogRecordImp","logFieldKeyHardLimit","logFieldValueHardLimit","timestampMicros","fields","Error","stack","_logFieldKeyHardLimit","_logFieldValueHardLimit","_timestampMicros","_fields","_keysOverLimit","_valuesOverLimit","_clearOverLimits","thriftFields","keyStr","getFieldKey","valStr","getFieldValue","push","KeyValue","Key","Value","substr","Object","getOwnPropertyNames","e","Thrift","args","TProtocolException","TProtocolExceptionType","UNKNOWN","prototype","read","input","readStructBegin","ret","readFieldBegin","fname","ftype","fid","Type","STOP","STRING","readString","skip","readFieldEnd","readStructEnd","write","output","writeStructBegin","writeFieldBegin","writeString","writeFieldEnd","writeFieldStop","writeStructEnd","NamedCounter","Name","I64","readI64","writeI64","Runtime","start_micros","group_name","attrs","LIST","_size0","_rtmp34","_etype3","readListBegin","etype","size","_i5","elem6","readListEnd","writeListBegin","STRUCT","iter7","writeListEnd","_size8","_rtmp312","_etype11","_i13","elem14","_size15","_rtmp319","_etype18","_i20","elem21","BOOL","readBool","iter22","iter23","writeBool","TraceJoinId","TraceKey","SpanRecord","trace_guid","span_name","join_ids","oldest_micros","youngest_micros","attributes","log_records","_size24","_rtmp328","_etype27","_i29","elem30","_size31","_rtmp335","_etype34","_i36","elem37","_size38","_rtmp342","_etype41","_i43","elem44","iter45","iter46","iter47","Timing","receive_micros","transmit_micros","SampleCount","count","MetricsSample","name","int64_value","double_value","DOUBLE","readDouble","writeDouble","Metrics","counts","gauges","_size48","_rtmp352","_etype51","_i53","elem54","_size55","_rtmp359","_etype58","_i60","elem61","iter62","iter63","ReportRequest","span_records","timestamp_offset_micros","counters","internal_logs","internal_metrics","_size64","_rtmp368","_etype67","_i69","elem70","_size71","_rtmp375","_etype74","_i76","elem77","_size78","_rtmp382","_etype81","_i83","elem84","_size85","_rtmp389","_etype88","_i90","elem91","iter92","iter93","iter94","iter95","Command","disable","ReportResponse","commands","timing","_size96","_rtmp3100","_etype99","_i101","elem102","iter103","util","hostScriptElement","WorkerGlobalScope","self","isBrowser","scripts","document","getElementsByTagName","urlQueryParameters","defaults","vars","qi","window","location","href","indexOf","slice","hashes","replace","split","i","hash","decodeURIComponent","parseScriptElementOptions","browserOpts","dataset","componentName","component_name","collectorHost","collector_host","collectorPort","collector_port","parseInt","collectorPath","collector_path","collectorEncryption","collector_encryption","enable","verbosity","init","init_global_tracer","xhr_instrumentation","instrument_page_load","parseScriptElementOptionsNoop","parseURLQueryOptions","params","lightstep_verbosity","lightstep_log_to_console","log_to_console","parseURLQueryOptionsNoop","optionsParser","kRuntimeGUIDCookiePrefix","kSessionIDCookieKey","kCookieTimeToLiveSeconds","nowMicrosImp","performance","now","navigationStart","start","Math","floor","Date","PlatformBrowser","groupName","cookieKey","encodeURIComponent","uuid","cookie","_generateLongUUID","sessionID","p0","abs","random","p1","addEventListener","imp","tracerOpts","sessionStorage","parse","getItem","setItem","lib","initGlobalTracer","opentracing","Tracer","TransportBrowser","_host","_port","_path","_encryption","detached","auth","report","done","_reportAJAX","_reportAsyncScript","payload","toThrift","protocol","url","xhr","XMLHttpRequest","open","setRequestHeader","getAccessToken","onreadystatechange","readyState","err","resp","status","responseText","exception","send","authJSON","reportJSON","elem","createElement","async","defer","src","type","hostElem","appendChild","ttl","path","domain","secure","arguments","newCookie","toUTCString","cookieNoop","UnsupportedPropagator","tracer","_tracer","_name","spanContext","carrier","_error","CARRIER_B3_TRACER_STATE_PREFIX","B3Propagator","_carrierPrefix","traceId","traceGUID","_guid","_sampled","forEachBaggageItem","_baggagePrefix","LightStepPropagator","CARRIER_DD_TRACER_STATE_PREFIX","DDPropagator","CARRIER_BAGGAGE_PREFIX","foundFields","spanGUID","sampled","toLowerCase","suffix","SpanContextImp","setBaggageItem","CARRIER_TRACER_STATE_PREFIX","_traceGUID","ReportImp","oldestMicros","youngestMicros","spanRecords","internalLogs","timestampOffsetMicros","_oldestMicros","_youngestMicros","_spanRecords","_internalLogs","_counters","_timestampOffsetMicros","span","_runtimeGUID","thriftCounters","thriftSpanRecords","spanRecord","_toThrift","RuntimeImp","runtimeGUID","startMicros","_startMicros","_componentName","_attributes","thriftAttrs","_baggage","_upperTraceGUID","f","SpanImp","console","assert","_tracerImp","_ctx","_ended","_operationName","_tags","_beginMicros","_endMicros","_errorFlag","_log_records","getBaggageItem","keyValuePairs","timestamp","argumentType","tsMicros","record","getLogFieldKeyHardLimit","getLogFieldValueHardLimit","emit","finishTime","end","parent_span_guid","urlPrefix","setEndMicros","shouldSendMetaSpan","getTags","startSpan","tags","finish","isSampled","_addSpanRecord","logs","logRecord","logThrift","getNumKeysOverLimit","getNumValuesOverLimit","Span","ClockState","globals","packageObject","DEFAULT_COLLECTOR_HOSTNAME","DEFAULT_COLLECTOR_PORT_TLS","DEFAULT_COLLECTOR_PORT_PLAIN","DEFAULT_COLLECTOR_PATH","MAX_INTERNAL_LOGS","_singleton","_delegateEventEmitterMethods","setOptions","Platform","override_runtime_guid","_plugins","_options","_optionDescs","_makeOptionsTable","_opentracing","opentracing_module","_auth","logger","warn","_warn","_transport","override_transport","_propagators","FORMAT_HTTP_HEADERS","FORMAT_TEXT_MAP","FORMAT_BINARY","propagators","_reportingLoopActive","_first_report_has_run","_reportYoungestMicros","_reportTimer","_reportErrorStreak","_lastVisibleErrorMillis","_skippedVisibleErrors","_activeRootSpanSet","_activeRootSpan","_flushIsActive","addPlugin","addPlatformPlugins","setPlatformOptions","transport","ThriftTransport","_info","_useClockState","disable_clock_skew_correction","_clockState","localStoreGet","localStoreSet","_setupReportOnExit","startPlugins","_ee","EventEmitter","methodName","apply","addOption","min","max","defaultValue","_printToConsole","bind","parentCtxImp","references","ref","REFERENCE_CHILD_OF","REFERENCE_FOLLOWS_FROM","context","referencedContext","generateTraceGUIDForRootSpan","spanCtx","generateUUID","spanImp","addTags","default_span_tags","setBeginMicros","setParentGUID","k","v","format","meta_event_reporting","inject","sc","extract","disabled","_flushReport","userOptions","desc","modified","unchanged","_setOptionInternal","keys","forEach","_initReportingDataIfNeeded","_startReportingLoop","optionsString","newValue","_debug","valueType","oldValue","version","platformTags","tracerTags","log_field_key_hard_limit","log_field_value_hard_limit","pluginSet","plugins","plugin","addOptions","_setActiveRootSpanToYoungest","jsonString","buffer","ArrayBuffer","view","Uint8Array","code","charCodeAt","arr","String","fromCharCode","b","unused","countersAllZero","_internalAddSpanRecord","max_span_records","index","spans","currentInternalLogs","toAdd","concat","log","_pushInternalLog","maxErrorsToEmpty","clear_span_buffer_consecutive_errors","numSpansToDrop","max_consecutive_errors","spans_dropped","disable_report_on_exit","finalFlushOnce","finalFlush","unflushed_spans","buffer_youngest_micros","onBeforeExit","disable_reporting_loop","stopReportingOnce","stopReporting","_stopReportingLoop","loop","_enqueueNextReport","delay","delay_initial_report_millis","detachedTimeout","clearTimeout","reportInterval","max_reporting_interval_millis","isReady","backOff","basis","jitter","manual","clockReady","clockOffsetMicros","offsetMicros","offset_micros","active_samples","activeSampleCount","ready","_buffersAreEmpty","_clearBuffers","ensureConnection","timestampOffset","originMicros","res","destinationMicros","reportWindowSeconds","errString","last_report_seconds_ago","_restoreRecords","getSpanRecords","getInternalLogs","getCounters","_clearSpanRecordsIfMaxErrors","streak","spans_reported","addSample","receiveTimestamp","transmitTimestamp","seconds","nanos","errors","errorsList","commandsList","devMode","disable_meta_event_reporting","nextVisible","error_throttle_millis","s","method","silent","kMaxOffsetAge","kStoredSamplesTTLMicros","_nowMicros","_localStoreGet","_localStoreSet","_samples","_currentOffsetMicros","_currentOffsetAge","storedData","samples","update","receiveMicros","transmitMicros","latestDelayMicros","MAX_VALUE","latestOffsetMicros","shift","delayMicros","minDelayMicros","bestOffsetMicros","sample","sqrt","kSGATE","converter","Util","callback","timer","setTimeout","unref","shouldSendSpan","hexString","global","BigInt","hexToDec","library","SpanContext","initLibrary","PLATFORM_BROWSER","thrift","InstrumentPageLoad","_inited","_span","tracerImp","currentOptions","_ensureSpanStarted","_handleReadyStateChange","addActiveRootSpan","state","_addTimingSpans","logEvent","removeActiveRootSpan","nav","dst","p","item","description","suffixes","parentImp","setTag","navigator","userAgent","_copyNavigatorProperties","childOf","requestStart","responseStart","responseEnd","domLoading","domInteractive","proxiedFetch","fetch","getCookies","cookies","parts","getResponseHeaders","response","result","entries","headers","pair","InstrumentFetch","_enabled","_isValidContext","_proxyInited","_internalExclusions","_handleOptions","_addServiceHostToExclusions","on","current","serviceHost","fetch_instrumentation","_instrumentFetch","escapeRegExp","str","host","port","set","RegExp","request","Request","_shouldTrace","parsed","URL","origin","hostname","pathname","search","include_cookies","_shouldAddHeadersToRequest","headersCarrier","get","event","openPayload","then","ok","statusText","responseType","catch","some","ex","test","fetch_url_exclusion_patterns","fetch_url_inclusion_patterns","inc","fetch_url_header_exclusion_patterns","fetch_url_header_inclusion_patterns","proxied","raw","getAllResponseHeaders","InstrumentXHR","proto","_instrumentSetRequestHeader","_instrumentOpen","_instrumentSend","header","__requestHeaders","asyncArg","user","password","__tracer_span","__tracer_url","url_pathname","Array","len","lenStr","data_length","xhr_url_exclusion_patterns","xhr_url_inclusion_patterns","xhr_url_header_exclusion_patterns","xhr_url_header_inclusion_patterns","LogToConsole","_optionsCb","_logAddedCb","_handleLogAdded","removeListener","enabled"],"sourceRoot":""}